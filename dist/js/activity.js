(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = setTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            currentQueue[queueIndex].run();
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    clearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        setTimeout(drainQueue, 0);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],2:[function(require,module,exports){
/** Utility function for linear interpolation. */
module.exports.lerp = require('lerp')

/** Utility function for Hermite interpolation. */
module.exports.smoothstep = require('smoothstep')
},{"lerp":3,"smoothstep":4}],3:[function(require,module,exports){
function lerp(v0, v1, t) {
    return v0*(1-t)+v1*t
}
module.exports = lerp
},{}],4:[function(require,module,exports){
module.exports = function smoothstep (min, max, value) {
  var x = Math.max(0, Math.min(1, (value-min)/(max-min)));
  return x*x*(3 - 2*x);
};

},{}],5:[function(require,module,exports){
/**
 * A simple color interpolator.
 * Parses a `from` and `to` HSL string in the format
 * `hsl(200, 100%, 50%)` and a step value between 0 and 1
 * and returns a new HSL string.
 * An optional `precision` value may be provided for the
 * new HSL string
 *
 * @param {string} from
 * @param {string} to
 * @param {number} step
 * @param {precision} number
 */

var regex = /^hsl\(\s*([\-|\d|\.]*)\s*,\s*([\d|\.]*)%\s*,\s*([\d|\.]*)%/;
function interpolate (start, end, step, precision) {
  precision = precision != null ? precision : 0;
  start = start.match(regex);
  end = end.match(regex);
  var
    startH = +start[1],
    startS = +start[2],
    startL = +start[3],
    endH   = +end[1],
    endS   = +end[2],
    endL   = +end[3];

  var
    h = (startH - (startH - endH) * step).toFixed(precision),
    s = (startS - (startS - endS) * step).toFixed(precision),
    l = (startL - (startL - endL) * step).toFixed(precision);

  return 'hsl(' + h + ', ' + s + '%, ' + l + '%)';
}

module.exports = interpolate;

},{}],6:[function(require,module,exports){
(function (process){
module.exports = process.env.MEDIATOR_JS_COV
  ? require('./lib-cov/mediator')
  : require('./lib/mediator');

}).call(this,require('_process'))

},{"./lib-cov/mediator":7,"./lib/mediator":8,"_process":1}],7:[function(require,module,exports){
/* automatically generated by JSCoverage - do not edit */
try {
  if (typeof top === 'object' && top !== null && typeof top.opener === 'object' && top.opener !== null) {
    // this is a browser window that was opened from another window

    if (! top.opener._$jscoverage) {
      top.opener._$jscoverage = {};
    }
  }
}
catch (e) {}

try {
  if (typeof top === 'object' && top !== null) {
    // this is a browser window

    try {
      if (typeof top.opener === 'object' && top.opener !== null && top.opener._$jscoverage) {
        top._$jscoverage = top.opener._$jscoverage;
      }
    }
    catch (e) {}

    if (! top._$jscoverage) {
      top._$jscoverage = {};
    }
  }
}
catch (e) {}

try {
  if (typeof top === 'object' && top !== null && top._$jscoverage) {
    _$jscoverage = top._$jscoverage;
  }
}
catch (e) {}
if (typeof _$jscoverage !== 'object') {
  _$jscoverage = {};
}
if (! _$jscoverage['mediator.js']) {
  _$jscoverage['mediator.js'] = [];
  _$jscoverage['mediator.js'][16] = 0;
  _$jscoverage['mediator.js'][17] = 0;
  _$jscoverage['mediator.js'][19] = 0;
  _$jscoverage['mediator.js'][21] = 0;
  _$jscoverage['mediator.js'][22] = 0;
  _$jscoverage['mediator.js'][24] = 0;
  _$jscoverage['mediator.js'][26] = 0;
  _$jscoverage['mediator.js'][30] = 0;
  _$jscoverage['mediator.js'][33] = 0;
  _$jscoverage['mediator.js'][39] = 0;
  _$jscoverage['mediator.js'][40] = 0;
  _$jscoverage['mediator.js'][41] = 0;
  _$jscoverage['mediator.js'][44] = 0;
  _$jscoverage['mediator.js'][52] = 0;
  _$jscoverage['mediator.js'][53] = 0;
  _$jscoverage['mediator.js'][54] = 0;
  _$jscoverage['mediator.js'][57] = 0;
  _$jscoverage['mediator.js'][58] = 0;
  _$jscoverage['mediator.js'][59] = 0;
  _$jscoverage['mediator.js'][60] = 0;
  _$jscoverage['mediator.js'][61] = 0;
  _$jscoverage['mediator.js'][64] = 0;
  _$jscoverage['mediator.js'][70] = 0;
  _$jscoverage['mediator.js'][71] = 0;
  _$jscoverage['mediator.js'][72] = 0;
  _$jscoverage['mediator.js'][73] = 0;
  _$jscoverage['mediator.js'][74] = 0;
  _$jscoverage['mediator.js'][75] = 0;
  _$jscoverage['mediator.js'][82] = 0;
  _$jscoverage['mediator.js'][83] = 0;
  _$jscoverage['mediator.js'][84] = 0;
  _$jscoverage['mediator.js'][87] = 0;
  _$jscoverage['mediator.js'][88] = 0;
  _$jscoverage['mediator.js'][89] = 0;
  _$jscoverage['mediator.js'][90] = 0;
  _$jscoverage['mediator.js'][91] = 0;
  _$jscoverage['mediator.js'][100] = 0;
  _$jscoverage['mediator.js'][102] = 0;
  _$jscoverage['mediator.js'][104] = 0;
  _$jscoverage['mediator.js'][108] = 0;
  _$jscoverage['mediator.js'][110] = 0;
  _$jscoverage['mediator.js'][111] = 0;
  _$jscoverage['mediator.js'][113] = 0;
  _$jscoverage['mediator.js'][115] = 0;
  _$jscoverage['mediator.js'][118] = 0;
  _$jscoverage['mediator.js'][120] = 0;
  _$jscoverage['mediator.js'][127] = 0;
  _$jscoverage['mediator.js'][131] = 0;
  _$jscoverage['mediator.js'][134] = 0;
  _$jscoverage['mediator.js'][135] = 0;
  _$jscoverage['mediator.js'][136] = 0;
  _$jscoverage['mediator.js'][146] = 0;
  _$jscoverage['mediator.js'][150] = 0;
  _$jscoverage['mediator.js'][151] = 0;
  _$jscoverage['mediator.js'][152] = 0;
  _$jscoverage['mediator.js'][154] = 0;
  _$jscoverage['mediator.js'][157] = 0;
  _$jscoverage['mediator.js'][158] = 0;
  _$jscoverage['mediator.js'][159] = 0;
  _$jscoverage['mediator.js'][161] = 0;
  _$jscoverage['mediator.js'][162] = 0;
  _$jscoverage['mediator.js'][166] = 0;
  _$jscoverage['mediator.js'][170] = 0;
  _$jscoverage['mediator.js'][174] = 0;
  _$jscoverage['mediator.js'][178] = 0;
  _$jscoverage['mediator.js'][180] = 0;
  _$jscoverage['mediator.js'][183] = 0;
  _$jscoverage['mediator.js'][184] = 0;
  _$jscoverage['mediator.js'][185] = 0;
  _$jscoverage['mediator.js'][189] = 0;
  _$jscoverage['mediator.js'][190] = 0;
  _$jscoverage['mediator.js'][191] = 0;
  _$jscoverage['mediator.js'][192] = 0;
  _$jscoverage['mediator.js'][201] = 0;
  _$jscoverage['mediator.js'][207] = 0;
  _$jscoverage['mediator.js'][208] = 0;
  _$jscoverage['mediator.js'][209] = 0;
  _$jscoverage['mediator.js'][210] = 0;
  _$jscoverage['mediator.js'][211] = 0;
  _$jscoverage['mediator.js'][212] = 0;
  _$jscoverage['mediator.js'][213] = 0;
  _$jscoverage['mediator.js'][216] = 0;
  _$jscoverage['mediator.js'][217] = 0;
  _$jscoverage['mediator.js'][221] = 0;
  _$jscoverage['mediator.js'][222] = 0;
  _$jscoverage['mediator.js'][224] = 0;
  _$jscoverage['mediator.js'][225] = 0;
  _$jscoverage['mediator.js'][227] = 0;
  _$jscoverage['mediator.js'][232] = 0;
  _$jscoverage['mediator.js'][233] = 0;
  _$jscoverage['mediator.js'][236] = 0;
  _$jscoverage['mediator.js'][240] = 0;
  _$jscoverage['mediator.js'][241] = 0;
  _$jscoverage['mediator.js'][242] = 0;
  _$jscoverage['mediator.js'][245] = 0;
  _$jscoverage['mediator.js'][251] = 0;
  _$jscoverage['mediator.js'][257] = 0;
  _$jscoverage['mediator.js'][262] = 0;
  _$jscoverage['mediator.js'][263] = 0;
  _$jscoverage['mediator.js'][266] = 0;
  _$jscoverage['mediator.js'][267] = 0;
  _$jscoverage['mediator.js'][269] = 0;
  _$jscoverage['mediator.js'][270] = 0;
  _$jscoverage['mediator.js'][273] = 0;
  _$jscoverage['mediator.js'][277] = 0;
  _$jscoverage['mediator.js'][287] = 0;
  _$jscoverage['mediator.js'][289] = 0;
  _$jscoverage['mediator.js'][290] = 0;
  _$jscoverage['mediator.js'][292] = 0;
  _$jscoverage['mediator.js'][302] = 0;
  _$jscoverage['mediator.js'][303] = 0;
  _$jscoverage['mediator.js'][305] = 0;
  _$jscoverage['mediator.js'][312] = 0;
  _$jscoverage['mediator.js'][319] = 0;
  _$jscoverage['mediator.js'][328] = 0;
  _$jscoverage['mediator.js'][331] = 0;
  _$jscoverage['mediator.js'][333] = 0;
  _$jscoverage['mediator.js'][338] = 0;
  _$jscoverage['mediator.js'][339] = 0;
  _$jscoverage['mediator.js'][340] = 0;
  _$jscoverage['mediator.js'][341] = 0;
  _$jscoverage['mediator.js'][342] = 0;
  _$jscoverage['mediator.js'][346] = 0;
  _$jscoverage['mediator.js'][347] = 0;
  _$jscoverage['mediator.js'][348] = 0;
}
_$jscoverage['mediator.js'].source = ["/*jslint bitwise: true, nomen: true, plusplus: true, white: true */","","/*!","* Mediator.js Library v0.9.0","* https://github.com/ajacksified/Mediator.js","*","* Copyright 2013, Jack Lawson","* MIT Licensed (http://www.opensource.org/licenses/mit-license.php)","*","* For more information: http://thejacklawson.com/2011/06/mediators-for-modularized-asynchronous-programming-in-javascript/index.html","* Project on GitHub: https://github.com/ajacksified/Mediator.js","*","* Last update: Jan 04 2013","*/","","(function(root, factory) {","  'use strict';","","  if(typeof root.exports === 'function') {","    // Node/CommonJS","    root.exports.Mediator = factory();","  } else if(typeof root.define === 'function' &amp;&amp; root.define.amd) {","    // AMD","    root.define([], function() {","      // Export to global too, for backward compatiblity","      root.Mediator = factory();","    });","  } else {","    // Browser global","    root.Mediator = factory();","  }","}(this, function() {","  'use strict';","","  // We'll generate guids for class instances for easy referencing later on.","  // Subscriber instances will have an id that can be refernced for quick","  // lookups.","","  function guidGenerator() {","    var S4 = function() {","       return (((1+Math.random())*0x10000)|0).toString(16).substring(1);","    };","","    return (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());","  }","","  // Subscribers are instances of Mediator Channel registrations. We generate","  // an object instance so that it can be updated later on without having to","  // unregister and re-register. Subscribers are constructed with a function","  // to be called, options object, and context.","","  function Subscriber(fn, options, context){","    if(!(this instanceof Subscriber)) {","      return new Subscriber(fn, options, context);","    }","","    this.id = guidGenerator();","    this.fn = fn;","    this.options = options;","    this.context = context;","    this.channel = null;","  }","","  Subscriber.prototype = {","    // Mediator.update on a subscriber instance can update its function,context,","    // or options object. It takes in an object and looks for fn, context, or","    // options keys.","","    update: function(options){","      if(options){","        this.fn = options.fn || this.fn;","        this.context = options.context || this.context;","        this.options = options.options || this.options;","        if(this.channel &amp;&amp; this.options &amp;&amp; this.options.priority !== undefined) {","            this.channel.setPriority(this.id, this.options.priority);","        }","      }","    }","  };","","","  function Channel(namespace, parent){","    if(!(this instanceof Channel)) {","      return new Channel(namespace);","    }","","    this.namespace = namespace || \"\";","    this._subscribers = [];","    this._channels = [];","    this._parent = parent;","    this.stopped = false;","  }","","  // A Mediator channel holds a list of sub-channels and subscribers to be fired","  // when Mediator.publish is called on the Mediator instance. It also contains","  // some methods to manipulate its lists of data; only setPriority and","  // StopPropagation are meant to be used. The other methods should be accessed","  // through the Mediator instance.","","  Channel.prototype = {","    addSubscriber: function(fn, options, context){","      var subscriber = new Subscriber(fn, options, context);","","      if(options &amp;&amp; options.priority !== undefined){","        // Cheap hack to either parse as an int or turn it into 0. Runs faster","        // in many browsers than parseInt with the benefit that it won't","        // return a NaN.","        options.priority = options.priority &gt;&gt; 0;","","        if(options.priority &lt; 0){ options.priority = 0; }","        if(options.priority &gt;= this._subscribers.length){ options.priority = this._subscribers.length-1; }","","        this._subscribers.splice(options.priority, 0, subscriber);","      }else{","        this._subscribers.push(subscriber);","      }","","      subscriber.channel = this;","","      return subscriber;","    },","","    // The channel instance is passed as an argument to the mediator subscriber,","    // and further subscriber propagation can be called with","    // channel.StopPropagation().","    stopPropagation: function(){","      this.stopped = true;","    },","","    getSubscriber: function(identifier){","      var x = 0,","          y = this._subscribers.length;","","      for(x, y; x &lt; y; x++){","        if(this._subscribers[x].id === identifier || this._subscribers[x].fn === identifier){","          return this._subscribers[x];","        }","      }","    },","","    // Channel.setPriority is useful in updating the order in which Subscribers","    // are called, and takes an identifier (subscriber id or named function) and","    // an array index. It will not search recursively through subchannels.","","    setPriority: function(identifier, priority){","      var oldIndex = 0,","          x = 0,","          sub, firstHalf, lastHalf, y;","","      for(x = 0, y = this._subscribers.length; x &lt; y; x++){","        if(this._subscribers[x].id === identifier || this._subscribers[x].fn === identifier){","          break;","        }","        oldIndex ++;","      }","","      sub = this._subscribers[oldIndex];","      firstHalf = this._subscribers.slice(0, oldIndex);","      lastHalf = this._subscribers.slice(oldIndex+1);","","      this._subscribers = firstHalf.concat(lastHalf);","      this._subscribers.splice(priority, 0, sub);","    },","","    addChannel: function(channel){","      this._channels[channel] = new Channel((this.namespace ? this.namespace + ':' : '') + channel, this);","    },","","    hasChannel: function(channel){","      return this._channels.hasOwnProperty(channel);","    },","","    returnChannel: function(channel){","      return this._channels[channel];","    },","","    removeSubscriber: function(identifier){","      var x = 0,","          y;","          y = this._subscribers.length;","","      // If we don't pass in an id, we're clearing all","      if(!identifier){","        this._subscribers = [];","        return;","      }","","      // Going backwards makes splicing a whole lot easier.","      for(x, y; y &gt; x; y--) {","        if(this._subscribers[x].fn === identifier || this._subscribers[x].id === identifier){","          this._subscribers[x].channel = null;","          this._subscribers.splice(x,1);","        }","      }","    },","","    // This will publish arbitrary arguments to a subscriber and then to parent","    // channels.","","    publish: function(data){","      var x = 0,","          y = this._subscribers.length,","          called = false,","          subscriber, l;","","      // Priority is preserved in the _subscribers index.","      for(x, y; x &lt; y; x++) {","        if(!this.stopped){","          subscriber = this._subscribers[x];","          if(subscriber.options !== undefined &amp;&amp; typeof subscriber.options.predicate === \"function\"){","            if(subscriber.options.predicate.apply(subscriber.context, data)){","              subscriber.fn.apply(subscriber.context, data);","              called = true;","            }","          }else{","            subscriber.fn.apply(subscriber.context, data);","            called = true;","          }","        }","","        if(called &amp;&amp; subscriber.options &amp;&amp; subscriber.options !== undefined){","          subscriber.options.calls--;","","          if(subscriber.options.calls &lt; 1){","            this.removeSubscriber(subscriber.id);","          }else{","            subscriber.update(subscriber.options);","          }","        }","      }","","      if(this._parent){","        this._parent.publish(data);","      }","","      this.stopped = false;","    }","  };","","  function Mediator() {","    if(!(this instanceof Mediator)) {","      return new Mediator();","    }","","    this._channels = new Channel('');","  }","","  // A Mediator instance is the interface through which events are registered","  // and removed from publish channels.","","  Mediator.prototype = {","","    // Returns a channel instance based on namespace, for example","    // application:chat:message:received","","    getChannel: function(namespace){","      var channel = this._channels,","          namespaceHierarchy = namespace.split(':'),","          x = 0, ","          y = namespaceHierarchy.length;","","      if(namespace === ''){","        return channel;","      }","","      if(namespaceHierarchy.length &gt; 0){","        for(x, y; x &lt; y; x++){","","          if(!channel.hasChannel(namespaceHierarchy[x])){","            channel.addChannel(namespaceHierarchy[x]);","          }","","          channel = channel.returnChannel(namespaceHierarchy[x]);","        }","      }","","      return channel;","    },","","    // Pass in a channel namespace, function to be called, options, and context","    // to call the function in to Subscribe. It will create a channel if one","    // does not exist. Options can include a predicate to determine if it","    // should be called (based on the data published to it) and a priority","    // index.","","    subscribe: function(channelName, fn, options, context){","      var channel = this.getChannel(channelName);","","      options = options || {};","      context = context || {};","","      return channel.addSubscriber(fn, options, context);","    },","","    // Pass in a channel namespace, function to be called, options, and context","    // to call the function in to Subscribe. It will create a channel if one","    // does not exist. Options can include a predicate to determine if it","    // should be called (based on the data published to it) and a priority","    // index.","","    once: function(channelName, fn, options, context){","      options = options || {};","      options.calls = 1;","","      return this.subscribe(channelName, fn, options, context);","    },","","    // Returns a subscriber for a given subscriber id / named function and","    // channel namespace","","    getSubscriber: function(identifier, channel){","      return this.getChannel(channel || \"\").getSubscriber(identifier);","    },","","    // Remove a subscriber from a given channel namespace recursively based on","    // a passed-in subscriber id or named function.","","    remove: function(channelName, identifier){","      this.getChannel(channelName).removeSubscriber(identifier);","    },","","    // Publishes arbitrary data to a given channel namespace. Channels are","    // called recursively downwards; a post to application:chat will post to","    // application:chat:receive and application:chat:derp:test:beta:bananas.","    // Called using Mediator.publish(\"application:chat\", [ args ]);","","    publish: function(channelName){","      var args = Array.prototype.slice.call(arguments, 1),","          channel = this.getChannel(channelName);","","      args.push(channel);","","      this.getChannel(channelName).publish(args);","    }","  };","","  // Alias some common names for easy interop","  Mediator.prototype.on = Mediator.prototype.subscribe;","  Mediator.prototype.bind = Mediator.prototype.subscribe;","  Mediator.prototype.emit = Mediator.prototype.publish;","  Mediator.prototype.trigger = Mediator.prototype.publish;","  Mediator.prototype.off = Mediator.prototype.remove;","","  // Finally, expose it all.","","  Mediator.Channel = Channel;","  Mediator.Subscriber = Subscriber;","  return Mediator;","}));"];
_$jscoverage['mediator.js'][16]++;
(function (root, factory) {
  _$jscoverage['mediator.js'][17]++;
  "use strict";
  _$jscoverage['mediator.js'][19]++;
  if (((typeof root.exports) === "function")) {
    _$jscoverage['mediator.js'][21]++;
    root.exports.Mediator = factory();
  }
  else {
    _$jscoverage['mediator.js'][22]++;
    if ((((typeof root.define) === "function") && root.define.amd)) {
      _$jscoverage['mediator.js'][24]++;
      root.define([], (function () {
  _$jscoverage['mediator.js'][26]++;
  root.Mediator = factory();
}));
    }
    else {
      _$jscoverage['mediator.js'][30]++;
      root.Mediator = factory();
    }
  }
})(this, (function () {
  _$jscoverage['mediator.js'][33]++;
  "use strict";
  _$jscoverage['mediator.js'][39]++;
  function guidGenerator() {
    _$jscoverage['mediator.js'][40]++;
    var S4 = (function () {
  _$jscoverage['mediator.js'][41]++;
  return (((1 + Math.random()) * 65536) | 0).toString(16).substring(1);
});
    _$jscoverage['mediator.js'][44]++;
    return (S4() + S4() + "-" + S4() + "-" + S4() + "-" + S4() + "-" + S4() + S4() + S4());
}
  _$jscoverage['mediator.js'][52]++;
  function Subscriber(fn, options, context) {
    _$jscoverage['mediator.js'][53]++;
    if ((! (this instanceof Subscriber))) {
      _$jscoverage['mediator.js'][54]++;
      return new Subscriber(fn, options, context);
    }
    _$jscoverage['mediator.js'][57]++;
    this.id = guidGenerator();
    _$jscoverage['mediator.js'][58]++;
    this.fn = fn;
    _$jscoverage['mediator.js'][59]++;
    this.options = options;
    _$jscoverage['mediator.js'][60]++;
    this.context = context;
    _$jscoverage['mediator.js'][61]++;
    this.channel = null;
}
  _$jscoverage['mediator.js'][64]++;
  Subscriber.prototype = {update: (function (options) {
  _$jscoverage['mediator.js'][70]++;
  if (options) {
    _$jscoverage['mediator.js'][71]++;
    this.fn = (options.fn || this.fn);
    _$jscoverage['mediator.js'][72]++;
    this.context = (options.context || this.context);
    _$jscoverage['mediator.js'][73]++;
    this.options = (options.options || this.options);
    _$jscoverage['mediator.js'][74]++;
    if ((this.channel && this.options && (this.options.priority !== undefined))) {
      _$jscoverage['mediator.js'][75]++;
      this.channel.setPriority(this.id, this.options.priority);
    }
  }
})};
  _$jscoverage['mediator.js'][82]++;
  function Channel(namespace, parent) {
    _$jscoverage['mediator.js'][83]++;
    if ((! (this instanceof Channel))) {
      _$jscoverage['mediator.js'][84]++;
      return new Channel(namespace);
    }
    _$jscoverage['mediator.js'][87]++;
    this.namespace = (namespace || "");
    _$jscoverage['mediator.js'][88]++;
    this._subscribers = [];
    _$jscoverage['mediator.js'][89]++;
    this._channels = [];
    _$jscoverage['mediator.js'][90]++;
    this._parent = parent;
    _$jscoverage['mediator.js'][91]++;
    this.stopped = false;
}
  _$jscoverage['mediator.js'][100]++;
  Channel.prototype = {addSubscriber: (function (fn, options, context) {
  _$jscoverage['mediator.js'][102]++;
  var subscriber = new Subscriber(fn, options, context);
  _$jscoverage['mediator.js'][104]++;
  if ((options && (options.priority !== undefined))) {
    _$jscoverage['mediator.js'][108]++;
    options.priority = (options.priority >> 0);
    _$jscoverage['mediator.js'][110]++;
    if ((options.priority < 0)) {
      _$jscoverage['mediator.js'][110]++;
      options.priority = 0;
    }
    _$jscoverage['mediator.js'][111]++;
    if ((options.priority >= this._subscribers.length)) {
      _$jscoverage['mediator.js'][111]++;
      options.priority = (this._subscribers.length - 1);
    }
    _$jscoverage['mediator.js'][113]++;
    this._subscribers.splice(options.priority, 0, subscriber);
  }
  else {
    _$jscoverage['mediator.js'][115]++;
    this._subscribers.push(subscriber);
  }
  _$jscoverage['mediator.js'][118]++;
  subscriber.channel = this;
  _$jscoverage['mediator.js'][120]++;
  return subscriber;
}), stopPropagation: (function () {
  _$jscoverage['mediator.js'][127]++;
  this.stopped = true;
}), getSubscriber: (function (identifier) {
  _$jscoverage['mediator.js'][131]++;
  var x = 0, y = this._subscribers.length;
  _$jscoverage['mediator.js'][134]++;
  for ((x, y); (x < y); (x++)) {
    _$jscoverage['mediator.js'][135]++;
    if (((this._subscribers[x].id === identifier) || (this._subscribers[x].fn === identifier))) {
      _$jscoverage['mediator.js'][136]++;
      return this._subscribers[x];
    }
}
}), setPriority: (function (identifier, priority) {
  _$jscoverage['mediator.js'][146]++;
  var oldIndex = 0, x = 0, sub, firstHalf, lastHalf, y;
  _$jscoverage['mediator.js'][150]++;
  for (((x = 0), (y = this._subscribers.length)); (x < y); (x++)) {
    _$jscoverage['mediator.js'][151]++;
    if (((this._subscribers[x].id === identifier) || (this._subscribers[x].fn === identifier))) {
      _$jscoverage['mediator.js'][152]++;
      break;
    }
    _$jscoverage['mediator.js'][154]++;
    (oldIndex++);
}
  _$jscoverage['mediator.js'][157]++;
  sub = this._subscribers[oldIndex];
  _$jscoverage['mediator.js'][158]++;
  firstHalf = this._subscribers.slice(0, oldIndex);
  _$jscoverage['mediator.js'][159]++;
  lastHalf = this._subscribers.slice((oldIndex + 1));
  _$jscoverage['mediator.js'][161]++;
  this._subscribers = firstHalf.concat(lastHalf);
  _$jscoverage['mediator.js'][162]++;
  this._subscribers.splice(priority, 0, sub);
}), addChannel: (function (channel) {
  _$jscoverage['mediator.js'][166]++;
  this._channels[channel] = new Channel(((this.namespace? (this.namespace + ":"): "") + channel), this);
}), hasChannel: (function (channel) {
  _$jscoverage['mediator.js'][170]++;
  return this._channels.hasOwnProperty(channel);
}), returnChannel: (function (channel) {
  _$jscoverage['mediator.js'][174]++;
  return this._channels[channel];
}), removeSubscriber: (function (identifier) {
  _$jscoverage['mediator.js'][178]++;
  var x = 0, y;
  _$jscoverage['mediator.js'][180]++;
  y = this._subscribers.length;
  _$jscoverage['mediator.js'][183]++;
  if ((! identifier)) {
    _$jscoverage['mediator.js'][184]++;
    this._subscribers = [];
    _$jscoverage['mediator.js'][185]++;
    return;
  }
  _$jscoverage['mediator.js'][189]++;
  for ((x, y); (y > x); (y--)) {
    _$jscoverage['mediator.js'][190]++;
    if (((this._subscribers[x].fn === identifier) || (this._subscribers[x].id === identifier))) {
      _$jscoverage['mediator.js'][191]++;
      this._subscribers[x].channel = null;
      _$jscoverage['mediator.js'][192]++;
      this._subscribers.splice(x, 1);
    }
}
}), publish: (function (data) {
  _$jscoverage['mediator.js'][201]++;
  var x = 0, y = this._subscribers.length, called = false, subscriber, l;
  _$jscoverage['mediator.js'][207]++;
  for ((x, y); (x < y); (x++)) {
    _$jscoverage['mediator.js'][208]++;
    if ((! this.stopped)) {
      _$jscoverage['mediator.js'][209]++;
      subscriber = this._subscribers[x];
      _$jscoverage['mediator.js'][210]++;
      if (((subscriber.options !== undefined) && ((typeof subscriber.options.predicate) === "function"))) {
        _$jscoverage['mediator.js'][211]++;
        if (subscriber.options.predicate.apply(subscriber.context, data)) {
          _$jscoverage['mediator.js'][212]++;
          subscriber.fn.apply(subscriber.context, data);
          _$jscoverage['mediator.js'][213]++;
          called = true;
        }
      }
      else {
        _$jscoverage['mediator.js'][216]++;
        subscriber.fn.apply(subscriber.context, data);
        _$jscoverage['mediator.js'][217]++;
        called = true;
      }
    }
    _$jscoverage['mediator.js'][221]++;
    if ((called && subscriber.options && (subscriber.options !== undefined))) {
      _$jscoverage['mediator.js'][222]++;
      (subscriber.options.calls--);
      _$jscoverage['mediator.js'][224]++;
      if ((subscriber.options.calls < 1)) {
        _$jscoverage['mediator.js'][225]++;
        this.removeSubscriber(subscriber.id);
      }
      else {
        _$jscoverage['mediator.js'][227]++;
        subscriber.update(subscriber.options);
      }
    }
}
  _$jscoverage['mediator.js'][232]++;
  if (this._parent) {
    _$jscoverage['mediator.js'][233]++;
    this._parent.publish(data);
  }
  _$jscoverage['mediator.js'][236]++;
  this.stopped = false;
})};
  _$jscoverage['mediator.js'][240]++;
  function Mediator() {
    _$jscoverage['mediator.js'][241]++;
    if ((! (this instanceof Mediator))) {
      _$jscoverage['mediator.js'][242]++;
      return new Mediator();
    }
    _$jscoverage['mediator.js'][245]++;
    this._channels = new Channel("");
}
  _$jscoverage['mediator.js'][251]++;
  Mediator.prototype = {getChannel: (function (namespace) {
  _$jscoverage['mediator.js'][257]++;
  var channel = this._channels, namespaceHierarchy = namespace.split(":"), x = 0, y = namespaceHierarchy.length;
  _$jscoverage['mediator.js'][262]++;
  if ((namespace === "")) {
    _$jscoverage['mediator.js'][263]++;
    return channel;
  }
  _$jscoverage['mediator.js'][266]++;
  if ((namespaceHierarchy.length > 0)) {
    _$jscoverage['mediator.js'][267]++;
    for ((x, y); (x < y); (x++)) {
      _$jscoverage['mediator.js'][269]++;
      if ((! channel.hasChannel(namespaceHierarchy[x]))) {
        _$jscoverage['mediator.js'][270]++;
        channel.addChannel(namespaceHierarchy[x]);
      }
      _$jscoverage['mediator.js'][273]++;
      channel = channel.returnChannel(namespaceHierarchy[x]);
}
  }
  _$jscoverage['mediator.js'][277]++;
  return channel;
}), subscribe: (function (channelName, fn, options, context) {
  _$jscoverage['mediator.js'][287]++;
  var channel = this.getChannel(channelName);
  _$jscoverage['mediator.js'][289]++;
  options = (options || {});
  _$jscoverage['mediator.js'][290]++;
  context = (context || {});
  _$jscoverage['mediator.js'][292]++;
  return channel.addSubscriber(fn, options, context);
}), once: (function (channelName, fn, options, context) {
  _$jscoverage['mediator.js'][302]++;
  options = (options || {});
  _$jscoverage['mediator.js'][303]++;
  options.calls = 1;
  _$jscoverage['mediator.js'][305]++;
  return this.subscribe(channelName, fn, options, context);
}), getSubscriber: (function (identifier, channel) {
  _$jscoverage['mediator.js'][312]++;
  return this.getChannel((channel || "")).getSubscriber(identifier);
}), remove: (function (channelName, identifier) {
  _$jscoverage['mediator.js'][319]++;
  this.getChannel(channelName).removeSubscriber(identifier);
}), publish: (function (channelName) {
  _$jscoverage['mediator.js'][328]++;
  var args = Array.prototype.slice.call(arguments, 1), channel = this.getChannel(channelName);
  _$jscoverage['mediator.js'][331]++;
  args.push(channel);
  _$jscoverage['mediator.js'][333]++;
  this.getChannel(channelName).publish(args);
})};
  _$jscoverage['mediator.js'][338]++;
  Mediator.prototype.on = Mediator.prototype.subscribe;
  _$jscoverage['mediator.js'][339]++;
  Mediator.prototype.bind = Mediator.prototype.subscribe;
  _$jscoverage['mediator.js'][340]++;
  Mediator.prototype.emit = Mediator.prototype.publish;
  _$jscoverage['mediator.js'][341]++;
  Mediator.prototype.trigger = Mediator.prototype.publish;
  _$jscoverage['mediator.js'][342]++;
  Mediator.prototype.off = Mediator.prototype.remove;
  _$jscoverage['mediator.js'][346]++;
  Mediator.Channel = Channel;
  _$jscoverage['mediator.js'][347]++;
  Mediator.Subscriber = Subscriber;
  _$jscoverage['mediator.js'][348]++;
  return Mediator;
}));

},{}],8:[function(require,module,exports){
/*jslint bitwise: true, nomen: true, plusplus: true, white: true */

/*!
* Mediator.js Library v0.9.8
* https://github.com/ajacksified/Mediator.js
*
* Copyright 2013, Jack Lawson
* MIT Licensed (http://www.opensource.org/licenses/mit-license.php)
*
* For more information: http://thejacklawson.com/2011/06/mediators-for-modularized-asynchronous-programming-in-javascript/index.html
* Project on GitHub: https://github.com/ajacksified/Mediator.js
*
* Last update: October 19 2013
*/

(function(global, factory) {
  'use strict';

  if (typeof define === 'function' && define.amd) {
    // AMD
    define('mediator-js', [], function() {
      global.Mediator = factory();
      return global.Mediator;
    });
  } else if (typeof exports !== 'undefined') {
    // Node/CommonJS
    exports.Mediator = factory();
  } else {
    // Browser global
    global.Mediator = factory();
  }
}(this, function() {
  'use strict';

  // We'll generate guids for class instances for easy referencing later on.
  // Subscriber instances will have an id that can be refernced for quick
  // lookups.

  function guidGenerator() {
    var S4 = function() {
       return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
    };

    return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
  }

  // Subscribers are instances of Mediator Channel registrations. We generate
  // an object instance so that it can be updated later on without having to
  // unregister and re-register. Subscribers are constructed with a function
  // to be called, options object, and context.

  function Subscriber(fn, options, context) {
    if (!(this instanceof Subscriber)) {
      return new Subscriber(fn, options, context);
    }

    this.id = guidGenerator();
    this.fn = fn;
    this.options = options;
    this.context = context;
    this.channel = null;
  }

  // Mediator.update on a subscriber instance can update its function,context,
  // or options object. It takes in an object and looks for fn, context, or
  // options keys.
  Subscriber.prototype.update = function(options) {
    if (options) {
      this.fn = options.fn || this.fn;
      this.context = options.context || this.context;
      this.options = options.options || this.options;
      if (this.channel && this.options && this.options.priority !== undefined) {
          this.channel.setPriority(this.id, this.options.priority);
      }
    }
  }


  function Channel(namespace, parent) {
    if (!(this instanceof Channel)) {
      return new Channel(namespace);
    }

    this.namespace = namespace || "";
    this._subscribers = [];
    this._channels = {};
    this._parent = parent;
    this.stopped = false;
  }

  // A Mediator channel holds a list of sub-channels and subscribers to be fired
  // when Mediator.publish is called on the Mediator instance. It also contains
  // some methods to manipulate its lists of data; only setPriority and
  // StopPropagation are meant to be used. The other methods should be accessed
  // through the Mediator instance.
  Channel.prototype.addSubscriber = function(fn, options, context) {
    var subscriber = new Subscriber(fn, options, context);

    if (options && options.priority !== undefined) {
      // Cheap hack to either parse as an int or turn it into 0. Runs faster
      // in many browsers than parseInt with the benefit that it won't
      // return a NaN.
      options.priority = options.priority >> 0;

      if (options.priority < 0) { options.priority = 0; }
      if (options.priority >= this._subscribers.length) { options.priority = this._subscribers.length-1; }

      this._subscribers.splice(options.priority, 0, subscriber);
    }else{
      this._subscribers.push(subscriber);
    }

    subscriber.channel = this;

    return subscriber;
  }

  // The channel instance is passed as an argument to the mediator subscriber,
  // and further subscriber propagation can be called with
  // channel.StopPropagation().
  Channel.prototype.stopPropagation = function() {
    this.stopped = true;
  }

  Channel.prototype.getSubscriber = function(identifier) {
    var x = 0,
        y = this._subscribers.length;

    for(x, y; x < y; x++) {
      if (this._subscribers[x].id === identifier || this._subscribers[x].fn === identifier) {
        return this._subscribers[x];
      }
    }
  }

  // Channel.setPriority is useful in updating the order in which Subscribers
  // are called, and takes an identifier (subscriber id or named function) and
  // an array index. It will not search recursively through subchannels.

  Channel.prototype.setPriority = function(identifier, priority) {
    var oldIndex = 0,
        x = 0,
        sub, firstHalf, lastHalf, y;

    for(x = 0, y = this._subscribers.length; x < y; x++) {
      if (this._subscribers[x].id === identifier || this._subscribers[x].fn === identifier) {
        break;
      }
      oldIndex ++;
    }

    sub = this._subscribers[oldIndex];
    firstHalf = this._subscribers.slice(0, oldIndex);
    lastHalf = this._subscribers.slice(oldIndex+1);

    this._subscribers = firstHalf.concat(lastHalf);
    this._subscribers.splice(priority, 0, sub);
  }

  Channel.prototype.addChannel = function(channel) {
    this._channels[channel] = new Channel((this.namespace ? this.namespace + ':' : '') + channel, this);
  }

  Channel.prototype.hasChannel = function(channel) {
    return this._channels.hasOwnProperty(channel);
  }

  Channel.prototype.returnChannel = function(channel) {
    return this._channels[channel];
  }

  Channel.prototype.removeSubscriber = function(identifier) {
    var x = this._subscribers.length - 1;

    // If we don't pass in an id, we're clearing all
    if (!identifier) {
      this._subscribers = [];
      return;
    }

    // Going backwards makes splicing a whole lot easier.
    for(x; x >= 0; x--) {
      if (this._subscribers[x].fn === identifier || this._subscribers[x].id === identifier) {
        this._subscribers[x].channel = null;
        this._subscribers.splice(x,1);
      }
    }
  }

    // This will publish arbitrary arguments to a subscriber and then to parent
    // channels.

  Channel.prototype.publish = function(data) {
    var x = 0,
        y = this._subscribers.length,
        shouldCall = false,
        subscriber, l,
        subsBefore,subsAfter;

    // Priority is preserved in the _subscribers index.
    for(x, y; x < y; x++) {
      // By default set the flag to false
      shouldCall = false;
      subscriber = this._subscribers[x];

      if (!this.stopped) {
        subsBefore = this._subscribers.length;
        if (subscriber.options !== undefined && typeof subscriber.options.predicate === "function") {
          if (subscriber.options.predicate.apply(subscriber.context, data)) {
            // The predicate matches, the callback function should be called
            shouldCall = true;
          }
        }else{
          // There is no predicate to match, the callback should always be called
          shouldCall = true;
        }
      }

      // Check if the callback should be called
      if (shouldCall) {
        // Check if the subscriber has options and if this include the calls options
        if (subscriber.options && subscriber.options.calls !== undefined) {
          // Decrease the number of calls left by one
          subscriber.options.calls--;
          // Once the number of calls left reaches zero or less we need to remove the subscriber
          if (subscriber.options.calls < 1) {
            this.removeSubscriber(subscriber.id);
          }
        }
        // Now we call the callback, if this in turns publishes to the same channel it will no longer
        // cause the callback to be called as we just removed it as a subscriber
        subscriber.fn.apply(subscriber.context, data);

        subsAfter = this._subscribers.length;
        y = subsAfter;
        if (subsAfter === subsBefore - 1) {
          x--;
        }
      }
    }

    if (this._parent) {
      this._parent.publish(data);
    }

    this.stopped = false;
  }

  function Mediator() {
    if (!(this instanceof Mediator)) {
      return new Mediator();
    }

    this._channels = new Channel('');
  }

  // A Mediator instance is the interface through which events are registered
  // and removed from publish channels.

  // Returns a channel instance based on namespace, for example
  // application:chat:message:received. If readOnly is true we
  // will refrain from creating non existing channels.
  Mediator.prototype.getChannel = function(namespace, readOnly) {
    var channel = this._channels,
        namespaceHierarchy = namespace.split(':'),
        x = 0,
        y = namespaceHierarchy.length;

    if (namespace === '') {
      return channel;
    }

    if (namespaceHierarchy.length > 0) {
      for(x, y; x < y; x++) {

        if (!channel.hasChannel(namespaceHierarchy[x])) {
          if (readOnly) {
            break;
          } else {
            channel.addChannel(namespaceHierarchy[x]);
          }
        }

        channel = channel.returnChannel(namespaceHierarchy[x]);
      }
    }

    return channel;
  }

  // Pass in a channel namespace, function to be called, options, and context
  // to call the function in to Subscribe. It will create a channel if one
  // does not exist. Options can include a predicate to determine if it
  // should be called (based on the data published to it) and a priority
  // index.

  Mediator.prototype.subscribe = function(channelName, fn, options, context) {
    var channel = this.getChannel(channelName || "", false);

    options = options || {};
    context = context || {};

    return channel.addSubscriber(fn, options, context);
  }

  // Pass in a channel namespace, function to be called, options, and context
  // to call the function in to Subscribe. It will create a channel if one
  // does not exist. Options can include a predicate to determine if it
  // should be called (based on the data published to it) and a priority
  // index.

  Mediator.prototype.once = function(channelName, fn, options, context) {
    options = options || {};
    options.calls = 1;

    return this.subscribe(channelName, fn, options, context);
  }

  // Returns a subscriber for a given subscriber id / named function and
  // channel namespace

  Mediator.prototype.getSubscriber = function(identifier, channelName) {
    var channel = this.getChannel(channelName || "", true);
    // We have to check if channel within the hierarchy exists and if it is
    // an exact match for the requested channel
    if (channel.namespace !== channelName) {
      return null;
    }

    return channel.getSubscriber(identifier);
  }

  // Remove a subscriber from a given channel namespace recursively based on
  // a passed-in subscriber id or named function.

  Mediator.prototype.remove = function(channelName, identifier) {
    var channel = this.getChannel(channelName || "", true);
    if (channel.namespace !== channelName) {
      return false;
    }

    channel.removeSubscriber(identifier);
  }

  // Publishes arbitrary data to a given channel namespace. Channels are
  // called recursively downwards; a post to application:chat will post to
  // application:chat:receive and application:chat:derp:test:beta:bananas.
  // Called using Mediator.publish("application:chat", [ args ]);

  Mediator.prototype.publish = function(channelName) {
    var channel = this.getChannel(channelName || "", true);
    if (channel.namespace !== channelName) {
      return null;
    }

    var args = Array.prototype.slice.call(arguments, 1);

    args.push(channel);

    channel.publish(args);
  }

  // Alias some common names for easy interop
  Mediator.prototype.on = Mediator.prototype.subscribe;
  Mediator.prototype.bind = Mediator.prototype.subscribe;
  Mediator.prototype.emit = Mediator.prototype.publish;
  Mediator.prototype.trigger = Mediator.prototype.publish;
  Mediator.prototype.off = Mediator.prototype.remove;

  // Finally, expose it all.

  Mediator.Channel = Channel;
  Mediator.Subscriber = Subscriber;
  Mediator.version = "0.9.8";

  return Mediator;
}));

},{}],9:[function(require,module,exports){
/**
 * Tween.js - Licensed under the MIT license
 * https://github.com/sole/tween.js
 * ----------------------------------------------
 *
 * See https://github.com/sole/tween.js/graphs/contributors for the full list of contributors.
 * Thank you all, you're awesome!
 */

// Date.now shim for (ahem) Internet Explo(d|r)er
if ( Date.now === undefined ) {

	Date.now = function () {

		return new Date().valueOf();

	};

}

var TWEEN = TWEEN || ( function () {

	var _tweens = [];

	return {

		REVISION: '14',

		getAll: function () {

			return _tweens;

		},

		removeAll: function () {

			_tweens = [];

		},

		add: function ( tween ) {

			_tweens.push( tween );

		},

		remove: function ( tween ) {

			var i = _tweens.indexOf( tween );

			if ( i !== -1 ) {

				_tweens.splice( i, 1 );

			}

		},

		update: function ( time ) {

			if ( _tweens.length === 0 ) return false;

			var i = 0;

			time = time !== undefined ? time : ( typeof window !== 'undefined' && window.performance !== undefined && window.performance.now !== undefined ? window.performance.now() : Date.now() );

			while ( i < _tweens.length ) {

				if ( _tweens[ i ].update( time ) ) {

					i++;

				} else {

					_tweens.splice( i, 1 );

				}

			}

			return true;

		}
	};

} )();

TWEEN.Tween = function ( object ) {

	var _object = object;
	var _valuesStart = {};
	var _valuesEnd = {};
	var _valuesStartRepeat = {};
	var _duration = 1000;
	var _repeat = 0;
	var _yoyo = false;
	var _isPlaying = false;
	var _reversed = false;
	var _delayTime = 0;
	var _startTime = null;
	var _easingFunction = TWEEN.Easing.Linear.None;
	var _interpolationFunction = TWEEN.Interpolation.Linear;
	var _chainedTweens = [];
	var _onStartCallback = null;
	var _onStartCallbackFired = false;
	var _onUpdateCallback = null;
	var _onCompleteCallback = null;
	var _onStopCallback = null;

	// Set all starting values present on the target object
	for ( var field in object ) {

		_valuesStart[ field ] = parseFloat(object[field], 10);

	}

	this.to = function ( properties, duration ) {

		if ( duration !== undefined ) {

			_duration = duration;

		}

		_valuesEnd = properties;

		return this;

	};

	this.start = function ( time ) {

		TWEEN.add( this );

		_isPlaying = true;

		_onStartCallbackFired = false;

		_startTime = time !== undefined ? time : ( typeof window !== 'undefined' && window.performance !== undefined && window.performance.now !== undefined ? window.performance.now() : Date.now() );
		_startTime += _delayTime;

		for ( var property in _valuesEnd ) {

			// check if an Array was provided as property value
			if ( _valuesEnd[ property ] instanceof Array ) {

				if ( _valuesEnd[ property ].length === 0 ) {

					continue;

				}

				// create a local copy of the Array with the start value at the front
				_valuesEnd[ property ] = [ _object[ property ] ].concat( _valuesEnd[ property ] );

			}

			_valuesStart[ property ] = _object[ property ];

			if( ( _valuesStart[ property ] instanceof Array ) === false ) {
				_valuesStart[ property ] *= 1.0; // Ensures we're using numbers, not strings
			}

			_valuesStartRepeat[ property ] = _valuesStart[ property ] || 0;

		}

		return this;

	};

	this.stop = function () {

		if ( !_isPlaying ) {
			return this;
		}

		TWEEN.remove( this );
		_isPlaying = false;

		if ( _onStopCallback !== null ) {

			_onStopCallback.call( _object );

		}

		this.stopChainedTweens();
		return this;

	};

	this.stopChainedTweens = function () {

		for ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++ ) {

			_chainedTweens[ i ].stop();

		}

	};

	this.delay = function ( amount ) {

		_delayTime = amount;
		return this;

	};

	this.repeat = function ( times ) {

		_repeat = times;
		return this;

	};

	this.yoyo = function( yoyo ) {

		_yoyo = yoyo;
		return this;

	};


	this.easing = function ( easing ) {

		_easingFunction = easing;
		return this;

	};

	this.interpolation = function ( interpolation ) {

		_interpolationFunction = interpolation;
		return this;

	};

	this.chain = function () {

		_chainedTweens = arguments;
		return this;

	};

	this.onStart = function ( callback ) {

		_onStartCallback = callback;
		return this;

	};

	this.onUpdate = function ( callback ) {

		_onUpdateCallback = callback;
		return this;

	};

	this.onComplete = function ( callback ) {

		_onCompleteCallback = callback;
		return this;

	};

	this.onStop = function ( callback ) {

		_onStopCallback = callback;
		return this;

	};

	this.update = function ( time ) {

		var property;

		if ( time < _startTime ) {

			return true;

		}

		if ( _onStartCallbackFired === false ) {

			if ( _onStartCallback !== null ) {

				_onStartCallback.call( _object );

			}

			_onStartCallbackFired = true;

		}

		var elapsed = ( time - _startTime ) / _duration;
		elapsed = elapsed > 1 ? 1 : elapsed;

		var value = _easingFunction( elapsed );

		for ( property in _valuesEnd ) {

			var start = _valuesStart[ property ] || 0;
			var end = _valuesEnd[ property ];

			if ( end instanceof Array ) {

				_object[ property ] = _interpolationFunction( end, value );

			} else {

				// Parses relative end values with start as base (e.g.: +10, -3)
				if ( typeof(end) === "string" ) {
					end = start + parseFloat(end, 10);
				}

				// protect against non numeric properties.
				if ( typeof(end) === "number" ) {
					_object[ property ] = start + ( end - start ) * value;
				}

			}

		}

		if ( _onUpdateCallback !== null ) {

			_onUpdateCallback.call( _object, value );

		}

		if ( elapsed == 1 ) {

			if ( _repeat > 0 ) {

				if( isFinite( _repeat ) ) {
					_repeat--;
				}

				// reassign starting values, restart by making startTime = now
				for( property in _valuesStartRepeat ) {

					if ( typeof( _valuesEnd[ property ] ) === "string" ) {
						_valuesStartRepeat[ property ] = _valuesStartRepeat[ property ] + parseFloat(_valuesEnd[ property ], 10);
					}

					if (_yoyo) {
						var tmp = _valuesStartRepeat[ property ];
						_valuesStartRepeat[ property ] = _valuesEnd[ property ];
						_valuesEnd[ property ] = tmp;
					}

					_valuesStart[ property ] = _valuesStartRepeat[ property ];

				}

				if (_yoyo) {
					_reversed = !_reversed;
				}

				_startTime = time + _delayTime;

				return true;

			} else {

				if ( _onCompleteCallback !== null ) {

					_onCompleteCallback.call( _object );

				}

				for ( var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++ ) {

					_chainedTweens[ i ].start( time );

				}

				return false;

			}

		}

		return true;

	};

};


TWEEN.Easing = {

	Linear: {

		None: function ( k ) {

			return k;

		}

	},

	Quadratic: {

		In: function ( k ) {

			return k * k;

		},

		Out: function ( k ) {

			return k * ( 2 - k );

		},

		InOut: function ( k ) {

			if ( ( k *= 2 ) < 1 ) return 0.5 * k * k;
			return - 0.5 * ( --k * ( k - 2 ) - 1 );

		}

	},

	Cubic: {

		In: function ( k ) {

			return k * k * k;

		},

		Out: function ( k ) {

			return --k * k * k + 1;

		},

		InOut: function ( k ) {

			if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k;
			return 0.5 * ( ( k -= 2 ) * k * k + 2 );

		}

	},

	Quartic: {

		In: function ( k ) {

			return k * k * k * k;

		},

		Out: function ( k ) {

			return 1 - ( --k * k * k * k );

		},

		InOut: function ( k ) {

			if ( ( k *= 2 ) < 1) return 0.5 * k * k * k * k;
			return - 0.5 * ( ( k -= 2 ) * k * k * k - 2 );

		}

	},

	Quintic: {

		In: function ( k ) {

			return k * k * k * k * k;

		},

		Out: function ( k ) {

			return --k * k * k * k * k + 1;

		},

		InOut: function ( k ) {

			if ( ( k *= 2 ) < 1 ) return 0.5 * k * k * k * k * k;
			return 0.5 * ( ( k -= 2 ) * k * k * k * k + 2 );

		}

	},

	Sinusoidal: {

		In: function ( k ) {

			return 1 - Math.cos( k * Math.PI / 2 );

		},

		Out: function ( k ) {

			return Math.sin( k * Math.PI / 2 );

		},

		InOut: function ( k ) {

			return 0.5 * ( 1 - Math.cos( Math.PI * k ) );

		}

	},

	Exponential: {

		In: function ( k ) {

			return k === 0 ? 0 : Math.pow( 1024, k - 1 );

		},

		Out: function ( k ) {

			return k === 1 ? 1 : 1 - Math.pow( 2, - 10 * k );

		},

		InOut: function ( k ) {

			if ( k === 0 ) return 0;
			if ( k === 1 ) return 1;
			if ( ( k *= 2 ) < 1 ) return 0.5 * Math.pow( 1024, k - 1 );
			return 0.5 * ( - Math.pow( 2, - 10 * ( k - 1 ) ) + 2 );

		}

	},

	Circular: {

		In: function ( k ) {

			return 1 - Math.sqrt( 1 - k * k );

		},

		Out: function ( k ) {

			return Math.sqrt( 1 - ( --k * k ) );

		},

		InOut: function ( k ) {

			if ( ( k *= 2 ) < 1) return - 0.5 * ( Math.sqrt( 1 - k * k) - 1);
			return 0.5 * ( Math.sqrt( 1 - ( k -= 2) * k) + 1);

		}

	},

	Elastic: {

		In: function ( k ) {

			var s, a = 0.1, p = 0.4;
			if ( k === 0 ) return 0;
			if ( k === 1 ) return 1;
			if ( !a || a < 1 ) { a = 1; s = p / 4; }
			else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );
			return - ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );

		},

		Out: function ( k ) {

			var s, a = 0.1, p = 0.4;
			if ( k === 0 ) return 0;
			if ( k === 1 ) return 1;
			if ( !a || a < 1 ) { a = 1; s = p / 4; }
			else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );
			return ( a * Math.pow( 2, - 10 * k) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) + 1 );

		},

		InOut: function ( k ) {

			var s, a = 0.1, p = 0.4;
			if ( k === 0 ) return 0;
			if ( k === 1 ) return 1;
			if ( !a || a < 1 ) { a = 1; s = p / 4; }
			else s = p * Math.asin( 1 / a ) / ( 2 * Math.PI );
			if ( ( k *= 2 ) < 1 ) return - 0.5 * ( a * Math.pow( 2, 10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) );
			return a * Math.pow( 2, -10 * ( k -= 1 ) ) * Math.sin( ( k - s ) * ( 2 * Math.PI ) / p ) * 0.5 + 1;

		}

	},

	Back: {

		In: function ( k ) {

			var s = 1.70158;
			return k * k * ( ( s + 1 ) * k - s );

		},

		Out: function ( k ) {

			var s = 1.70158;
			return --k * k * ( ( s + 1 ) * k + s ) + 1;

		},

		InOut: function ( k ) {

			var s = 1.70158 * 1.525;
			if ( ( k *= 2 ) < 1 ) return 0.5 * ( k * k * ( ( s + 1 ) * k - s ) );
			return 0.5 * ( ( k -= 2 ) * k * ( ( s + 1 ) * k + s ) + 2 );

		}

	},

	Bounce: {

		In: function ( k ) {

			return 1 - TWEEN.Easing.Bounce.Out( 1 - k );

		},

		Out: function ( k ) {

			if ( k < ( 1 / 2.75 ) ) {

				return 7.5625 * k * k;

			} else if ( k < ( 2 / 2.75 ) ) {

				return 7.5625 * ( k -= ( 1.5 / 2.75 ) ) * k + 0.75;

			} else if ( k < ( 2.5 / 2.75 ) ) {

				return 7.5625 * ( k -= ( 2.25 / 2.75 ) ) * k + 0.9375;

			} else {

				return 7.5625 * ( k -= ( 2.625 / 2.75 ) ) * k + 0.984375;

			}

		},

		InOut: function ( k ) {

			if ( k < 0.5 ) return TWEEN.Easing.Bounce.In( k * 2 ) * 0.5;
			return TWEEN.Easing.Bounce.Out( k * 2 - 1 ) * 0.5 + 0.5;

		}

	}

};

TWEEN.Interpolation = {

	Linear: function ( v, k ) {

		var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.Linear;

		if ( k < 0 ) return fn( v[ 0 ], v[ 1 ], f );
		if ( k > 1 ) return fn( v[ m ], v[ m - 1 ], m - f );

		return fn( v[ i ], v[ i + 1 > m ? m : i + 1 ], f - i );

	},

	Bezier: function ( v, k ) {

		var b = 0, n = v.length - 1, pw = Math.pow, bn = TWEEN.Interpolation.Utils.Bernstein, i;

		for ( i = 0; i <= n; i++ ) {
			b += pw( 1 - k, n - i ) * pw( k, i ) * v[ i ] * bn( n, i );
		}

		return b;

	},

	CatmullRom: function ( v, k ) {

		var m = v.length - 1, f = m * k, i = Math.floor( f ), fn = TWEEN.Interpolation.Utils.CatmullRom;

		if ( v[ 0 ] === v[ m ] ) {

			if ( k < 0 ) i = Math.floor( f = m * ( 1 + k ) );

			return fn( v[ ( i - 1 + m ) % m ], v[ i ], v[ ( i + 1 ) % m ], v[ ( i + 2 ) % m ], f - i );

		} else {

			if ( k < 0 ) return v[ 0 ] - ( fn( v[ 0 ], v[ 0 ], v[ 1 ], v[ 1 ], -f ) - v[ 0 ] );
			if ( k > 1 ) return v[ m ] - ( fn( v[ m ], v[ m ], v[ m - 1 ], v[ m - 1 ], f - m ) - v[ m ] );

			return fn( v[ i ? i - 1 : 0 ], v[ i ], v[ m < i + 1 ? m : i + 1 ], v[ m < i + 2 ? m : i + 2 ], f - i );

		}

	},

	Utils: {

		Linear: function ( p0, p1, t ) {

			return ( p1 - p0 ) * t + p0;

		},

		Bernstein: function ( n , i ) {

			var fc = TWEEN.Interpolation.Utils.Factorial;
			return fc( n ) / fc( i ) / fc( n - i );

		},

		Factorial: ( function () {

			var a = [ 1 ];

			return function ( n ) {

				var s = 1, i;
				if ( a[ n ] ) return a[ n ];
				for ( i = n; i > 1; i-- ) s *= i;
				return a[ n ] = s;

			};

		} )(),

		CatmullRom: function ( p0, p1, p2, p3, t ) {

			var v0 = ( p2 - p0 ) * 0.5, v1 = ( p3 - p1 ) * 0.5, t2 = t * t, t3 = t * t2;
			return ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;

		}

	}

};

module.exports=TWEEN;
},{}],10:[function(require,module,exports){
(function (global){
// class modules
var States = require('./states');
var Spinner = require('./spinner');
var SpinButton = require('./spin-button');
var Mediator = require("mediator-js").Mediator;

// globals
global.activity = {};
global.activity.mediator = new Mediator();
global.activity.mediator.subscribe('state', function(state) {
	global.activity.state = state;
});


$(document).ready(function() {
	var spinner = new Spinner([
		'ett',
		'två',
		'tre',
		'fyra'
	], $('#spinaroo'));

	new SpinButton(spinner, $("#stop"));

	global.activity.mediator.publish('state', States.IDLE);

	if($.cookie('activity') !== null) {
		var activities = $.cookie('activity').split(/\s*,\s*/);
		spinner.newTexts(activities);
		$("#updateText").val(activities.join(', '));
	}
});

$("#updateSubmit").on('click', function() {
	$.cookie('activity', $('#updateText').val().toString());
	location.reload();
});
$("#cookieDebug").on('click', function() {
	$.cookie('activity', null);
	location.reload();
});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./spin-button":12,"./spinner":13,"./states":17,"mediator-js":6}],11:[function(require,module,exports){
module.exports = {
    // how often the spinner updates
	FPS: 30,

    // how fast the spinner spins (max velocity)
	LOOPS_PER_SECOND: 2,

    // acceleration/deceleration time (in approximate seconds)
    ACCELERATION_TIME: 2,
    DECELERATION_TIME: 5,

	// spinning-text position boundaries
    MIN_POSITION: 0,
    MAX_POSITION: 100,
    MIDDLE_POSITION: 50,

    // ratio between container size and position boundaries
    STEP: 10, 

    // color interpolation (use hsl)
    FROM_COLOR: 'hsl(48, 100%, 50%)',
    TO_COLOR: 'hsl(29, 100%, 50%)',
};

},{}],12:[function(require,module,exports){
(function (global){
var States = require('./states');

module.exports = (function() {
	function SpinButton(spinner, $button) {
		this._spinner = spinner;
		this.$ = $button;
		this.$.html('start');

		var instance = this;
		$button.on('click', function() {
			switch (global.activity.state) {
				case States.IDLE:
					global.activity.mediator.publish('state', States.SPIN);
					break;
				case States.SPIN:
					global.activity.mediator.publish('state', States.STOP);
					break;
				case States.STOP:
					// do nothing
					break;
			}
		});

		global.activity.mediator.subscribe('state', function(state) {
			switch (state) {
				case States.IDLE:
					instance.$.html('start');
					break;
				case States.SPIN:
					instance.$.html('stop');
					break;
				case States.STOP:
					instance.$.html('stopping...');
					break;
			}
		});
	}

	return SpinButton;
})();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./states":17}],13:[function(require,module,exports){
(function (global){
var States = require('./states');
var SpinningText = require('./spinning-text');
var Constants = require('./constants');
var TWEEN = require('tween.js');

module.exports = (function() {
	function Spinner(texts, $container) {
		var instance = this; // booo

		this._$container = $container;

		// init the texts
		this.newTexts(texts);

		// loop/update values
		this._loopRunning = false;
		this._velocity = 0;
		this._accelerationStep = 1 / (Constants.ACCELERATION_TIME * Constants.FPS);
		this._decelerationStep = 1 / (Constants.DECELERATION_TIME * Constants.FPS);
		this._delay = 1000 / Constants.FPS;

		// register mediator subscription
		global.activity.mediator.subscribe('state', function(state) {
			switch (state) {
				case States.IDLE:
					instance._loopRunning = false;
					break;
				case States.SPIN:
					if (!instance._loopRunning) {
						instance._newWinner();
						instance._loopRunning = true;
						instance._time = typeof window !== 'undefined' && window.performance !== undefined && window.performance.now !== undefined ? window.performance.now() : Date.now();
						instance._loop(instance);
					}
					break;
				case States.STOP:
					break;
			}
		});
	}

	Spinner.prototype.newTexts = function(texts) {
		var instance = this;

		this._$container.html('');
		this._spinningTexts = [];
		texts.forEach(function(text, i) {
			var spinningText = new SpinningText(text, (Constants.MIDDLE_POSITION + i * (Constants.MAX_POSITION / texts.length)) % Constants.MAX_POSITION);
			instance._spinningTexts.push(spinningText);
			spinningText.appendTo(instance._$container);
		});
	};

	Spinner.prototype._newWinner = function() {
		this._winner = this._spinningTexts[Math.floor(Math.random() * this._spinningTexts.length)];
	};

	Spinner.prototype._render = function() {
		this._spinningTexts.forEach(function(spinningText) {
			spinningText.render();
		}.bind(this));
	};

	Spinner.prototype._update = function(dt) {
		if (global.activity.state === States.SPIN && this._velocity <= 1) {
	 		this._velocity += this._accelerationStep;
		} else if (global.activity.state === States.STOP) {
			if (this._velocity > 0.05) {
				this._velocity -= this._decelerationStep;
			} 

			if (this._velocity < 0.4 && this._winner.winningPosition() && Math.random() < 0.99) {
				if (typeof this._tween === 'undefined') {
					var instance = this;

					// stopping animation
					this._tween = new TWEEN.Tween({x: instance._winner.getPosition()})
		            .to({x: [Constants.MIDDLE_POSITION + this._velocity * Constants.LOOPS_PER_SECOND * 20, instance._winner.getPosition()]}, Constants.LOOPS_PER_SECOND * 500)
		            .easing(TWEEN.Easing.Back.Out)
		            .onUpdate(function () {
		            	instance._winner._position = this.x;
		            })
		            .onComplete(function() {
		            	delete instance._tween;
		        		global.activity.mediator.publish('state', States.IDLE);
		            })
		            .start();

					this._velocity = 0;
				}
			}
		}

		if (typeof this._tween === 'undefined') {
			this._spinningTexts.forEach(function(spinningText) {
				spinningText.update(this._velocity, dt);
			}.bind(this));
		} else {
			TWEEN.update();
		}
		
	};

	Spinner.prototype._loop = function(instance) {
		// get delta time
		var time = typeof window !== 'undefined' && window.performance !== undefined && window.performance.now !== undefined ? window.performance.now() : Date.now();
		dt = (time - instance._time);

		instance._update(dt);
		instance._render();

		// store time for next loop
		instance._time = typeof window !== 'undefined' && window.performance !== undefined && window.performance.now !== undefined ? window.performance.now() : Date.now();
		
		// adjust delay based on execution time of loop
		var delay = instance._delay - (instance._time - time);
		delay = delay < 0 ? 0 : delay;

		// loop!
		if (global.activity.state !== States.IDLE) {
			setTimeout(instance._loop, delay, instance);
		}
	};

	return Spinner;
})();

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./constants":11,"./spinning-text":16,"./states":17,"tween.js":9}],14:[function(require,module,exports){
var Constants = require('./constants');
var smoothstep = require('interpolation').smoothstep;

module.exports = {
	normalizedPosition: function(position) {
        return smoothstep(0, 1, 1 - Math.abs(position - Constants.MAX_POSITION / 2) / (Constants.MAX_POSITION / 2));
    },

    fontSize: function(smoothsteppedPos) {
        return (16 + smoothsteppedPos * 32) + 'pt';
    },

    textShadow: function(textShadowCss, color) {
        return textShadowCss.replace(/rgba?\([^\)]+\)/, color);
    },

    right: function(position) {
        return position * Constants.STEP;
    }
};

},{"./constants":11,"interpolation":2}],15:[function(require,module,exports){
var interpolateColor = require('jsantell-interpolate-color');
var Constants = require('./constants');
var Helpers = require('./spinning-text-helpers');

module.exports = (function () {
    function SpinningTextLookup(granularity, textShadowCss) {
        this._granularity = granularity || Constants.MAX_POSITION;
        this._ratio = (Constants.MAX_POSITION - Constants.MIN_POSITION) / this._granularity;

        var i, pos;

        // makes sure that the middle positioning is always included in the lookups
        var startPos;
        for (startPos = 0; startPos < Constants.MIDDLE_POSITION; startPos += this._ratio);
        startPos = startPos % Constants.MIDDLE_POSITION;

        // create the lookup arrays
        this._normalizedPosition = [];
        this._color = [];
        this._fontSize = [];
        this._textShadow = [];
        this._right = [];
        for (i = 0; i < this._granularity; i++) {
            pos = startPos + i * this._ratio;
    		this._normalizedPosition.push(Helpers.normalizedPosition(i * this._ratio));
            this._color.push(interpolateColor(Constants.FROM_COLOR, Constants.TO_COLOR, this._normalizedPosition[i]));
            this._fontSize.push(Helpers.fontSize(this._normalizedPosition[i]));
            this._textShadow.push(Helpers.textShadow(textShadowCss, this._color[i]));
            this._right.push(Helpers.right(pos));
    	}
    }

    SpinningTextLookup.prototype.normalizedPosition = function(position) {
        return this._normalizedPosition[Math.floor(position / this._ratio)];
    };

    SpinningTextLookup.prototype.color = function(position) {
        return this._color[Math.floor(position / this._ratio)];
    };

    SpinningTextLookup.prototype.fontSize = function(position) {
        return this._fontSize[Math.floor(position / this._ratio)];
    };

    SpinningTextLookup.prototype.textShadow = function(position) {
        return this._textShadow[Math.floor(position / this._ratio)];
    };

    SpinningTextLookup.prototype.right = function(position) {
        return this._right[Math.floor(position / this._ratio)];
    };

    return SpinningTextLookup;
})();

},{"./constants":11,"./spinning-text-helpers":14,"jsantell-interpolate-color":5}],16:[function(require,module,exports){
var Constants = require('./constants');
var interpolateColor = require('jsantell-interpolate-color');
var Helpers = require('./spinning-text-helpers');
var SpinningTextLookup = require('./spinning-text-lookup');

module.exports = (function () {
    function SpinningText(text, position) {
        this._text = text || 'null';
        this._position = position || 0;
        this._previousPosition = 0;

        this._$ = $('<span>' + this._text + '</span>');

        this._lookup = new SpinningTextLookup(1000, this._$.css('text-shadow'), this._$.width());
    }

    SpinningText.prototype.appendTo = function($container) {
        $container.append(this._$);
        this.render();
    };

    SpinningText.prototype.update = function(velocity, dt) {
        this._previousPosition = this._position;
        var velocityFactor = Constants.LOOPS_PER_SECOND * (Constants.MAX_POSITION - Constants.MIN_POSITION) * (dt / 1000);
        this._position = this._position + velocity * velocityFactor;
        if (this._position > Constants.MAX_POSITION) {
            this._position = Constants.MIN_POSITION + this._position - Constants.MAX_POSITION;
        }
    };

    SpinningText.prototype.renderOld = function() {
        var normalizedPosition = Helpers.normalizedPosition(this._position);
        var color = interpolateColor(Constants.FROM_COLOR, Constants.TO_COLOR, normalizedPosition);

        // size
        this._$.css('font-size', Helpers.fontSize(normalizedPosition));

        // color
        this._$.css('color', color);

        // shadow (color)
        this._$.css('text-shadow', Helpers.textShadow(this._$.css('text-shadow'), color));

        // opacity
        this._$.css('opacity', normalizedPosition);

        // position
        this._$.css('right', Helpers.right(this._position, this._$.width()));
    };

    SpinningText.prototype.render = function() {
        this._$.css({
            'font-size': this._lookup.fontSize(this._position),
            'color': this._lookup.color(this._position),
            'text-shadow': this._lookup.textShadow(this._position),
            'opacity': this._lookup.normalizedPosition(this._position),
            'z-index': this._lookup.normalizedPosition(this._position)
        });
        // width varies with font-size, why this is done seperately
        this._$.css('right', this._lookup.right(this._position) - this._$.width() / 2);
    };

    SpinningText.prototype.getPosition = function() {
        return this._position;
    };

    SpinningText.prototype.getText = function() {
        return this._text;
    };

    SpinningText.prototype.winningPosition = function() {
        if (this._previousPosition < Constants.MIDDLE_POSITION && this._position >= Constants.MIDDLE_POSITION) {
            return true;
        }
        return false;
    };

    return SpinningText;
})();

},{"./constants":11,"./spinning-text-helpers":14,"./spinning-text-lookup":15,"jsantell-interpolate-color":5}],17:[function(require,module,exports){
module.exports = {
    IDLE: 0,
    SPIN: 1,
    STOP: 2
};

},{}]},{},[10])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL2ludGVycG9sYXRpb24vaW5kZXguanMiLCJub2RlX21vZHVsZXMvaW50ZXJwb2xhdGlvbi9ub2RlX21vZHVsZXMvbGVycC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9pbnRlcnBvbGF0aW9uL25vZGVfbW9kdWxlcy9zbW9vdGhzdGVwL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2pzYW50ZWxsLWludGVycG9sYXRlLWNvbG9yL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL21lZGlhdG9yLWpzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL21lZGlhdG9yLWpzL2xpYi1jb3YvbWVkaWF0b3IuanMiLCJub2RlX21vZHVsZXMvbWVkaWF0b3ItanMvbGliL21lZGlhdG9yLmpzIiwibm9kZV9tb2R1bGVzL3R3ZWVuLmpzL2luZGV4LmpzIiwic3JjL2pzL2FjdGl2aXR5LmpzIiwic3JjL2pzL2NvbnN0YW50cy5qcyIsInNyYy9qcy9zcGluLWJ1dHRvbi5qcyIsInNyYy9qcy9zcGlubmVyLmpzIiwic3JjL2pzL3NwaW5uaW5nLXRleHQtaGVscGVycy5qcyIsInNyYy9qcy9zcGlubmluZy10ZXh0LWxvb2t1cC5qcyIsInNyYy9qcy9zcGlubmluZy10ZXh0LmpzIiwic3JjL2pzL3N0YXRlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcGVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3B2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgc2V0VGltZW91dChkcmFpblF1ZXVlLCAwKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbi8vIFRPRE8oc2h0eWxtYW4pXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCIvKiogVXRpbGl0eSBmdW5jdGlvbiBmb3IgbGluZWFyIGludGVycG9sYXRpb24uICovXG5tb2R1bGUuZXhwb3J0cy5sZXJwID0gcmVxdWlyZSgnbGVycCcpXG5cbi8qKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciBIZXJtaXRlIGludGVycG9sYXRpb24uICovXG5tb2R1bGUuZXhwb3J0cy5zbW9vdGhzdGVwID0gcmVxdWlyZSgnc21vb3Roc3RlcCcpIiwiZnVuY3Rpb24gbGVycCh2MCwgdjEsIHQpIHtcbiAgICByZXR1cm4gdjAqKDEtdCkrdjEqdFxufVxubW9kdWxlLmV4cG9ydHMgPSBsZXJwIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzbW9vdGhzdGVwIChtaW4sIG1heCwgdmFsdWUpIHtcbiAgdmFyIHggPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCAodmFsdWUtbWluKS8obWF4LW1pbikpKTtcbiAgcmV0dXJuIHgqeCooMyAtIDIqeCk7XG59O1xuIiwiLyoqXG4gKiBBIHNpbXBsZSBjb2xvciBpbnRlcnBvbGF0b3IuXG4gKiBQYXJzZXMgYSBgZnJvbWAgYW5kIGB0b2AgSFNMIHN0cmluZyBpbiB0aGUgZm9ybWF0XG4gKiBgaHNsKDIwMCwgMTAwJSwgNTAlKWAgYW5kIGEgc3RlcCB2YWx1ZSBiZXR3ZWVuIDAgYW5kIDFcbiAqIGFuZCByZXR1cm5zIGEgbmV3IEhTTCBzdHJpbmcuXG4gKiBBbiBvcHRpb25hbCBgcHJlY2lzaW9uYCB2YWx1ZSBtYXkgYmUgcHJvdmlkZWQgZm9yIHRoZVxuICogbmV3IEhTTCBzdHJpbmdcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZnJvbVxuICogQHBhcmFtIHtzdHJpbmd9IHRvXG4gKiBAcGFyYW0ge251bWJlcn0gc3RlcFxuICogQHBhcmFtIHtwcmVjaXNpb259IG51bWJlclxuICovXG5cbnZhciByZWdleCA9IC9eaHNsXFwoXFxzKihbXFwtfFxcZHxcXC5dKilcXHMqLFxccyooW1xcZHxcXC5dKiklXFxzKixcXHMqKFtcXGR8XFwuXSopJS87XG5mdW5jdGlvbiBpbnRlcnBvbGF0ZSAoc3RhcnQsIGVuZCwgc3RlcCwgcHJlY2lzaW9uKSB7XG4gIHByZWNpc2lvbiA9IHByZWNpc2lvbiAhPSBudWxsID8gcHJlY2lzaW9uIDogMDtcbiAgc3RhcnQgPSBzdGFydC5tYXRjaChyZWdleCk7XG4gIGVuZCA9IGVuZC5tYXRjaChyZWdleCk7XG4gIHZhclxuICAgIHN0YXJ0SCA9ICtzdGFydFsxXSxcbiAgICBzdGFydFMgPSArc3RhcnRbMl0sXG4gICAgc3RhcnRMID0gK3N0YXJ0WzNdLFxuICAgIGVuZEggICA9ICtlbmRbMV0sXG4gICAgZW5kUyAgID0gK2VuZFsyXSxcbiAgICBlbmRMICAgPSArZW5kWzNdO1xuXG4gIHZhclxuICAgIGggPSAoc3RhcnRIIC0gKHN0YXJ0SCAtIGVuZEgpICogc3RlcCkudG9GaXhlZChwcmVjaXNpb24pLFxuICAgIHMgPSAoc3RhcnRTIC0gKHN0YXJ0UyAtIGVuZFMpICogc3RlcCkudG9GaXhlZChwcmVjaXNpb24pLFxuICAgIGwgPSAoc3RhcnRMIC0gKHN0YXJ0TCAtIGVuZEwpICogc3RlcCkudG9GaXhlZChwcmVjaXNpb24pO1xuXG4gIHJldHVybiAnaHNsKCcgKyBoICsgJywgJyArIHMgKyAnJSwgJyArIGwgKyAnJSknO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGludGVycG9sYXRlO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBwcm9jZXNzLmVudi5NRURJQVRPUl9KU19DT1ZcbiAgPyByZXF1aXJlKCcuL2xpYi1jb3YvbWVkaWF0b3InKVxuICA6IHJlcXVpcmUoJy4vbGliL21lZGlhdG9yJyk7XG4iLCIvKiBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBKU0NvdmVyYWdlIC0gZG8gbm90IGVkaXQgKi9cbnRyeSB7XG4gIGlmICh0eXBlb2YgdG9wID09PSAnb2JqZWN0JyAmJiB0b3AgIT09IG51bGwgJiYgdHlwZW9mIHRvcC5vcGVuZXIgPT09ICdvYmplY3QnICYmIHRvcC5vcGVuZXIgIT09IG51bGwpIHtcbiAgICAvLyB0aGlzIGlzIGEgYnJvd3NlciB3aW5kb3cgdGhhdCB3YXMgb3BlbmVkIGZyb20gYW5vdGhlciB3aW5kb3dcblxuICAgIGlmICghIHRvcC5vcGVuZXIuXyRqc2NvdmVyYWdlKSB7XG4gICAgICB0b3Aub3BlbmVyLl8kanNjb3ZlcmFnZSA9IHt9O1xuICAgIH1cbiAgfVxufVxuY2F0Y2ggKGUpIHt9XG5cbnRyeSB7XG4gIGlmICh0eXBlb2YgdG9wID09PSAnb2JqZWN0JyAmJiB0b3AgIT09IG51bGwpIHtcbiAgICAvLyB0aGlzIGlzIGEgYnJvd3NlciB3aW5kb3dcblxuICAgIHRyeSB7XG4gICAgICBpZiAodHlwZW9mIHRvcC5vcGVuZXIgPT09ICdvYmplY3QnICYmIHRvcC5vcGVuZXIgIT09IG51bGwgJiYgdG9wLm9wZW5lci5fJGpzY292ZXJhZ2UpIHtcbiAgICAgICAgdG9wLl8kanNjb3ZlcmFnZSA9IHRvcC5vcGVuZXIuXyRqc2NvdmVyYWdlO1xuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge31cblxuICAgIGlmICghIHRvcC5fJGpzY292ZXJhZ2UpIHtcbiAgICAgIHRvcC5fJGpzY292ZXJhZ2UgPSB7fTtcbiAgICB9XG4gIH1cbn1cbmNhdGNoIChlKSB7fVxuXG50cnkge1xuICBpZiAodHlwZW9mIHRvcCA9PT0gJ29iamVjdCcgJiYgdG9wICE9PSBudWxsICYmIHRvcC5fJGpzY292ZXJhZ2UpIHtcbiAgICBfJGpzY292ZXJhZ2UgPSB0b3AuXyRqc2NvdmVyYWdlO1xuICB9XG59XG5jYXRjaCAoZSkge31cbmlmICh0eXBlb2YgXyRqc2NvdmVyYWdlICE9PSAnb2JqZWN0Jykge1xuICBfJGpzY292ZXJhZ2UgPSB7fTtcbn1cbmlmICghIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXSkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ10gPSBbXTtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE2XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxN10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTldID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIxXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMl0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjRdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI2XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzM5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs0MF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNDFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzQ0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs1Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNTNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzU0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs1N10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNThdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzU5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs2MF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNjFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzY0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs3MF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNzFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzcyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs3M10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNzRdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzc1XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs4Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bODNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzg0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs4N10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bODhdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzg5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs5MF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bOTFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzEwMF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTAyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMDRdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzEwOF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTEwXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMTFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzExM10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTE1XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMThdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzEyMF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTI3XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMzFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzEzNF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTM1XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMzZdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE0Nl0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTUwXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNTFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE1Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTU0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNTddID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE1OF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTU5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNjFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE2Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTY2XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNzBdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE3NF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTc4XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxODBdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE4M10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTg0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxODVdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE4OV0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTkwXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxOTFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE5Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjAxXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMDddID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIwOF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjA5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMTBdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIxMV0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjEyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMTNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIxNl0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjE3XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMjFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIyMl0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjI0XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMjVdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIyN10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjMyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMzNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIzNl0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjQwXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNDFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI0Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjQ1XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNTFdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI1N10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjYyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNjNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI2Nl0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjY3XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNjldID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI3MF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjczXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNzddID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI4N10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjg5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyOTBdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI5Ml0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzAyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMDNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzMwNV0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzEyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMTldID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzMyOF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzMxXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMzNdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzMzOF0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzM5XSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszNDBdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzM0MV0gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzQyXSA9IDA7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszNDZdID0gMDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzM0N10gPSAwO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzQ4XSA9IDA7XG59XG5fJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ10uc291cmNlID0gW1wiLypqc2xpbnQgYml0d2lzZTogdHJ1ZSwgbm9tZW46IHRydWUsIHBsdXNwbHVzOiB0cnVlLCB3aGl0ZTogdHJ1ZSAqL1wiLFwiXCIsXCIvKiFcIixcIiogTWVkaWF0b3IuanMgTGlicmFyeSB2MC45LjBcIixcIiogaHR0cHM6Ly9naXRodWIuY29tL2FqYWNrc2lmaWVkL01lZGlhdG9yLmpzXCIsXCIqXCIsXCIqIENvcHlyaWdodCAyMDEzLCBKYWNrIExhd3NvblwiLFwiKiBNSVQgTGljZW5zZWQgKGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwKVwiLFwiKlwiLFwiKiBGb3IgbW9yZSBpbmZvcm1hdGlvbjogaHR0cDovL3RoZWphY2tsYXdzb24uY29tLzIwMTEvMDYvbWVkaWF0b3JzLWZvci1tb2R1bGFyaXplZC1hc3luY2hyb25vdXMtcHJvZ3JhbW1pbmctaW4tamF2YXNjcmlwdC9pbmRleC5odG1sXCIsXCIqIFByb2plY3Qgb24gR2l0SHViOiBodHRwczovL2dpdGh1Yi5jb20vYWphY2tzaWZpZWQvTWVkaWF0b3IuanNcIixcIipcIixcIiogTGFzdCB1cGRhdGU6IEphbiAwNCAyMDEzXCIsXCIqL1wiLFwiXCIsXCIoZnVuY3Rpb24ocm9vdCwgZmFjdG9yeSkge1wiLFwiICAndXNlIHN0cmljdCc7XCIsXCJcIixcIiAgaWYodHlwZW9mIHJvb3QuZXhwb3J0cyA9PT0gJ2Z1bmN0aW9uJykge1wiLFwiICAgIC8vIE5vZGUvQ29tbW9uSlNcIixcIiAgICByb290LmV4cG9ydHMuTWVkaWF0b3IgPSBmYWN0b3J5KCk7XCIsXCIgIH0gZWxzZSBpZih0eXBlb2Ygcm9vdC5kZWZpbmUgPT09ICdmdW5jdGlvbicgJmFtcDsmYW1wOyByb290LmRlZmluZS5hbWQpIHtcIixcIiAgICAvLyBBTURcIixcIiAgICByb290LmRlZmluZShbXSwgZnVuY3Rpb24oKSB7XCIsXCIgICAgICAvLyBFeHBvcnQgdG8gZ2xvYmFsIHRvbywgZm9yIGJhY2t3YXJkIGNvbXBhdGlibGl0eVwiLFwiICAgICAgcm9vdC5NZWRpYXRvciA9IGZhY3RvcnkoKTtcIixcIiAgICB9KTtcIixcIiAgfSBlbHNlIHtcIixcIiAgICAvLyBCcm93c2VyIGdsb2JhbFwiLFwiICAgIHJvb3QuTWVkaWF0b3IgPSBmYWN0b3J5KCk7XCIsXCIgIH1cIixcIn0odGhpcywgZnVuY3Rpb24oKSB7XCIsXCIgICd1c2Ugc3RyaWN0JztcIixcIlwiLFwiICAvLyBXZSdsbCBnZW5lcmF0ZSBndWlkcyBmb3IgY2xhc3MgaW5zdGFuY2VzIGZvciBlYXN5IHJlZmVyZW5jaW5nIGxhdGVyIG9uLlwiLFwiICAvLyBTdWJzY3JpYmVyIGluc3RhbmNlcyB3aWxsIGhhdmUgYW4gaWQgdGhhdCBjYW4gYmUgcmVmZXJuY2VkIGZvciBxdWlja1wiLFwiICAvLyBsb29rdXBzLlwiLFwiXCIsXCIgIGZ1bmN0aW9uIGd1aWRHZW5lcmF0b3IoKSB7XCIsXCIgICAgdmFyIFM0ID0gZnVuY3Rpb24oKSB7XCIsXCIgICAgICAgcmV0dXJuICgoKDErTWF0aC5yYW5kb20oKSkqMHgxMDAwMCl8MCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcIixcIiAgICB9O1wiLFwiXCIsXCIgICAgcmV0dXJuIChTNCgpK1M0KCkrXFxcIi1cXFwiK1M0KCkrXFxcIi1cXFwiK1M0KCkrXFxcIi1cXFwiK1M0KCkrXFxcIi1cXFwiK1M0KCkrUzQoKStTNCgpKTtcIixcIiAgfVwiLFwiXCIsXCIgIC8vIFN1YnNjcmliZXJzIGFyZSBpbnN0YW5jZXMgb2YgTWVkaWF0b3IgQ2hhbm5lbCByZWdpc3RyYXRpb25zLiBXZSBnZW5lcmF0ZVwiLFwiICAvLyBhbiBvYmplY3QgaW5zdGFuY2Ugc28gdGhhdCBpdCBjYW4gYmUgdXBkYXRlZCBsYXRlciBvbiB3aXRob3V0IGhhdmluZyB0b1wiLFwiICAvLyB1bnJlZ2lzdGVyIGFuZCByZS1yZWdpc3Rlci4gU3Vic2NyaWJlcnMgYXJlIGNvbnN0cnVjdGVkIHdpdGggYSBmdW5jdGlvblwiLFwiICAvLyB0byBiZSBjYWxsZWQsIG9wdGlvbnMgb2JqZWN0LCBhbmQgY29udGV4dC5cIixcIlwiLFwiICBmdW5jdGlvbiBTdWJzY3JpYmVyKGZuLCBvcHRpb25zLCBjb250ZXh0KXtcIixcIiAgICBpZighKHRoaXMgaW5zdGFuY2VvZiBTdWJzY3JpYmVyKSkge1wiLFwiICAgICAgcmV0dXJuIG5ldyBTdWJzY3JpYmVyKGZuLCBvcHRpb25zLCBjb250ZXh0KTtcIixcIiAgICB9XCIsXCJcIixcIiAgICB0aGlzLmlkID0gZ3VpZEdlbmVyYXRvcigpO1wiLFwiICAgIHRoaXMuZm4gPSBmbjtcIixcIiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1wiLFwiICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XCIsXCIgICAgdGhpcy5jaGFubmVsID0gbnVsbDtcIixcIiAgfVwiLFwiXCIsXCIgIFN1YnNjcmliZXIucHJvdG90eXBlID0ge1wiLFwiICAgIC8vIE1lZGlhdG9yLnVwZGF0ZSBvbiBhIHN1YnNjcmliZXIgaW5zdGFuY2UgY2FuIHVwZGF0ZSBpdHMgZnVuY3Rpb24sY29udGV4dCxcIixcIiAgICAvLyBvciBvcHRpb25zIG9iamVjdC4gSXQgdGFrZXMgaW4gYW4gb2JqZWN0IGFuZCBsb29rcyBmb3IgZm4sIGNvbnRleHQsIG9yXCIsXCIgICAgLy8gb3B0aW9ucyBrZXlzLlwiLFwiXCIsXCIgICAgdXBkYXRlOiBmdW5jdGlvbihvcHRpb25zKXtcIixcIiAgICAgIGlmKG9wdGlvbnMpe1wiLFwiICAgICAgICB0aGlzLmZuID0gb3B0aW9ucy5mbiB8fCB0aGlzLmZuO1wiLFwiICAgICAgICB0aGlzLmNvbnRleHQgPSBvcHRpb25zLmNvbnRleHQgfHwgdGhpcy5jb250ZXh0O1wiLFwiICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zLm9wdGlvbnMgfHwgdGhpcy5vcHRpb25zO1wiLFwiICAgICAgICBpZih0aGlzLmNoYW5uZWwgJmFtcDsmYW1wOyB0aGlzLm9wdGlvbnMgJmFtcDsmYW1wOyB0aGlzLm9wdGlvbnMucHJpb3JpdHkgIT09IHVuZGVmaW5lZCkge1wiLFwiICAgICAgICAgICAgdGhpcy5jaGFubmVsLnNldFByaW9yaXR5KHRoaXMuaWQsIHRoaXMub3B0aW9ucy5wcmlvcml0eSk7XCIsXCIgICAgICAgIH1cIixcIiAgICAgIH1cIixcIiAgICB9XCIsXCIgIH07XCIsXCJcIixcIlwiLFwiICBmdW5jdGlvbiBDaGFubmVsKG5hbWVzcGFjZSwgcGFyZW50KXtcIixcIiAgICBpZighKHRoaXMgaW5zdGFuY2VvZiBDaGFubmVsKSkge1wiLFwiICAgICAgcmV0dXJuIG5ldyBDaGFubmVsKG5hbWVzcGFjZSk7XCIsXCIgICAgfVwiLFwiXCIsXCIgICAgdGhpcy5uYW1lc3BhY2UgPSBuYW1lc3BhY2UgfHwgXFxcIlxcXCI7XCIsXCIgICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBbXTtcIixcIiAgICB0aGlzLl9jaGFubmVscyA9IFtdO1wiLFwiICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcIixcIiAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcIixcIiAgfVwiLFwiXCIsXCIgIC8vIEEgTWVkaWF0b3IgY2hhbm5lbCBob2xkcyBhIGxpc3Qgb2Ygc3ViLWNoYW5uZWxzIGFuZCBzdWJzY3JpYmVycyB0byBiZSBmaXJlZFwiLFwiICAvLyB3aGVuIE1lZGlhdG9yLnB1Ymxpc2ggaXMgY2FsbGVkIG9uIHRoZSBNZWRpYXRvciBpbnN0YW5jZS4gSXQgYWxzbyBjb250YWluc1wiLFwiICAvLyBzb21lIG1ldGhvZHMgdG8gbWFuaXB1bGF0ZSBpdHMgbGlzdHMgb2YgZGF0YTsgb25seSBzZXRQcmlvcml0eSBhbmRcIixcIiAgLy8gU3RvcFByb3BhZ2F0aW9uIGFyZSBtZWFudCB0byBiZSB1c2VkLiBUaGUgb3RoZXIgbWV0aG9kcyBzaG91bGQgYmUgYWNjZXNzZWRcIixcIiAgLy8gdGhyb3VnaCB0aGUgTWVkaWF0b3IgaW5zdGFuY2UuXCIsXCJcIixcIiAgQ2hhbm5lbC5wcm90b3R5cGUgPSB7XCIsXCIgICAgYWRkU3Vic2NyaWJlcjogZnVuY3Rpb24oZm4sIG9wdGlvbnMsIGNvbnRleHQpe1wiLFwiICAgICAgdmFyIHN1YnNjcmliZXIgPSBuZXcgU3Vic2NyaWJlcihmbiwgb3B0aW9ucywgY29udGV4dCk7XCIsXCJcIixcIiAgICAgIGlmKG9wdGlvbnMgJmFtcDsmYW1wOyBvcHRpb25zLnByaW9yaXR5ICE9PSB1bmRlZmluZWQpe1wiLFwiICAgICAgICAvLyBDaGVhcCBoYWNrIHRvIGVpdGhlciBwYXJzZSBhcyBhbiBpbnQgb3IgdHVybiBpdCBpbnRvIDAuIFJ1bnMgZmFzdGVyXCIsXCIgICAgICAgIC8vIGluIG1hbnkgYnJvd3NlcnMgdGhhbiBwYXJzZUludCB3aXRoIHRoZSBiZW5lZml0IHRoYXQgaXQgd29uJ3RcIixcIiAgICAgICAgLy8gcmV0dXJuIGEgTmFOLlwiLFwiICAgICAgICBvcHRpb25zLnByaW9yaXR5ID0gb3B0aW9ucy5wcmlvcml0eSAmZ3Q7Jmd0OyAwO1wiLFwiXCIsXCIgICAgICAgIGlmKG9wdGlvbnMucHJpb3JpdHkgJmx0OyAwKXsgb3B0aW9ucy5wcmlvcml0eSA9IDA7IH1cIixcIiAgICAgICAgaWYob3B0aW9ucy5wcmlvcml0eSAmZ3Q7PSB0aGlzLl9zdWJzY3JpYmVycy5sZW5ndGgpeyBvcHRpb25zLnByaW9yaXR5ID0gdGhpcy5fc3Vic2NyaWJlcnMubGVuZ3RoLTE7IH1cIixcIlwiLFwiICAgICAgICB0aGlzLl9zdWJzY3JpYmVycy5zcGxpY2Uob3B0aW9ucy5wcmlvcml0eSwgMCwgc3Vic2NyaWJlcik7XCIsXCIgICAgICB9ZWxzZXtcIixcIiAgICAgICAgdGhpcy5fc3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTtcIixcIiAgICAgIH1cIixcIlwiLFwiICAgICAgc3Vic2NyaWJlci5jaGFubmVsID0gdGhpcztcIixcIlwiLFwiICAgICAgcmV0dXJuIHN1YnNjcmliZXI7XCIsXCIgICAgfSxcIixcIlwiLFwiICAgIC8vIFRoZSBjaGFubmVsIGluc3RhbmNlIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgbWVkaWF0b3Igc3Vic2NyaWJlcixcIixcIiAgICAvLyBhbmQgZnVydGhlciBzdWJzY3JpYmVyIHByb3BhZ2F0aW9uIGNhbiBiZSBjYWxsZWQgd2l0aFwiLFwiICAgIC8vIGNoYW5uZWwuU3RvcFByb3BhZ2F0aW9uKCkuXCIsXCIgICAgc3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbigpe1wiLFwiICAgICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcIixcIiAgICB9LFwiLFwiXCIsXCIgICAgZ2V0U3Vic2NyaWJlcjogZnVuY3Rpb24oaWRlbnRpZmllcil7XCIsXCIgICAgICB2YXIgeCA9IDAsXCIsXCIgICAgICAgICAgeSA9IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aDtcIixcIlwiLFwiICAgICAgZm9yKHgsIHk7IHggJmx0OyB5OyB4Kyspe1wiLFwiICAgICAgICBpZih0aGlzLl9zdWJzY3JpYmVyc1t4XS5pZCA9PT0gaWRlbnRpZmllciB8fCB0aGlzLl9zdWJzY3JpYmVyc1t4XS5mbiA9PT0gaWRlbnRpZmllcil7XCIsXCIgICAgICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZXJzW3hdO1wiLFwiICAgICAgICB9XCIsXCIgICAgICB9XCIsXCIgICAgfSxcIixcIlwiLFwiICAgIC8vIENoYW5uZWwuc2V0UHJpb3JpdHkgaXMgdXNlZnVsIGluIHVwZGF0aW5nIHRoZSBvcmRlciBpbiB3aGljaCBTdWJzY3JpYmVyc1wiLFwiICAgIC8vIGFyZSBjYWxsZWQsIGFuZCB0YWtlcyBhbiBpZGVudGlmaWVyIChzdWJzY3JpYmVyIGlkIG9yIG5hbWVkIGZ1bmN0aW9uKSBhbmRcIixcIiAgICAvLyBhbiBhcnJheSBpbmRleC4gSXQgd2lsbCBub3Qgc2VhcmNoIHJlY3Vyc2l2ZWx5IHRocm91Z2ggc3ViY2hhbm5lbHMuXCIsXCJcIixcIiAgICBzZXRQcmlvcml0eTogZnVuY3Rpb24oaWRlbnRpZmllciwgcHJpb3JpdHkpe1wiLFwiICAgICAgdmFyIG9sZEluZGV4ID0gMCxcIixcIiAgICAgICAgICB4ID0gMCxcIixcIiAgICAgICAgICBzdWIsIGZpcnN0SGFsZiwgbGFzdEhhbGYsIHk7XCIsXCJcIixcIiAgICAgIGZvcih4ID0gMCwgeSA9IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aDsgeCAmbHQ7IHk7IHgrKyl7XCIsXCIgICAgICAgIGlmKHRoaXMuX3N1YnNjcmliZXJzW3hdLmlkID09PSBpZGVudGlmaWVyIHx8IHRoaXMuX3N1YnNjcmliZXJzW3hdLmZuID09PSBpZGVudGlmaWVyKXtcIixcIiAgICAgICAgICBicmVhaztcIixcIiAgICAgICAgfVwiLFwiICAgICAgICBvbGRJbmRleCArKztcIixcIiAgICAgIH1cIixcIlwiLFwiICAgICAgc3ViID0gdGhpcy5fc3Vic2NyaWJlcnNbb2xkSW5kZXhdO1wiLFwiICAgICAgZmlyc3RIYWxmID0gdGhpcy5fc3Vic2NyaWJlcnMuc2xpY2UoMCwgb2xkSW5kZXgpO1wiLFwiICAgICAgbGFzdEhhbGYgPSB0aGlzLl9zdWJzY3JpYmVycy5zbGljZShvbGRJbmRleCsxKTtcIixcIlwiLFwiICAgICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBmaXJzdEhhbGYuY29uY2F0KGxhc3RIYWxmKTtcIixcIiAgICAgIHRoaXMuX3N1YnNjcmliZXJzLnNwbGljZShwcmlvcml0eSwgMCwgc3ViKTtcIixcIiAgICB9LFwiLFwiXCIsXCIgICAgYWRkQ2hhbm5lbDogZnVuY3Rpb24oY2hhbm5lbCl7XCIsXCIgICAgICB0aGlzLl9jaGFubmVsc1tjaGFubmVsXSA9IG5ldyBDaGFubmVsKCh0aGlzLm5hbWVzcGFjZSA/IHRoaXMubmFtZXNwYWNlICsgJzonIDogJycpICsgY2hhbm5lbCwgdGhpcyk7XCIsXCIgICAgfSxcIixcIlwiLFwiICAgIGhhc0NoYW5uZWw6IGZ1bmN0aW9uKGNoYW5uZWwpe1wiLFwiICAgICAgcmV0dXJuIHRoaXMuX2NoYW5uZWxzLmhhc093blByb3BlcnR5KGNoYW5uZWwpO1wiLFwiICAgIH0sXCIsXCJcIixcIiAgICByZXR1cm5DaGFubmVsOiBmdW5jdGlvbihjaGFubmVsKXtcIixcIiAgICAgIHJldHVybiB0aGlzLl9jaGFubmVsc1tjaGFubmVsXTtcIixcIiAgICB9LFwiLFwiXCIsXCIgICAgcmVtb3ZlU3Vic2NyaWJlcjogZnVuY3Rpb24oaWRlbnRpZmllcil7XCIsXCIgICAgICB2YXIgeCA9IDAsXCIsXCIgICAgICAgICAgeTtcIixcIiAgICAgICAgICB5ID0gdGhpcy5fc3Vic2NyaWJlcnMubGVuZ3RoO1wiLFwiXCIsXCIgICAgICAvLyBJZiB3ZSBkb24ndCBwYXNzIGluIGFuIGlkLCB3ZSdyZSBjbGVhcmluZyBhbGxcIixcIiAgICAgIGlmKCFpZGVudGlmaWVyKXtcIixcIiAgICAgICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBbXTtcIixcIiAgICAgICAgcmV0dXJuO1wiLFwiICAgICAgfVwiLFwiXCIsXCIgICAgICAvLyBHb2luZyBiYWNrd2FyZHMgbWFrZXMgc3BsaWNpbmcgYSB3aG9sZSBsb3QgZWFzaWVyLlwiLFwiICAgICAgZm9yKHgsIHk7IHkgJmd0OyB4OyB5LS0pIHtcIixcIiAgICAgICAgaWYodGhpcy5fc3Vic2NyaWJlcnNbeF0uZm4gPT09IGlkZW50aWZpZXIgfHwgdGhpcy5fc3Vic2NyaWJlcnNbeF0uaWQgPT09IGlkZW50aWZpZXIpe1wiLFwiICAgICAgICAgIHRoaXMuX3N1YnNjcmliZXJzW3hdLmNoYW5uZWwgPSBudWxsO1wiLFwiICAgICAgICAgIHRoaXMuX3N1YnNjcmliZXJzLnNwbGljZSh4LDEpO1wiLFwiICAgICAgICB9XCIsXCIgICAgICB9XCIsXCIgICAgfSxcIixcIlwiLFwiICAgIC8vIFRoaXMgd2lsbCBwdWJsaXNoIGFyYml0cmFyeSBhcmd1bWVudHMgdG8gYSBzdWJzY3JpYmVyIGFuZCB0aGVuIHRvIHBhcmVudFwiLFwiICAgIC8vIGNoYW5uZWxzLlwiLFwiXCIsXCIgICAgcHVibGlzaDogZnVuY3Rpb24oZGF0YSl7XCIsXCIgICAgICB2YXIgeCA9IDAsXCIsXCIgICAgICAgICAgeSA9IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aCxcIixcIiAgICAgICAgICBjYWxsZWQgPSBmYWxzZSxcIixcIiAgICAgICAgICBzdWJzY3JpYmVyLCBsO1wiLFwiXCIsXCIgICAgICAvLyBQcmlvcml0eSBpcyBwcmVzZXJ2ZWQgaW4gdGhlIF9zdWJzY3JpYmVycyBpbmRleC5cIixcIiAgICAgIGZvcih4LCB5OyB4ICZsdDsgeTsgeCsrKSB7XCIsXCIgICAgICAgIGlmKCF0aGlzLnN0b3BwZWQpe1wiLFwiICAgICAgICAgIHN1YnNjcmliZXIgPSB0aGlzLl9zdWJzY3JpYmVyc1t4XTtcIixcIiAgICAgICAgICBpZihzdWJzY3JpYmVyLm9wdGlvbnMgIT09IHVuZGVmaW5lZCAmYW1wOyZhbXA7IHR5cGVvZiBzdWJzY3JpYmVyLm9wdGlvbnMucHJlZGljYXRlID09PSBcXFwiZnVuY3Rpb25cXFwiKXtcIixcIiAgICAgICAgICAgIGlmKHN1YnNjcmliZXIub3B0aW9ucy5wcmVkaWNhdGUuYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKSl7XCIsXCIgICAgICAgICAgICAgIHN1YnNjcmliZXIuZm4uYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKTtcIixcIiAgICAgICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcIixcIiAgICAgICAgICAgIH1cIixcIiAgICAgICAgICB9ZWxzZXtcIixcIiAgICAgICAgICAgIHN1YnNjcmliZXIuZm4uYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKTtcIixcIiAgICAgICAgICAgIGNhbGxlZCA9IHRydWU7XCIsXCIgICAgICAgICAgfVwiLFwiICAgICAgICB9XCIsXCJcIixcIiAgICAgICAgaWYoY2FsbGVkICZhbXA7JmFtcDsgc3Vic2NyaWJlci5vcHRpb25zICZhbXA7JmFtcDsgc3Vic2NyaWJlci5vcHRpb25zICE9PSB1bmRlZmluZWQpe1wiLFwiICAgICAgICAgIHN1YnNjcmliZXIub3B0aW9ucy5jYWxscy0tO1wiLFwiXCIsXCIgICAgICAgICAgaWYoc3Vic2NyaWJlci5vcHRpb25zLmNhbGxzICZsdDsgMSl7XCIsXCIgICAgICAgICAgICB0aGlzLnJlbW92ZVN1YnNjcmliZXIoc3Vic2NyaWJlci5pZCk7XCIsXCIgICAgICAgICAgfWVsc2V7XCIsXCIgICAgICAgICAgICBzdWJzY3JpYmVyLnVwZGF0ZShzdWJzY3JpYmVyLm9wdGlvbnMpO1wiLFwiICAgICAgICAgIH1cIixcIiAgICAgICAgfVwiLFwiICAgICAgfVwiLFwiXCIsXCIgICAgICBpZih0aGlzLl9wYXJlbnQpe1wiLFwiICAgICAgICB0aGlzLl9wYXJlbnQucHVibGlzaChkYXRhKTtcIixcIiAgICAgIH1cIixcIlwiLFwiICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XCIsXCIgICAgfVwiLFwiICB9O1wiLFwiXCIsXCIgIGZ1bmN0aW9uIE1lZGlhdG9yKCkge1wiLFwiICAgIGlmKCEodGhpcyBpbnN0YW5jZW9mIE1lZGlhdG9yKSkge1wiLFwiICAgICAgcmV0dXJuIG5ldyBNZWRpYXRvcigpO1wiLFwiICAgIH1cIixcIlwiLFwiICAgIHRoaXMuX2NoYW5uZWxzID0gbmV3IENoYW5uZWwoJycpO1wiLFwiICB9XCIsXCJcIixcIiAgLy8gQSBNZWRpYXRvciBpbnN0YW5jZSBpcyB0aGUgaW50ZXJmYWNlIHRocm91Z2ggd2hpY2ggZXZlbnRzIGFyZSByZWdpc3RlcmVkXCIsXCIgIC8vIGFuZCByZW1vdmVkIGZyb20gcHVibGlzaCBjaGFubmVscy5cIixcIlwiLFwiICBNZWRpYXRvci5wcm90b3R5cGUgPSB7XCIsXCJcIixcIiAgICAvLyBSZXR1cm5zIGEgY2hhbm5lbCBpbnN0YW5jZSBiYXNlZCBvbiBuYW1lc3BhY2UsIGZvciBleGFtcGxlXCIsXCIgICAgLy8gYXBwbGljYXRpb246Y2hhdDptZXNzYWdlOnJlY2VpdmVkXCIsXCJcIixcIiAgICBnZXRDaGFubmVsOiBmdW5jdGlvbihuYW1lc3BhY2Upe1wiLFwiICAgICAgdmFyIGNoYW5uZWwgPSB0aGlzLl9jaGFubmVscyxcIixcIiAgICAgICAgICBuYW1lc3BhY2VIaWVyYXJjaHkgPSBuYW1lc3BhY2Uuc3BsaXQoJzonKSxcIixcIiAgICAgICAgICB4ID0gMCwgXCIsXCIgICAgICAgICAgeSA9IG5hbWVzcGFjZUhpZXJhcmNoeS5sZW5ndGg7XCIsXCJcIixcIiAgICAgIGlmKG5hbWVzcGFjZSA9PT0gJycpe1wiLFwiICAgICAgICByZXR1cm4gY2hhbm5lbDtcIixcIiAgICAgIH1cIixcIlwiLFwiICAgICAgaWYobmFtZXNwYWNlSGllcmFyY2h5Lmxlbmd0aCAmZ3Q7IDApe1wiLFwiICAgICAgICBmb3IoeCwgeTsgeCAmbHQ7IHk7IHgrKyl7XCIsXCJcIixcIiAgICAgICAgICBpZighY2hhbm5lbC5oYXNDaGFubmVsKG5hbWVzcGFjZUhpZXJhcmNoeVt4XSkpe1wiLFwiICAgICAgICAgICAgY2hhbm5lbC5hZGRDaGFubmVsKG5hbWVzcGFjZUhpZXJhcmNoeVt4XSk7XCIsXCIgICAgICAgICAgfVwiLFwiXCIsXCIgICAgICAgICAgY2hhbm5lbCA9IGNoYW5uZWwucmV0dXJuQ2hhbm5lbChuYW1lc3BhY2VIaWVyYXJjaHlbeF0pO1wiLFwiICAgICAgICB9XCIsXCIgICAgICB9XCIsXCJcIixcIiAgICAgIHJldHVybiBjaGFubmVsO1wiLFwiICAgIH0sXCIsXCJcIixcIiAgICAvLyBQYXNzIGluIGEgY2hhbm5lbCBuYW1lc3BhY2UsIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCwgb3B0aW9ucywgYW5kIGNvbnRleHRcIixcIiAgICAvLyB0byBjYWxsIHRoZSBmdW5jdGlvbiBpbiB0byBTdWJzY3JpYmUuIEl0IHdpbGwgY3JlYXRlIGEgY2hhbm5lbCBpZiBvbmVcIixcIiAgICAvLyBkb2VzIG5vdCBleGlzdC4gT3B0aW9ucyBjYW4gaW5jbHVkZSBhIHByZWRpY2F0ZSB0byBkZXRlcm1pbmUgaWYgaXRcIixcIiAgICAvLyBzaG91bGQgYmUgY2FsbGVkIChiYXNlZCBvbiB0aGUgZGF0YSBwdWJsaXNoZWQgdG8gaXQpIGFuZCBhIHByaW9yaXR5XCIsXCIgICAgLy8gaW5kZXguXCIsXCJcIixcIiAgICBzdWJzY3JpYmU6IGZ1bmN0aW9uKGNoYW5uZWxOYW1lLCBmbiwgb3B0aW9ucywgY29udGV4dCl7XCIsXCIgICAgICB2YXIgY2hhbm5lbCA9IHRoaXMuZ2V0Q2hhbm5lbChjaGFubmVsTmFtZSk7XCIsXCJcIixcIiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1wiLFwiICAgICAgY29udGV4dCA9IGNvbnRleHQgfHwge307XCIsXCJcIixcIiAgICAgIHJldHVybiBjaGFubmVsLmFkZFN1YnNjcmliZXIoZm4sIG9wdGlvbnMsIGNvbnRleHQpO1wiLFwiICAgIH0sXCIsXCJcIixcIiAgICAvLyBQYXNzIGluIGEgY2hhbm5lbCBuYW1lc3BhY2UsIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCwgb3B0aW9ucywgYW5kIGNvbnRleHRcIixcIiAgICAvLyB0byBjYWxsIHRoZSBmdW5jdGlvbiBpbiB0byBTdWJzY3JpYmUuIEl0IHdpbGwgY3JlYXRlIGEgY2hhbm5lbCBpZiBvbmVcIixcIiAgICAvLyBkb2VzIG5vdCBleGlzdC4gT3B0aW9ucyBjYW4gaW5jbHVkZSBhIHByZWRpY2F0ZSB0byBkZXRlcm1pbmUgaWYgaXRcIixcIiAgICAvLyBzaG91bGQgYmUgY2FsbGVkIChiYXNlZCBvbiB0aGUgZGF0YSBwdWJsaXNoZWQgdG8gaXQpIGFuZCBhIHByaW9yaXR5XCIsXCIgICAgLy8gaW5kZXguXCIsXCJcIixcIiAgICBvbmNlOiBmdW5jdGlvbihjaGFubmVsTmFtZSwgZm4sIG9wdGlvbnMsIGNvbnRleHQpe1wiLFwiICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XCIsXCIgICAgICBvcHRpb25zLmNhbGxzID0gMTtcIixcIlwiLFwiICAgICAgcmV0dXJuIHRoaXMuc3Vic2NyaWJlKGNoYW5uZWxOYW1lLCBmbiwgb3B0aW9ucywgY29udGV4dCk7XCIsXCIgICAgfSxcIixcIlwiLFwiICAgIC8vIFJldHVybnMgYSBzdWJzY3JpYmVyIGZvciBhIGdpdmVuIHN1YnNjcmliZXIgaWQgLyBuYW1lZCBmdW5jdGlvbiBhbmRcIixcIiAgICAvLyBjaGFubmVsIG5hbWVzcGFjZVwiLFwiXCIsXCIgICAgZ2V0U3Vic2NyaWJlcjogZnVuY3Rpb24oaWRlbnRpZmllciwgY2hhbm5lbCl7XCIsXCIgICAgICByZXR1cm4gdGhpcy5nZXRDaGFubmVsKGNoYW5uZWwgfHwgXFxcIlxcXCIpLmdldFN1YnNjcmliZXIoaWRlbnRpZmllcik7XCIsXCIgICAgfSxcIixcIlwiLFwiICAgIC8vIFJlbW92ZSBhIHN1YnNjcmliZXIgZnJvbSBhIGdpdmVuIGNoYW5uZWwgbmFtZXNwYWNlIHJlY3Vyc2l2ZWx5IGJhc2VkIG9uXCIsXCIgICAgLy8gYSBwYXNzZWQtaW4gc3Vic2NyaWJlciBpZCBvciBuYW1lZCBmdW5jdGlvbi5cIixcIlwiLFwiICAgIHJlbW92ZTogZnVuY3Rpb24oY2hhbm5lbE5hbWUsIGlkZW50aWZpZXIpe1wiLFwiICAgICAgdGhpcy5nZXRDaGFubmVsKGNoYW5uZWxOYW1lKS5yZW1vdmVTdWJzY3JpYmVyKGlkZW50aWZpZXIpO1wiLFwiICAgIH0sXCIsXCJcIixcIiAgICAvLyBQdWJsaXNoZXMgYXJiaXRyYXJ5IGRhdGEgdG8gYSBnaXZlbiBjaGFubmVsIG5hbWVzcGFjZS4gQ2hhbm5lbHMgYXJlXCIsXCIgICAgLy8gY2FsbGVkIHJlY3Vyc2l2ZWx5IGRvd253YXJkczsgYSBwb3N0IHRvIGFwcGxpY2F0aW9uOmNoYXQgd2lsbCBwb3N0IHRvXCIsXCIgICAgLy8gYXBwbGljYXRpb246Y2hhdDpyZWNlaXZlIGFuZCBhcHBsaWNhdGlvbjpjaGF0OmRlcnA6dGVzdDpiZXRhOmJhbmFuYXMuXCIsXCIgICAgLy8gQ2FsbGVkIHVzaW5nIE1lZGlhdG9yLnB1Ymxpc2goXFxcImFwcGxpY2F0aW9uOmNoYXRcXFwiLCBbIGFyZ3MgXSk7XCIsXCJcIixcIiAgICBwdWJsaXNoOiBmdW5jdGlvbihjaGFubmVsTmFtZSl7XCIsXCIgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSksXCIsXCIgICAgICAgICAgY2hhbm5lbCA9IHRoaXMuZ2V0Q2hhbm5lbChjaGFubmVsTmFtZSk7XCIsXCJcIixcIiAgICAgIGFyZ3MucHVzaChjaGFubmVsKTtcIixcIlwiLFwiICAgICAgdGhpcy5nZXRDaGFubmVsKGNoYW5uZWxOYW1lKS5wdWJsaXNoKGFyZ3MpO1wiLFwiICAgIH1cIixcIiAgfTtcIixcIlwiLFwiICAvLyBBbGlhcyBzb21lIGNvbW1vbiBuYW1lcyBmb3IgZWFzeSBpbnRlcm9wXCIsXCIgIE1lZGlhdG9yLnByb3RvdHlwZS5vbiA9IE1lZGlhdG9yLnByb3RvdHlwZS5zdWJzY3JpYmU7XCIsXCIgIE1lZGlhdG9yLnByb3RvdHlwZS5iaW5kID0gTWVkaWF0b3IucHJvdG90eXBlLnN1YnNjcmliZTtcIixcIiAgTWVkaWF0b3IucHJvdG90eXBlLmVtaXQgPSBNZWRpYXRvci5wcm90b3R5cGUucHVibGlzaDtcIixcIiAgTWVkaWF0b3IucHJvdG90eXBlLnRyaWdnZXIgPSBNZWRpYXRvci5wcm90b3R5cGUucHVibGlzaDtcIixcIiAgTWVkaWF0b3IucHJvdG90eXBlLm9mZiA9IE1lZGlhdG9yLnByb3RvdHlwZS5yZW1vdmU7XCIsXCJcIixcIiAgLy8gRmluYWxseSwgZXhwb3NlIGl0IGFsbC5cIixcIlwiLFwiICBNZWRpYXRvci5DaGFubmVsID0gQ2hhbm5lbDtcIixcIiAgTWVkaWF0b3IuU3Vic2NyaWJlciA9IFN1YnNjcmliZXI7XCIsXCIgIHJldHVybiBNZWRpYXRvcjtcIixcIn0pKTtcIl07XG5fJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTZdKys7XG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE3XSsrO1xuICBcInVzZSBzdHJpY3RcIjtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE5XSsrO1xuICBpZiAoKCh0eXBlb2Ygcm9vdC5leHBvcnRzKSA9PT0gXCJmdW5jdGlvblwiKSkge1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMV0rKztcbiAgICByb290LmV4cG9ydHMuTWVkaWF0b3IgPSBmYWN0b3J5KCk7XG4gIH1cbiAgZWxzZSB7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIyXSsrO1xuICAgIGlmICgoKCh0eXBlb2Ygcm9vdC5kZWZpbmUpID09PSBcImZ1bmN0aW9uXCIpICYmIHJvb3QuZGVmaW5lLmFtZCkpIHtcbiAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNF0rKztcbiAgICAgIHJvb3QuZGVmaW5lKFtdLCAoZnVuY3Rpb24gKCkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjZdKys7XG4gIHJvb3QuTWVkaWF0b3IgPSBmYWN0b3J5KCk7XG59KSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzMwXSsrO1xuICAgICAgcm9vdC5NZWRpYXRvciA9IGZhY3RvcnkoKTtcbiAgICB9XG4gIH1cbn0pKHRoaXMsIChmdW5jdGlvbiAoKSB7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszM10rKztcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszOV0rKztcbiAgZnVuY3Rpb24gZ3VpZEdlbmVyYXRvcigpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNDBdKys7XG4gICAgdmFyIFM0ID0gKGZ1bmN0aW9uICgpIHtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzQxXSsrO1xuICByZXR1cm4gKCgoMSArIE1hdGgucmFuZG9tKCkpICogNjU1MzYpIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcbn0pO1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs0NF0rKztcbiAgICByZXR1cm4gKFM0KCkgKyBTNCgpICsgXCItXCIgKyBTNCgpICsgXCItXCIgKyBTNCgpICsgXCItXCIgKyBTNCgpICsgXCItXCIgKyBTNCgpICsgUzQoKSArIFM0KCkpO1xufVxuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNTJdKys7XG4gIGZ1bmN0aW9uIFN1YnNjcmliZXIoZm4sIG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNTNdKys7XG4gICAgaWYgKCghICh0aGlzIGluc3RhbmNlb2YgU3Vic2NyaWJlcikpKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNTRdKys7XG4gICAgICByZXR1cm4gbmV3IFN1YnNjcmliZXIoZm4sIG9wdGlvbnMsIGNvbnRleHQpO1xuICAgIH1cbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNTddKys7XG4gICAgdGhpcy5pZCA9IGd1aWRHZW5lcmF0b3IoKTtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNThdKys7XG4gICAgdGhpcy5mbiA9IGZuO1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs1OV0rKztcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs2MF0rKztcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs2MV0rKztcbiAgICB0aGlzLmNoYW5uZWwgPSBudWxsO1xufVxuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNjRdKys7XG4gIFN1YnNjcmliZXIucHJvdG90eXBlID0ge3VwZGF0ZTogKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs3MF0rKztcbiAgaWYgKG9wdGlvbnMpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNzFdKys7XG4gICAgdGhpcy5mbiA9IChvcHRpb25zLmZuIHx8IHRoaXMuZm4pO1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs3Ml0rKztcbiAgICB0aGlzLmNvbnRleHQgPSAob3B0aW9ucy5jb250ZXh0IHx8IHRoaXMuY29udGV4dCk7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzczXSsrO1xuICAgIHRoaXMub3B0aW9ucyA9IChvcHRpb25zLm9wdGlvbnMgfHwgdGhpcy5vcHRpb25zKTtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNzRdKys7XG4gICAgaWYgKCh0aGlzLmNoYW5uZWwgJiYgdGhpcy5vcHRpb25zICYmICh0aGlzLm9wdGlvbnMucHJpb3JpdHkgIT09IHVuZGVmaW5lZCkpKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bNzVdKys7XG4gICAgICB0aGlzLmNoYW5uZWwuc2V0UHJpb3JpdHkodGhpcy5pZCwgdGhpcy5vcHRpb25zLnByaW9yaXR5KTtcbiAgICB9XG4gIH1cbn0pfTtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzgyXSsrO1xuICBmdW5jdGlvbiBDaGFubmVsKG5hbWVzcGFjZSwgcGFyZW50KSB7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzgzXSsrO1xuICAgIGlmICgoISAodGhpcyBpbnN0YW5jZW9mIENoYW5uZWwpKSkge1xuICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzg0XSsrO1xuICAgICAgcmV0dXJuIG5ldyBDaGFubmVsKG5hbWVzcGFjZSk7XG4gICAgfVxuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVs4N10rKztcbiAgICB0aGlzLm5hbWVzcGFjZSA9IChuYW1lc3BhY2UgfHwgXCJcIik7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzg4XSsrO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzg5XSsrO1xuICAgIHRoaXMuX2NoYW5uZWxzID0gW107XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzkwXSsrO1xuICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bOTFdKys7XG4gICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG59XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMDBdKys7XG4gIENoYW5uZWwucHJvdG90eXBlID0ge2FkZFN1YnNjcmliZXI6IChmdW5jdGlvbiAoZm4sIG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzEwMl0rKztcbiAgdmFyIHN1YnNjcmliZXIgPSBuZXcgU3Vic2NyaWJlcihmbiwgb3B0aW9ucywgY29udGV4dCk7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMDRdKys7XG4gIGlmICgob3B0aW9ucyAmJiAob3B0aW9ucy5wcmlvcml0eSAhPT0gdW5kZWZpbmVkKSkpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTA4XSsrO1xuICAgIG9wdGlvbnMucHJpb3JpdHkgPSAob3B0aW9ucy5wcmlvcml0eSA+PiAwKTtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTEwXSsrO1xuICAgIGlmICgob3B0aW9ucy5wcmlvcml0eSA8IDApKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTEwXSsrO1xuICAgICAgb3B0aW9ucy5wcmlvcml0eSA9IDA7XG4gICAgfVxuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMTFdKys7XG4gICAgaWYgKChvcHRpb25zLnByaW9yaXR5ID49IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aCkpIHtcbiAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMTFdKys7XG4gICAgICBvcHRpb25zLnByaW9yaXR5ID0gKHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aCAtIDEpO1xuICAgIH1cbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTEzXSsrO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzLnNwbGljZShvcHRpb25zLnByaW9yaXR5LCAwLCBzdWJzY3JpYmVyKTtcbiAgfVxuICBlbHNlIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTE1XSsrO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XG4gIH1cbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzExOF0rKztcbiAgc3Vic2NyaWJlci5jaGFubmVsID0gdGhpcztcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzEyMF0rKztcbiAgcmV0dXJuIHN1YnNjcmliZXI7XG59KSwgc3RvcFByb3BhZ2F0aW9uOiAoZnVuY3Rpb24gKCkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTI3XSsrO1xuICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xufSksIGdldFN1YnNjcmliZXI6IChmdW5jdGlvbiAoaWRlbnRpZmllcikge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTMxXSsrO1xuICB2YXIgeCA9IDAsIHkgPSB0aGlzLl9zdWJzY3JpYmVycy5sZW5ndGg7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMzRdKys7XG4gIGZvciAoKHgsIHkpOyAoeCA8IHkpOyAoeCsrKSkge1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxMzVdKys7XG4gICAgaWYgKCgodGhpcy5fc3Vic2NyaWJlcnNbeF0uaWQgPT09IGlkZW50aWZpZXIpIHx8ICh0aGlzLl9zdWJzY3JpYmVyc1t4XS5mbiA9PT0gaWRlbnRpZmllcikpKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTM2XSsrO1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZXJzW3hdO1xuICAgIH1cbn1cbn0pLCBzZXRQcmlvcml0eTogKGZ1bmN0aW9uIChpZGVudGlmaWVyLCBwcmlvcml0eSkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTQ2XSsrO1xuICB2YXIgb2xkSW5kZXggPSAwLCB4ID0gMCwgc3ViLCBmaXJzdEhhbGYsIGxhc3RIYWxmLCB5O1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTUwXSsrO1xuICBmb3IgKCgoeCA9IDApLCAoeSA9IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aCkpOyAoeCA8IHkpOyAoeCsrKSkge1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNTFdKys7XG4gICAgaWYgKCgodGhpcy5fc3Vic2NyaWJlcnNbeF0uaWQgPT09IGlkZW50aWZpZXIpIHx8ICh0aGlzLl9zdWJzY3JpYmVyc1t4XS5mbiA9PT0gaWRlbnRpZmllcikpKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTUyXSsrO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNTRdKys7XG4gICAgKG9sZEluZGV4KyspO1xufVxuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTU3XSsrO1xuICBzdWIgPSB0aGlzLl9zdWJzY3JpYmVyc1tvbGRJbmRleF07XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNThdKys7XG4gIGZpcnN0SGFsZiA9IHRoaXMuX3N1YnNjcmliZXJzLnNsaWNlKDAsIG9sZEluZGV4KTtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE1OV0rKztcbiAgbGFzdEhhbGYgPSB0aGlzLl9zdWJzY3JpYmVycy5zbGljZSgob2xkSW5kZXggKyAxKSk7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNjFdKys7XG4gIHRoaXMuX3N1YnNjcmliZXJzID0gZmlyc3RIYWxmLmNvbmNhdChsYXN0SGFsZik7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNjJdKys7XG4gIHRoaXMuX3N1YnNjcmliZXJzLnNwbGljZShwcmlvcml0eSwgMCwgc3ViKTtcbn0pLCBhZGRDaGFubmVsOiAoZnVuY3Rpb24gKGNoYW5uZWwpIHtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE2Nl0rKztcbiAgdGhpcy5fY2hhbm5lbHNbY2hhbm5lbF0gPSBuZXcgQ2hhbm5lbCgoKHRoaXMubmFtZXNwYWNlPyAodGhpcy5uYW1lc3BhY2UgKyBcIjpcIik6IFwiXCIpICsgY2hhbm5lbCksIHRoaXMpO1xufSksIGhhc0NoYW5uZWw6IChmdW5jdGlvbiAoY2hhbm5lbCkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTcwXSsrO1xuICByZXR1cm4gdGhpcy5fY2hhbm5lbHMuaGFzT3duUHJvcGVydHkoY2hhbm5lbCk7XG59KSwgcmV0dXJuQ2hhbm5lbDogKGZ1bmN0aW9uIChjaGFubmVsKSB7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxNzRdKys7XG4gIHJldHVybiB0aGlzLl9jaGFubmVsc1tjaGFubmVsXTtcbn0pLCByZW1vdmVTdWJzY3JpYmVyOiAoZnVuY3Rpb24gKGlkZW50aWZpZXIpIHtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE3OF0rKztcbiAgdmFyIHggPSAwLCB5O1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTgwXSsrO1xuICB5ID0gdGhpcy5fc3Vic2NyaWJlcnMubGVuZ3RoO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTgzXSsrO1xuICBpZiAoKCEgaWRlbnRpZmllcikpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMTg0XSsrO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE4NV0rKztcbiAgICByZXR1cm47XG4gIH1cbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE4OV0rKztcbiAgZm9yICgoeCwgeSk7ICh5ID4geCk7ICh5LS0pKSB7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzE5MF0rKztcbiAgICBpZiAoKCh0aGlzLl9zdWJzY3JpYmVyc1t4XS5mbiA9PT0gaWRlbnRpZmllcikgfHwgKHRoaXMuX3N1YnNjcmliZXJzW3hdLmlkID09PSBpZGVudGlmaWVyKSkpIHtcbiAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxOTFdKys7XG4gICAgICB0aGlzLl9zdWJzY3JpYmVyc1t4XS5jaGFubmVsID0gbnVsbDtcbiAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsxOTJdKys7XG4gICAgICB0aGlzLl9zdWJzY3JpYmVycy5zcGxpY2UoeCwgMSk7XG4gICAgfVxufVxufSksIHB1Ymxpc2g6IChmdW5jdGlvbiAoZGF0YSkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjAxXSsrO1xuICB2YXIgeCA9IDAsIHkgPSB0aGlzLl9zdWJzY3JpYmVycy5sZW5ndGgsIGNhbGxlZCA9IGZhbHNlLCBzdWJzY3JpYmVyLCBsO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjA3XSsrO1xuICBmb3IgKCh4LCB5KTsgKHggPCB5KTsgKHgrKykpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjA4XSsrO1xuICAgIGlmICgoISB0aGlzLnN0b3BwZWQpKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjA5XSsrO1xuICAgICAgc3Vic2NyaWJlciA9IHRoaXMuX3N1YnNjcmliZXJzW3hdO1xuICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIxMF0rKztcbiAgICAgIGlmICgoKHN1YnNjcmliZXIub3B0aW9ucyAhPT0gdW5kZWZpbmVkKSAmJiAoKHR5cGVvZiBzdWJzY3JpYmVyLm9wdGlvbnMucHJlZGljYXRlKSA9PT0gXCJmdW5jdGlvblwiKSkpIHtcbiAgICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIxMV0rKztcbiAgICAgICAgaWYgKHN1YnNjcmliZXIub3B0aW9ucy5wcmVkaWNhdGUuYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKSkge1xuICAgICAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMTJdKys7XG4gICAgICAgICAgc3Vic2NyaWJlci5mbi5hcHBseShzdWJzY3JpYmVyLmNvbnRleHQsIGRhdGEpO1xuICAgICAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMTNdKys7XG4gICAgICAgICAgY2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMTZdKys7XG4gICAgICAgIHN1YnNjcmliZXIuZm4uYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKTtcbiAgICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIxN10rKztcbiAgICAgICAgY2FsbGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIyMV0rKztcbiAgICBpZiAoKGNhbGxlZCAmJiBzdWJzY3JpYmVyLm9wdGlvbnMgJiYgKHN1YnNjcmliZXIub3B0aW9ucyAhPT0gdW5kZWZpbmVkKSkpIHtcbiAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMjJdKys7XG4gICAgICAoc3Vic2NyaWJlci5vcHRpb25zLmNhbGxzLS0pO1xuICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIyNF0rKztcbiAgICAgIGlmICgoc3Vic2NyaWJlci5vcHRpb25zLmNhbGxzIDwgMSkpIHtcbiAgICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIyNV0rKztcbiAgICAgICAgdGhpcy5yZW1vdmVTdWJzY3JpYmVyKHN1YnNjcmliZXIuaWQpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyMjddKys7XG4gICAgICAgIHN1YnNjcmliZXIudXBkYXRlKHN1YnNjcmliZXIub3B0aW9ucyk7XG4gICAgICB9XG4gICAgfVxufVxuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjMyXSsrO1xuICBpZiAodGhpcy5fcGFyZW50KSB7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzIzM10rKztcbiAgICB0aGlzLl9wYXJlbnQucHVibGlzaChkYXRhKTtcbiAgfVxuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjM2XSsrO1xuICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbn0pfTtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI0MF0rKztcbiAgZnVuY3Rpb24gTWVkaWF0b3IoKSB7XG4gICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI0MV0rKztcbiAgICBpZiAoKCEgKHRoaXMgaW5zdGFuY2VvZiBNZWRpYXRvcikpKSB7XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjQyXSsrO1xuICAgICAgcmV0dXJuIG5ldyBNZWRpYXRvcigpO1xuICAgIH1cbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjQ1XSsrO1xuICAgIHRoaXMuX2NoYW5uZWxzID0gbmV3IENoYW5uZWwoXCJcIik7XG59XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNTFdKys7XG4gIE1lZGlhdG9yLnByb3RvdHlwZSA9IHtnZXRDaGFubmVsOiAoZnVuY3Rpb24gKG5hbWVzcGFjZSkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjU3XSsrO1xuICB2YXIgY2hhbm5lbCA9IHRoaXMuX2NoYW5uZWxzLCBuYW1lc3BhY2VIaWVyYXJjaHkgPSBuYW1lc3BhY2Uuc3BsaXQoXCI6XCIpLCB4ID0gMCwgeSA9IG5hbWVzcGFjZUhpZXJhcmNoeS5sZW5ndGg7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNjJdKys7XG4gIGlmICgobmFtZXNwYWNlID09PSBcIlwiKSkge1xuICAgIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNjNdKys7XG4gICAgcmV0dXJuIGNoYW5uZWw7XG4gIH1cbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI2Nl0rKztcbiAgaWYgKChuYW1lc3BhY2VIaWVyYXJjaHkubGVuZ3RoID4gMCkpIHtcbiAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjY3XSsrO1xuICAgIGZvciAoKHgsIHkpOyAoeCA8IHkpOyAoeCsrKSkge1xuICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI2OV0rKztcbiAgICAgIGlmICgoISBjaGFubmVsLmhhc0NoYW5uZWwobmFtZXNwYWNlSGllcmFyY2h5W3hdKSkpIHtcbiAgICAgICAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI3MF0rKztcbiAgICAgICAgY2hhbm5lbC5hZGRDaGFubmVsKG5hbWVzcGFjZUhpZXJhcmNoeVt4XSk7XG4gICAgICB9XG4gICAgICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjczXSsrO1xuICAgICAgY2hhbm5lbCA9IGNoYW5uZWwucmV0dXJuQ2hhbm5lbChuYW1lc3BhY2VIaWVyYXJjaHlbeF0pO1xufVxuICB9XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVsyNzddKys7XG4gIHJldHVybiBjaGFubmVsO1xufSksIHN1YnNjcmliZTogKGZ1bmN0aW9uIChjaGFubmVsTmFtZSwgZm4sIG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzI4N10rKztcbiAgdmFyIGNoYW5uZWwgPSB0aGlzLmdldENoYW5uZWwoY2hhbm5lbE5hbWUpO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjg5XSsrO1xuICBvcHRpb25zID0gKG9wdGlvbnMgfHwge30pO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjkwXSsrO1xuICBjb250ZXh0ID0gKGNvbnRleHQgfHwge30pO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMjkyXSsrO1xuICByZXR1cm4gY2hhbm5lbC5hZGRTdWJzY3JpYmVyKGZuLCBvcHRpb25zLCBjb250ZXh0KTtcbn0pLCBvbmNlOiAoZnVuY3Rpb24gKGNoYW5uZWxOYW1lLCBmbiwgb3B0aW9ucywgY29udGV4dCkge1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzAyXSsrO1xuICBvcHRpb25zID0gKG9wdGlvbnMgfHwge30pO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzAzXSsrO1xuICBvcHRpb25zLmNhbGxzID0gMTtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzMwNV0rKztcbiAgcmV0dXJuIHRoaXMuc3Vic2NyaWJlKGNoYW5uZWxOYW1lLCBmbiwgb3B0aW9ucywgY29udGV4dCk7XG59KSwgZ2V0U3Vic2NyaWJlcjogKGZ1bmN0aW9uIChpZGVudGlmaWVyLCBjaGFubmVsKSB7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMTJdKys7XG4gIHJldHVybiB0aGlzLmdldENoYW5uZWwoKGNoYW5uZWwgfHwgXCJcIikpLmdldFN1YnNjcmliZXIoaWRlbnRpZmllcik7XG59KSwgcmVtb3ZlOiAoZnVuY3Rpb24gKGNoYW5uZWxOYW1lLCBpZGVudGlmaWVyKSB7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMTldKys7XG4gIHRoaXMuZ2V0Q2hhbm5lbChjaGFubmVsTmFtZSkucmVtb3ZlU3Vic2NyaWJlcihpZGVudGlmaWVyKTtcbn0pLCBwdWJsaXNoOiAoZnVuY3Rpb24gKGNoYW5uZWxOYW1lKSB7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMjhdKys7XG4gIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgY2hhbm5lbCA9IHRoaXMuZ2V0Q2hhbm5lbChjaGFubmVsTmFtZSk7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszMzFdKys7XG4gIGFyZ3MucHVzaChjaGFubmVsKTtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzMzM10rKztcbiAgdGhpcy5nZXRDaGFubmVsKGNoYW5uZWxOYW1lKS5wdWJsaXNoKGFyZ3MpO1xufSl9O1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzM4XSsrO1xuICBNZWRpYXRvci5wcm90b3R5cGUub24gPSBNZWRpYXRvci5wcm90b3R5cGUuc3Vic2NyaWJlO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzM5XSsrO1xuICBNZWRpYXRvci5wcm90b3R5cGUuYmluZCA9IE1lZGlhdG9yLnByb3RvdHlwZS5zdWJzY3JpYmU7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszNDBdKys7XG4gIE1lZGlhdG9yLnByb3RvdHlwZS5lbWl0ID0gTWVkaWF0b3IucHJvdG90eXBlLnB1Ymxpc2g7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszNDFdKys7XG4gIE1lZGlhdG9yLnByb3RvdHlwZS50cmlnZ2VyID0gTWVkaWF0b3IucHJvdG90eXBlLnB1Ymxpc2g7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszNDJdKys7XG4gIE1lZGlhdG9yLnByb3RvdHlwZS5vZmYgPSBNZWRpYXRvci5wcm90b3R5cGUucmVtb3ZlO1xuICBfJGpzY292ZXJhZ2VbJ21lZGlhdG9yLmpzJ11bMzQ2XSsrO1xuICBNZWRpYXRvci5DaGFubmVsID0gQ2hhbm5lbDtcbiAgXyRqc2NvdmVyYWdlWydtZWRpYXRvci5qcyddWzM0N10rKztcbiAgTWVkaWF0b3IuU3Vic2NyaWJlciA9IFN1YnNjcmliZXI7XG4gIF8kanNjb3ZlcmFnZVsnbWVkaWF0b3IuanMnXVszNDhdKys7XG4gIHJldHVybiBNZWRpYXRvcjtcbn0pKTtcbiIsIi8qanNsaW50IGJpdHdpc2U6IHRydWUsIG5vbWVuOiB0cnVlLCBwbHVzcGx1czogdHJ1ZSwgd2hpdGU6IHRydWUgKi9cblxuLyohXG4qIE1lZGlhdG9yLmpzIExpYnJhcnkgdjAuOS44XG4qIGh0dHBzOi8vZ2l0aHViLmNvbS9hamFja3NpZmllZC9NZWRpYXRvci5qc1xuKlxuKiBDb3B5cmlnaHQgMjAxMywgSmFjayBMYXdzb25cbiogTUlUIExpY2Vuc2VkIChodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocClcbipcbiogRm9yIG1vcmUgaW5mb3JtYXRpb246IGh0dHA6Ly90aGVqYWNrbGF3c29uLmNvbS8yMDExLzA2L21lZGlhdG9ycy1mb3ItbW9kdWxhcml6ZWQtYXN5bmNocm9ub3VzLXByb2dyYW1taW5nLWluLWphdmFzY3JpcHQvaW5kZXguaHRtbFxuKiBQcm9qZWN0IG9uIEdpdEh1YjogaHR0cHM6Ly9naXRodWIuY29tL2FqYWNrc2lmaWVkL01lZGlhdG9yLmpzXG4qXG4qIExhc3QgdXBkYXRlOiBPY3RvYmVyIDE5IDIwMTNcbiovXG5cbihmdW5jdGlvbihnbG9iYWwsIGZhY3RvcnkpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAvLyBBTURcbiAgICBkZWZpbmUoJ21lZGlhdG9yLWpzJywgW10sIGZ1bmN0aW9uKCkge1xuICAgICAgZ2xvYmFsLk1lZGlhdG9yID0gZmFjdG9yeSgpO1xuICAgICAgcmV0dXJuIGdsb2JhbC5NZWRpYXRvcjtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBOb2RlL0NvbW1vbkpTXG4gICAgZXhwb3J0cy5NZWRpYXRvciA9IGZhY3RvcnkoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbFxuICAgIGdsb2JhbC5NZWRpYXRvciA9IGZhY3RvcnkoKTtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIFdlJ2xsIGdlbmVyYXRlIGd1aWRzIGZvciBjbGFzcyBpbnN0YW5jZXMgZm9yIGVhc3kgcmVmZXJlbmNpbmcgbGF0ZXIgb24uXG4gIC8vIFN1YnNjcmliZXIgaW5zdGFuY2VzIHdpbGwgaGF2ZSBhbiBpZCB0aGF0IGNhbiBiZSByZWZlcm5jZWQgZm9yIHF1aWNrXG4gIC8vIGxvb2t1cHMuXG5cbiAgZnVuY3Rpb24gZ3VpZEdlbmVyYXRvcigpIHtcbiAgICB2YXIgUzQgPSBmdW5jdGlvbigpIHtcbiAgICAgICByZXR1cm4gKCgoMStNYXRoLnJhbmRvbSgpKSoweDEwMDAwKXwwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xuICAgIH07XG5cbiAgICByZXR1cm4gKFM0KCkrUzQoKStcIi1cIitTNCgpK1wiLVwiK1M0KCkrXCItXCIrUzQoKStcIi1cIitTNCgpK1M0KCkrUzQoKSk7XG4gIH1cblxuICAvLyBTdWJzY3JpYmVycyBhcmUgaW5zdGFuY2VzIG9mIE1lZGlhdG9yIENoYW5uZWwgcmVnaXN0cmF0aW9ucy4gV2UgZ2VuZXJhdGVcbiAgLy8gYW4gb2JqZWN0IGluc3RhbmNlIHNvIHRoYXQgaXQgY2FuIGJlIHVwZGF0ZWQgbGF0ZXIgb24gd2l0aG91dCBoYXZpbmcgdG9cbiAgLy8gdW5yZWdpc3RlciBhbmQgcmUtcmVnaXN0ZXIuIFN1YnNjcmliZXJzIGFyZSBjb25zdHJ1Y3RlZCB3aXRoIGEgZnVuY3Rpb25cbiAgLy8gdG8gYmUgY2FsbGVkLCBvcHRpb25zIG9iamVjdCwgYW5kIGNvbnRleHQuXG5cbiAgZnVuY3Rpb24gU3Vic2NyaWJlcihmbiwgb3B0aW9ucywgY29udGV4dCkge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBTdWJzY3JpYmVyKSkge1xuICAgICAgcmV0dXJuIG5ldyBTdWJzY3JpYmVyKGZuLCBvcHRpb25zLCBjb250ZXh0KTtcbiAgICB9XG5cbiAgICB0aGlzLmlkID0gZ3VpZEdlbmVyYXRvcigpO1xuICAgIHRoaXMuZm4gPSBmbjtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgdGhpcy5jaGFubmVsID0gbnVsbDtcbiAgfVxuXG4gIC8vIE1lZGlhdG9yLnVwZGF0ZSBvbiBhIHN1YnNjcmliZXIgaW5zdGFuY2UgY2FuIHVwZGF0ZSBpdHMgZnVuY3Rpb24sY29udGV4dCxcbiAgLy8gb3Igb3B0aW9ucyBvYmplY3QuIEl0IHRha2VzIGluIGFuIG9iamVjdCBhbmQgbG9va3MgZm9yIGZuLCBjb250ZXh0LCBvclxuICAvLyBvcHRpb25zIGtleXMuXG4gIFN1YnNjcmliZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucykge1xuICAgICAgdGhpcy5mbiA9IG9wdGlvbnMuZm4gfHwgdGhpcy5mbjtcbiAgICAgIHRoaXMuY29udGV4dCA9IG9wdGlvbnMuY29udGV4dCB8fCB0aGlzLmNvbnRleHQ7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zLm9wdGlvbnMgfHwgdGhpcy5vcHRpb25zO1xuICAgICAgaWYgKHRoaXMuY2hhbm5lbCAmJiB0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnByaW9yaXR5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aGlzLmNoYW5uZWwuc2V0UHJpb3JpdHkodGhpcy5pZCwgdGhpcy5vcHRpb25zLnByaW9yaXR5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIGZ1bmN0aW9uIENoYW5uZWwobmFtZXNwYWNlLCBwYXJlbnQpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgQ2hhbm5lbCkpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hhbm5lbChuYW1lc3BhY2UpO1xuICAgIH1cblxuICAgIHRoaXMubmFtZXNwYWNlID0gbmFtZXNwYWNlIHx8IFwiXCI7XG4gICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBbXTtcbiAgICB0aGlzLl9jaGFubmVscyA9IHt9O1xuICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8vIEEgTWVkaWF0b3IgY2hhbm5lbCBob2xkcyBhIGxpc3Qgb2Ygc3ViLWNoYW5uZWxzIGFuZCBzdWJzY3JpYmVycyB0byBiZSBmaXJlZFxuICAvLyB3aGVuIE1lZGlhdG9yLnB1Ymxpc2ggaXMgY2FsbGVkIG9uIHRoZSBNZWRpYXRvciBpbnN0YW5jZS4gSXQgYWxzbyBjb250YWluc1xuICAvLyBzb21lIG1ldGhvZHMgdG8gbWFuaXB1bGF0ZSBpdHMgbGlzdHMgb2YgZGF0YTsgb25seSBzZXRQcmlvcml0eSBhbmRcbiAgLy8gU3RvcFByb3BhZ2F0aW9uIGFyZSBtZWFudCB0byBiZSB1c2VkLiBUaGUgb3RoZXIgbWV0aG9kcyBzaG91bGQgYmUgYWNjZXNzZWRcbiAgLy8gdGhyb3VnaCB0aGUgTWVkaWF0b3IgaW5zdGFuY2UuXG4gIENoYW5uZWwucHJvdG90eXBlLmFkZFN1YnNjcmliZXIgPSBmdW5jdGlvbihmbiwgb3B0aW9ucywgY29udGV4dCkge1xuICAgIHZhciBzdWJzY3JpYmVyID0gbmV3IFN1YnNjcmliZXIoZm4sIG9wdGlvbnMsIGNvbnRleHQpO1xuXG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5wcmlvcml0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBDaGVhcCBoYWNrIHRvIGVpdGhlciBwYXJzZSBhcyBhbiBpbnQgb3IgdHVybiBpdCBpbnRvIDAuIFJ1bnMgZmFzdGVyXG4gICAgICAvLyBpbiBtYW55IGJyb3dzZXJzIHRoYW4gcGFyc2VJbnQgd2l0aCB0aGUgYmVuZWZpdCB0aGF0IGl0IHdvbid0XG4gICAgICAvLyByZXR1cm4gYSBOYU4uXG4gICAgICBvcHRpb25zLnByaW9yaXR5ID0gb3B0aW9ucy5wcmlvcml0eSA+PiAwO1xuXG4gICAgICBpZiAob3B0aW9ucy5wcmlvcml0eSA8IDApIHsgb3B0aW9ucy5wcmlvcml0eSA9IDA7IH1cbiAgICAgIGlmIChvcHRpb25zLnByaW9yaXR5ID49IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aCkgeyBvcHRpb25zLnByaW9yaXR5ID0gdGhpcy5fc3Vic2NyaWJlcnMubGVuZ3RoLTE7IH1cblxuICAgICAgdGhpcy5fc3Vic2NyaWJlcnMuc3BsaWNlKG9wdGlvbnMucHJpb3JpdHksIDAsIHN1YnNjcmliZXIpO1xuICAgIH1lbHNle1xuICAgICAgdGhpcy5fc3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTtcbiAgICB9XG5cbiAgICBzdWJzY3JpYmVyLmNoYW5uZWwgPSB0aGlzO1xuXG4gICAgcmV0dXJuIHN1YnNjcmliZXI7XG4gIH1cblxuICAvLyBUaGUgY2hhbm5lbCBpbnN0YW5jZSBpcyBwYXNzZWQgYXMgYW4gYXJndW1lbnQgdG8gdGhlIG1lZGlhdG9yIHN1YnNjcmliZXIsXG4gIC8vIGFuZCBmdXJ0aGVyIHN1YnNjcmliZXIgcHJvcGFnYXRpb24gY2FuIGJlIGNhbGxlZCB3aXRoXG4gIC8vIGNoYW5uZWwuU3RvcFByb3BhZ2F0aW9uKCkuXG4gIENoYW5uZWwucHJvdG90eXBlLnN0b3BQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc3RvcHBlZCA9IHRydWU7XG4gIH1cblxuICBDaGFubmVsLnByb3RvdHlwZS5nZXRTdWJzY3JpYmVyID0gZnVuY3Rpb24oaWRlbnRpZmllcikge1xuICAgIHZhciB4ID0gMCxcbiAgICAgICAgeSA9IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aDtcblxuICAgIGZvcih4LCB5OyB4IDwgeTsgeCsrKSB7XG4gICAgICBpZiAodGhpcy5fc3Vic2NyaWJlcnNbeF0uaWQgPT09IGlkZW50aWZpZXIgfHwgdGhpcy5fc3Vic2NyaWJlcnNbeF0uZm4gPT09IGlkZW50aWZpZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZXJzW3hdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIENoYW5uZWwuc2V0UHJpb3JpdHkgaXMgdXNlZnVsIGluIHVwZGF0aW5nIHRoZSBvcmRlciBpbiB3aGljaCBTdWJzY3JpYmVyc1xuICAvLyBhcmUgY2FsbGVkLCBhbmQgdGFrZXMgYW4gaWRlbnRpZmllciAoc3Vic2NyaWJlciBpZCBvciBuYW1lZCBmdW5jdGlvbikgYW5kXG4gIC8vIGFuIGFycmF5IGluZGV4LiBJdCB3aWxsIG5vdCBzZWFyY2ggcmVjdXJzaXZlbHkgdGhyb3VnaCBzdWJjaGFubmVscy5cblxuICBDaGFubmVsLnByb3RvdHlwZS5zZXRQcmlvcml0eSA9IGZ1bmN0aW9uKGlkZW50aWZpZXIsIHByaW9yaXR5KSB7XG4gICAgdmFyIG9sZEluZGV4ID0gMCxcbiAgICAgICAgeCA9IDAsXG4gICAgICAgIHN1YiwgZmlyc3RIYWxmLCBsYXN0SGFsZiwgeTtcblxuICAgIGZvcih4ID0gMCwgeSA9IHRoaXMuX3N1YnNjcmliZXJzLmxlbmd0aDsgeCA8IHk7IHgrKykge1xuICAgICAgaWYgKHRoaXMuX3N1YnNjcmliZXJzW3hdLmlkID09PSBpZGVudGlmaWVyIHx8IHRoaXMuX3N1YnNjcmliZXJzW3hdLmZuID09PSBpZGVudGlmaWVyKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgb2xkSW5kZXggKys7XG4gICAgfVxuXG4gICAgc3ViID0gdGhpcy5fc3Vic2NyaWJlcnNbb2xkSW5kZXhdO1xuICAgIGZpcnN0SGFsZiA9IHRoaXMuX3N1YnNjcmliZXJzLnNsaWNlKDAsIG9sZEluZGV4KTtcbiAgICBsYXN0SGFsZiA9IHRoaXMuX3N1YnNjcmliZXJzLnNsaWNlKG9sZEluZGV4KzEpO1xuXG4gICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBmaXJzdEhhbGYuY29uY2F0KGxhc3RIYWxmKTtcbiAgICB0aGlzLl9zdWJzY3JpYmVycy5zcGxpY2UocHJpb3JpdHksIDAsIHN1Yik7XG4gIH1cblxuICBDaGFubmVsLnByb3RvdHlwZS5hZGRDaGFubmVsID0gZnVuY3Rpb24oY2hhbm5lbCkge1xuICAgIHRoaXMuX2NoYW5uZWxzW2NoYW5uZWxdID0gbmV3IENoYW5uZWwoKHRoaXMubmFtZXNwYWNlID8gdGhpcy5uYW1lc3BhY2UgKyAnOicgOiAnJykgKyBjaGFubmVsLCB0aGlzKTtcbiAgfVxuXG4gIENoYW5uZWwucHJvdG90eXBlLmhhc0NoYW5uZWwgPSBmdW5jdGlvbihjaGFubmVsKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NoYW5uZWxzLmhhc093blByb3BlcnR5KGNoYW5uZWwpO1xuICB9XG5cbiAgQ2hhbm5lbC5wcm90b3R5cGUucmV0dXJuQ2hhbm5lbCA9IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICByZXR1cm4gdGhpcy5fY2hhbm5lbHNbY2hhbm5lbF07XG4gIH1cblxuICBDaGFubmVsLnByb3RvdHlwZS5yZW1vdmVTdWJzY3JpYmVyID0gZnVuY3Rpb24oaWRlbnRpZmllcikge1xuICAgIHZhciB4ID0gdGhpcy5fc3Vic2NyaWJlcnMubGVuZ3RoIC0gMTtcblxuICAgIC8vIElmIHdlIGRvbid0IHBhc3MgaW4gYW4gaWQsIHdlJ3JlIGNsZWFyaW5nIGFsbFxuICAgIGlmICghaWRlbnRpZmllcikge1xuICAgICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBbXTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHb2luZyBiYWNrd2FyZHMgbWFrZXMgc3BsaWNpbmcgYSB3aG9sZSBsb3QgZWFzaWVyLlxuICAgIGZvcih4OyB4ID49IDA7IHgtLSkge1xuICAgICAgaWYgKHRoaXMuX3N1YnNjcmliZXJzW3hdLmZuID09PSBpZGVudGlmaWVyIHx8IHRoaXMuX3N1YnNjcmliZXJzW3hdLmlkID09PSBpZGVudGlmaWVyKSB7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZXJzW3hdLmNoYW5uZWwgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmVycy5zcGxpY2UoeCwxKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAgIC8vIFRoaXMgd2lsbCBwdWJsaXNoIGFyYml0cmFyeSBhcmd1bWVudHMgdG8gYSBzdWJzY3JpYmVyIGFuZCB0aGVuIHRvIHBhcmVudFxuICAgIC8vIGNoYW5uZWxzLlxuXG4gIENoYW5uZWwucHJvdG90eXBlLnB1Ymxpc2ggPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdmFyIHggPSAwLFxuICAgICAgICB5ID0gdGhpcy5fc3Vic2NyaWJlcnMubGVuZ3RoLFxuICAgICAgICBzaG91bGRDYWxsID0gZmFsc2UsXG4gICAgICAgIHN1YnNjcmliZXIsIGwsXG4gICAgICAgIHN1YnNCZWZvcmUsc3Vic0FmdGVyO1xuXG4gICAgLy8gUHJpb3JpdHkgaXMgcHJlc2VydmVkIGluIHRoZSBfc3Vic2NyaWJlcnMgaW5kZXguXG4gICAgZm9yKHgsIHk7IHggPCB5OyB4KyspIHtcbiAgICAgIC8vIEJ5IGRlZmF1bHQgc2V0IHRoZSBmbGFnIHRvIGZhbHNlXG4gICAgICBzaG91bGRDYWxsID0gZmFsc2U7XG4gICAgICBzdWJzY3JpYmVyID0gdGhpcy5fc3Vic2NyaWJlcnNbeF07XG5cbiAgICAgIGlmICghdGhpcy5zdG9wcGVkKSB7XG4gICAgICAgIHN1YnNCZWZvcmUgPSB0aGlzLl9zdWJzY3JpYmVycy5sZW5ndGg7XG4gICAgICAgIGlmIChzdWJzY3JpYmVyLm9wdGlvbnMgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygc3Vic2NyaWJlci5vcHRpb25zLnByZWRpY2F0ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgaWYgKHN1YnNjcmliZXIub3B0aW9ucy5wcmVkaWNhdGUuYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKSkge1xuICAgICAgICAgICAgLy8gVGhlIHByZWRpY2F0ZSBtYXRjaGVzLCB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gc2hvdWxkIGJlIGNhbGxlZFxuICAgICAgICAgICAgc2hvdWxkQ2FsbCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAvLyBUaGVyZSBpcyBubyBwcmVkaWNhdGUgdG8gbWF0Y2gsIHRoZSBjYWxsYmFjayBzaG91bGQgYWx3YXlzIGJlIGNhbGxlZFxuICAgICAgICAgIHNob3VsZENhbGwgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZSBjYWxsYmFjayBzaG91bGQgYmUgY2FsbGVkXG4gICAgICBpZiAoc2hvdWxkQ2FsbCkge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgc3Vic2NyaWJlciBoYXMgb3B0aW9ucyBhbmQgaWYgdGhpcyBpbmNsdWRlIHRoZSBjYWxscyBvcHRpb25zXG4gICAgICAgIGlmIChzdWJzY3JpYmVyLm9wdGlvbnMgJiYgc3Vic2NyaWJlci5vcHRpb25zLmNhbGxzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAvLyBEZWNyZWFzZSB0aGUgbnVtYmVyIG9mIGNhbGxzIGxlZnQgYnkgb25lXG4gICAgICAgICAgc3Vic2NyaWJlci5vcHRpb25zLmNhbGxzLS07XG4gICAgICAgICAgLy8gT25jZSB0aGUgbnVtYmVyIG9mIGNhbGxzIGxlZnQgcmVhY2hlcyB6ZXJvIG9yIGxlc3Mgd2UgbmVlZCB0byByZW1vdmUgdGhlIHN1YnNjcmliZXJcbiAgICAgICAgICBpZiAoc3Vic2NyaWJlci5vcHRpb25zLmNhbGxzIDwgMSkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVTdWJzY3JpYmVyKHN1YnNjcmliZXIuaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBOb3cgd2UgY2FsbCB0aGUgY2FsbGJhY2ssIGlmIHRoaXMgaW4gdHVybnMgcHVibGlzaGVzIHRvIHRoZSBzYW1lIGNoYW5uZWwgaXQgd2lsbCBubyBsb25nZXJcbiAgICAgICAgLy8gY2F1c2UgdGhlIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCBhcyB3ZSBqdXN0IHJlbW92ZWQgaXQgYXMgYSBzdWJzY3JpYmVyXG4gICAgICAgIHN1YnNjcmliZXIuZm4uYXBwbHkoc3Vic2NyaWJlci5jb250ZXh0LCBkYXRhKTtcblxuICAgICAgICBzdWJzQWZ0ZXIgPSB0aGlzLl9zdWJzY3JpYmVycy5sZW5ndGg7XG4gICAgICAgIHkgPSBzdWJzQWZ0ZXI7XG4gICAgICAgIGlmIChzdWJzQWZ0ZXIgPT09IHN1YnNCZWZvcmUgLSAxKSB7XG4gICAgICAgICAgeC0tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3BhcmVudCkge1xuICAgICAgdGhpcy5fcGFyZW50LnB1Ymxpc2goZGF0YSk7XG4gICAgfVxuXG4gICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBNZWRpYXRvcigpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgTWVkaWF0b3IpKSB7XG4gICAgICByZXR1cm4gbmV3IE1lZGlhdG9yKCk7XG4gICAgfVxuXG4gICAgdGhpcy5fY2hhbm5lbHMgPSBuZXcgQ2hhbm5lbCgnJyk7XG4gIH1cblxuICAvLyBBIE1lZGlhdG9yIGluc3RhbmNlIGlzIHRoZSBpbnRlcmZhY2UgdGhyb3VnaCB3aGljaCBldmVudHMgYXJlIHJlZ2lzdGVyZWRcbiAgLy8gYW5kIHJlbW92ZWQgZnJvbSBwdWJsaXNoIGNoYW5uZWxzLlxuXG4gIC8vIFJldHVybnMgYSBjaGFubmVsIGluc3RhbmNlIGJhc2VkIG9uIG5hbWVzcGFjZSwgZm9yIGV4YW1wbGVcbiAgLy8gYXBwbGljYXRpb246Y2hhdDptZXNzYWdlOnJlY2VpdmVkLiBJZiByZWFkT25seSBpcyB0cnVlIHdlXG4gIC8vIHdpbGwgcmVmcmFpbiBmcm9tIGNyZWF0aW5nIG5vbiBleGlzdGluZyBjaGFubmVscy5cbiAgTWVkaWF0b3IucHJvdG90eXBlLmdldENoYW5uZWwgPSBmdW5jdGlvbihuYW1lc3BhY2UsIHJlYWRPbmx5KSB7XG4gICAgdmFyIGNoYW5uZWwgPSB0aGlzLl9jaGFubmVscyxcbiAgICAgICAgbmFtZXNwYWNlSGllcmFyY2h5ID0gbmFtZXNwYWNlLnNwbGl0KCc6JyksXG4gICAgICAgIHggPSAwLFxuICAgICAgICB5ID0gbmFtZXNwYWNlSGllcmFyY2h5Lmxlbmd0aDtcblxuICAgIGlmIChuYW1lc3BhY2UgPT09ICcnKSB7XG4gICAgICByZXR1cm4gY2hhbm5lbDtcbiAgICB9XG5cbiAgICBpZiAobmFtZXNwYWNlSGllcmFyY2h5Lmxlbmd0aCA+IDApIHtcbiAgICAgIGZvcih4LCB5OyB4IDwgeTsgeCsrKSB7XG5cbiAgICAgICAgaWYgKCFjaGFubmVsLmhhc0NoYW5uZWwobmFtZXNwYWNlSGllcmFyY2h5W3hdKSkge1xuICAgICAgICAgIGlmIChyZWFkT25seSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYW5uZWwuYWRkQ2hhbm5lbChuYW1lc3BhY2VIaWVyYXJjaHlbeF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNoYW5uZWwgPSBjaGFubmVsLnJldHVybkNoYW5uZWwobmFtZXNwYWNlSGllcmFyY2h5W3hdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY2hhbm5lbDtcbiAgfVxuXG4gIC8vIFBhc3MgaW4gYSBjaGFubmVsIG5hbWVzcGFjZSwgZnVuY3Rpb24gdG8gYmUgY2FsbGVkLCBvcHRpb25zLCBhbmQgY29udGV4dFxuICAvLyB0byBjYWxsIHRoZSBmdW5jdGlvbiBpbiB0byBTdWJzY3JpYmUuIEl0IHdpbGwgY3JlYXRlIGEgY2hhbm5lbCBpZiBvbmVcbiAgLy8gZG9lcyBub3QgZXhpc3QuIE9wdGlvbnMgY2FuIGluY2x1ZGUgYSBwcmVkaWNhdGUgdG8gZGV0ZXJtaW5lIGlmIGl0XG4gIC8vIHNob3VsZCBiZSBjYWxsZWQgKGJhc2VkIG9uIHRoZSBkYXRhIHB1Ymxpc2hlZCB0byBpdCkgYW5kIGEgcHJpb3JpdHlcbiAgLy8gaW5kZXguXG5cbiAgTWVkaWF0b3IucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uKGNoYW5uZWxOYW1lLCBmbiwgb3B0aW9ucywgY29udGV4dCkge1xuICAgIHZhciBjaGFubmVsID0gdGhpcy5nZXRDaGFubmVsKGNoYW5uZWxOYW1lIHx8IFwiXCIsIGZhbHNlKTtcblxuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGNvbnRleHQgPSBjb250ZXh0IHx8IHt9O1xuXG4gICAgcmV0dXJuIGNoYW5uZWwuYWRkU3Vic2NyaWJlcihmbiwgb3B0aW9ucywgY29udGV4dCk7XG4gIH1cblxuICAvLyBQYXNzIGluIGEgY2hhbm5lbCBuYW1lc3BhY2UsIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCwgb3B0aW9ucywgYW5kIGNvbnRleHRcbiAgLy8gdG8gY2FsbCB0aGUgZnVuY3Rpb24gaW4gdG8gU3Vic2NyaWJlLiBJdCB3aWxsIGNyZWF0ZSBhIGNoYW5uZWwgaWYgb25lXG4gIC8vIGRvZXMgbm90IGV4aXN0LiBPcHRpb25zIGNhbiBpbmNsdWRlIGEgcHJlZGljYXRlIHRvIGRldGVybWluZSBpZiBpdFxuICAvLyBzaG91bGQgYmUgY2FsbGVkIChiYXNlZCBvbiB0aGUgZGF0YSBwdWJsaXNoZWQgdG8gaXQpIGFuZCBhIHByaW9yaXR5XG4gIC8vIGluZGV4LlxuXG4gIE1lZGlhdG9yLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24oY2hhbm5lbE5hbWUsIGZuLCBvcHRpb25zLCBjb250ZXh0KSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgb3B0aW9ucy5jYWxscyA9IDE7XG5cbiAgICByZXR1cm4gdGhpcy5zdWJzY3JpYmUoY2hhbm5lbE5hbWUsIGZuLCBvcHRpb25zLCBjb250ZXh0KTtcbiAgfVxuXG4gIC8vIFJldHVybnMgYSBzdWJzY3JpYmVyIGZvciBhIGdpdmVuIHN1YnNjcmliZXIgaWQgLyBuYW1lZCBmdW5jdGlvbiBhbmRcbiAgLy8gY2hhbm5lbCBuYW1lc3BhY2VcblxuICBNZWRpYXRvci5wcm90b3R5cGUuZ2V0U3Vic2NyaWJlciA9IGZ1bmN0aW9uKGlkZW50aWZpZXIsIGNoYW5uZWxOYW1lKSB7XG4gICAgdmFyIGNoYW5uZWwgPSB0aGlzLmdldENoYW5uZWwoY2hhbm5lbE5hbWUgfHwgXCJcIiwgdHJ1ZSk7XG4gICAgLy8gV2UgaGF2ZSB0byBjaGVjayBpZiBjaGFubmVsIHdpdGhpbiB0aGUgaGllcmFyY2h5IGV4aXN0cyBhbmQgaWYgaXQgaXNcbiAgICAvLyBhbiBleGFjdCBtYXRjaCBmb3IgdGhlIHJlcXVlc3RlZCBjaGFubmVsXG4gICAgaWYgKGNoYW5uZWwubmFtZXNwYWNlICE9PSBjaGFubmVsTmFtZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoYW5uZWwuZ2V0U3Vic2NyaWJlcihpZGVudGlmaWVyKTtcbiAgfVxuXG4gIC8vIFJlbW92ZSBhIHN1YnNjcmliZXIgZnJvbSBhIGdpdmVuIGNoYW5uZWwgbmFtZXNwYWNlIHJlY3Vyc2l2ZWx5IGJhc2VkIG9uXG4gIC8vIGEgcGFzc2VkLWluIHN1YnNjcmliZXIgaWQgb3IgbmFtZWQgZnVuY3Rpb24uXG5cbiAgTWVkaWF0b3IucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKGNoYW5uZWxOYW1lLCBpZGVudGlmaWVyKSB7XG4gICAgdmFyIGNoYW5uZWwgPSB0aGlzLmdldENoYW5uZWwoY2hhbm5lbE5hbWUgfHwgXCJcIiwgdHJ1ZSk7XG4gICAgaWYgKGNoYW5uZWwubmFtZXNwYWNlICE9PSBjaGFubmVsTmFtZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNoYW5uZWwucmVtb3ZlU3Vic2NyaWJlcihpZGVudGlmaWVyKTtcbiAgfVxuXG4gIC8vIFB1Ymxpc2hlcyBhcmJpdHJhcnkgZGF0YSB0byBhIGdpdmVuIGNoYW5uZWwgbmFtZXNwYWNlLiBDaGFubmVscyBhcmVcbiAgLy8gY2FsbGVkIHJlY3Vyc2l2ZWx5IGRvd253YXJkczsgYSBwb3N0IHRvIGFwcGxpY2F0aW9uOmNoYXQgd2lsbCBwb3N0IHRvXG4gIC8vIGFwcGxpY2F0aW9uOmNoYXQ6cmVjZWl2ZSBhbmQgYXBwbGljYXRpb246Y2hhdDpkZXJwOnRlc3Q6YmV0YTpiYW5hbmFzLlxuICAvLyBDYWxsZWQgdXNpbmcgTWVkaWF0b3IucHVibGlzaChcImFwcGxpY2F0aW9uOmNoYXRcIiwgWyBhcmdzIF0pO1xuXG4gIE1lZGlhdG9yLnByb3RvdHlwZS5wdWJsaXNoID0gZnVuY3Rpb24oY2hhbm5lbE5hbWUpIHtcbiAgICB2YXIgY2hhbm5lbCA9IHRoaXMuZ2V0Q2hhbm5lbChjaGFubmVsTmFtZSB8fCBcIlwiLCB0cnVlKTtcbiAgICBpZiAoY2hhbm5lbC5uYW1lc3BhY2UgIT09IGNoYW5uZWxOYW1lKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgICBhcmdzLnB1c2goY2hhbm5lbCk7XG5cbiAgICBjaGFubmVsLnB1Ymxpc2goYXJncyk7XG4gIH1cblxuICAvLyBBbGlhcyBzb21lIGNvbW1vbiBuYW1lcyBmb3IgZWFzeSBpbnRlcm9wXG4gIE1lZGlhdG9yLnByb3RvdHlwZS5vbiA9IE1lZGlhdG9yLnByb3RvdHlwZS5zdWJzY3JpYmU7XG4gIE1lZGlhdG9yLnByb3RvdHlwZS5iaW5kID0gTWVkaWF0b3IucHJvdG90eXBlLnN1YnNjcmliZTtcbiAgTWVkaWF0b3IucHJvdG90eXBlLmVtaXQgPSBNZWRpYXRvci5wcm90b3R5cGUucHVibGlzaDtcbiAgTWVkaWF0b3IucHJvdG90eXBlLnRyaWdnZXIgPSBNZWRpYXRvci5wcm90b3R5cGUucHVibGlzaDtcbiAgTWVkaWF0b3IucHJvdG90eXBlLm9mZiA9IE1lZGlhdG9yLnByb3RvdHlwZS5yZW1vdmU7XG5cbiAgLy8gRmluYWxseSwgZXhwb3NlIGl0IGFsbC5cblxuICBNZWRpYXRvci5DaGFubmVsID0gQ2hhbm5lbDtcbiAgTWVkaWF0b3IuU3Vic2NyaWJlciA9IFN1YnNjcmliZXI7XG4gIE1lZGlhdG9yLnZlcnNpb24gPSBcIjAuOS44XCI7XG5cbiAgcmV0dXJuIE1lZGlhdG9yO1xufSkpO1xuIiwiLyoqXG4gKiBUd2Vlbi5qcyAtIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogaHR0cHM6Ly9naXRodWIuY29tL3NvbGUvdHdlZW4uanNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3NvbGUvdHdlZW4uanMvZ3JhcGhzL2NvbnRyaWJ1dG9ycyBmb3IgdGhlIGZ1bGwgbGlzdCBvZiBjb250cmlidXRvcnMuXG4gKiBUaGFuayB5b3UgYWxsLCB5b3UncmUgYXdlc29tZSFcbiAqL1xuXG4vLyBEYXRlLm5vdyBzaGltIGZvciAoYWhlbSkgSW50ZXJuZXQgRXhwbG8oZHxyKWVyXG5pZiAoIERhdGUubm93ID09PSB1bmRlZmluZWQgKSB7XG5cblx0RGF0ZS5ub3cgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gbmV3IERhdGUoKS52YWx1ZU9mKCk7XG5cblx0fTtcblxufVxuXG52YXIgVFdFRU4gPSBUV0VFTiB8fCAoIGZ1bmN0aW9uICgpIHtcblxuXHR2YXIgX3R3ZWVucyA9IFtdO1xuXG5cdHJldHVybiB7XG5cblx0XHRSRVZJU0lPTjogJzE0JyxcblxuXHRcdGdldEFsbDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRyZXR1cm4gX3R3ZWVucztcblxuXHRcdH0sXG5cblx0XHRyZW1vdmVBbGw6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0X3R3ZWVucyA9IFtdO1xuXG5cdFx0fSxcblxuXHRcdGFkZDogZnVuY3Rpb24gKCB0d2VlbiApIHtcblxuXHRcdFx0X3R3ZWVucy5wdXNoKCB0d2VlbiApO1xuXG5cdFx0fSxcblxuXHRcdHJlbW92ZTogZnVuY3Rpb24gKCB0d2VlbiApIHtcblxuXHRcdFx0dmFyIGkgPSBfdHdlZW5zLmluZGV4T2YoIHR3ZWVuICk7XG5cblx0XHRcdGlmICggaSAhPT0gLTEgKSB7XG5cblx0XHRcdFx0X3R3ZWVucy5zcGxpY2UoIGksIDEgKTtcblxuXHRcdFx0fVxuXG5cdFx0fSxcblxuXHRcdHVwZGF0ZTogZnVuY3Rpb24gKCB0aW1lICkge1xuXG5cdFx0XHRpZiAoIF90d2VlbnMubGVuZ3RoID09PSAwICkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHR2YXIgaSA9IDA7XG5cblx0XHRcdHRpbWUgPSB0aW1lICE9PSB1bmRlZmluZWQgPyB0aW1lIDogKCB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGVyZm9ybWFuY2UgIT09IHVuZGVmaW5lZCAmJiB3aW5kb3cucGVyZm9ybWFuY2Uubm93ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpICk7XG5cblx0XHRcdHdoaWxlICggaSA8IF90d2VlbnMubGVuZ3RoICkge1xuXG5cdFx0XHRcdGlmICggX3R3ZWVuc1sgaSBdLnVwZGF0ZSggdGltZSApICkge1xuXG5cdFx0XHRcdFx0aSsrO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRfdHdlZW5zLnNwbGljZSggaSwgMSApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblxuXHRcdH1cblx0fTtcblxufSApKCk7XG5cblRXRUVOLlR3ZWVuID0gZnVuY3Rpb24gKCBvYmplY3QgKSB7XG5cblx0dmFyIF9vYmplY3QgPSBvYmplY3Q7XG5cdHZhciBfdmFsdWVzU3RhcnQgPSB7fTtcblx0dmFyIF92YWx1ZXNFbmQgPSB7fTtcblx0dmFyIF92YWx1ZXNTdGFydFJlcGVhdCA9IHt9O1xuXHR2YXIgX2R1cmF0aW9uID0gMTAwMDtcblx0dmFyIF9yZXBlYXQgPSAwO1xuXHR2YXIgX3lveW8gPSBmYWxzZTtcblx0dmFyIF9pc1BsYXlpbmcgPSBmYWxzZTtcblx0dmFyIF9yZXZlcnNlZCA9IGZhbHNlO1xuXHR2YXIgX2RlbGF5VGltZSA9IDA7XG5cdHZhciBfc3RhcnRUaW1lID0gbnVsbDtcblx0dmFyIF9lYXNpbmdGdW5jdGlvbiA9IFRXRUVOLkVhc2luZy5MaW5lYXIuTm9uZTtcblx0dmFyIF9pbnRlcnBvbGF0aW9uRnVuY3Rpb24gPSBUV0VFTi5JbnRlcnBvbGF0aW9uLkxpbmVhcjtcblx0dmFyIF9jaGFpbmVkVHdlZW5zID0gW107XG5cdHZhciBfb25TdGFydENhbGxiYWNrID0gbnVsbDtcblx0dmFyIF9vblN0YXJ0Q2FsbGJhY2tGaXJlZCA9IGZhbHNlO1xuXHR2YXIgX29uVXBkYXRlQ2FsbGJhY2sgPSBudWxsO1xuXHR2YXIgX29uQ29tcGxldGVDYWxsYmFjayA9IG51bGw7XG5cdHZhciBfb25TdG9wQ2FsbGJhY2sgPSBudWxsO1xuXG5cdC8vIFNldCBhbGwgc3RhcnRpbmcgdmFsdWVzIHByZXNlbnQgb24gdGhlIHRhcmdldCBvYmplY3Rcblx0Zm9yICggdmFyIGZpZWxkIGluIG9iamVjdCApIHtcblxuXHRcdF92YWx1ZXNTdGFydFsgZmllbGQgXSA9IHBhcnNlRmxvYXQob2JqZWN0W2ZpZWxkXSwgMTApO1xuXG5cdH1cblxuXHR0aGlzLnRvID0gZnVuY3Rpb24gKCBwcm9wZXJ0aWVzLCBkdXJhdGlvbiApIHtcblxuXHRcdGlmICggZHVyYXRpb24gIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0X2R1cmF0aW9uID0gZHVyYXRpb247XG5cblx0XHR9XG5cblx0XHRfdmFsdWVzRW5kID0gcHJvcGVydGllcztcblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH07XG5cblx0dGhpcy5zdGFydCA9IGZ1bmN0aW9uICggdGltZSApIHtcblxuXHRcdFRXRUVOLmFkZCggdGhpcyApO1xuXG5cdFx0X2lzUGxheWluZyA9IHRydWU7XG5cblx0XHRfb25TdGFydENhbGxiYWNrRmlyZWQgPSBmYWxzZTtcblxuXHRcdF9zdGFydFRpbWUgPSB0aW1lICE9PSB1bmRlZmluZWQgPyB0aW1lIDogKCB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGVyZm9ybWFuY2UgIT09IHVuZGVmaW5lZCAmJiB3aW5kb3cucGVyZm9ybWFuY2Uubm93ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpICk7XG5cdFx0X3N0YXJ0VGltZSArPSBfZGVsYXlUaW1lO1xuXG5cdFx0Zm9yICggdmFyIHByb3BlcnR5IGluIF92YWx1ZXNFbmQgKSB7XG5cblx0XHRcdC8vIGNoZWNrIGlmIGFuIEFycmF5IHdhcyBwcm92aWRlZCBhcyBwcm9wZXJ0eSB2YWx1ZVxuXHRcdFx0aWYgKCBfdmFsdWVzRW5kWyBwcm9wZXJ0eSBdIGluc3RhbmNlb2YgQXJyYXkgKSB7XG5cblx0XHRcdFx0aWYgKCBfdmFsdWVzRW5kWyBwcm9wZXJ0eSBdLmxlbmd0aCA9PT0gMCApIHtcblxuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBjcmVhdGUgYSBsb2NhbCBjb3B5IG9mIHRoZSBBcnJheSB3aXRoIHRoZSBzdGFydCB2YWx1ZSBhdCB0aGUgZnJvbnRcblx0XHRcdFx0X3ZhbHVlc0VuZFsgcHJvcGVydHkgXSA9IFsgX29iamVjdFsgcHJvcGVydHkgXSBdLmNvbmNhdCggX3ZhbHVlc0VuZFsgcHJvcGVydHkgXSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdF92YWx1ZXNTdGFydFsgcHJvcGVydHkgXSA9IF9vYmplY3RbIHByb3BlcnR5IF07XG5cblx0XHRcdGlmKCAoIF92YWx1ZXNTdGFydFsgcHJvcGVydHkgXSBpbnN0YW5jZW9mIEFycmF5ICkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRfdmFsdWVzU3RhcnRbIHByb3BlcnR5IF0gKj0gMS4wOyAvLyBFbnN1cmVzIHdlJ3JlIHVzaW5nIG51bWJlcnMsIG5vdCBzdHJpbmdzXG5cdFx0XHR9XG5cblx0XHRcdF92YWx1ZXNTdGFydFJlcGVhdFsgcHJvcGVydHkgXSA9IF92YWx1ZXNTdGFydFsgcHJvcGVydHkgXSB8fCAwO1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fTtcblxuXHR0aGlzLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRpZiAoICFfaXNQbGF5aW5nICkge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXG5cdFx0VFdFRU4ucmVtb3ZlKCB0aGlzICk7XG5cdFx0X2lzUGxheWluZyA9IGZhbHNlO1xuXG5cdFx0aWYgKCBfb25TdG9wQ2FsbGJhY2sgIT09IG51bGwgKSB7XG5cblx0XHRcdF9vblN0b3BDYWxsYmFjay5jYWxsKCBfb2JqZWN0ICk7XG5cblx0XHR9XG5cblx0XHR0aGlzLnN0b3BDaGFpbmVkVHdlZW5zKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fTtcblxuXHR0aGlzLnN0b3BDaGFpbmVkVHdlZW5zID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0Zm9yICggdmFyIGkgPSAwLCBudW1DaGFpbmVkVHdlZW5zID0gX2NoYWluZWRUd2VlbnMubGVuZ3RoOyBpIDwgbnVtQ2hhaW5lZFR3ZWVuczsgaSsrICkge1xuXG5cdFx0XHRfY2hhaW5lZFR3ZWVuc1sgaSBdLnN0b3AoKTtcblxuXHRcdH1cblxuXHR9O1xuXG5cdHRoaXMuZGVsYXkgPSBmdW5jdGlvbiAoIGFtb3VudCApIHtcblxuXHRcdF9kZWxheVRpbWUgPSBhbW91bnQ7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fTtcblxuXHR0aGlzLnJlcGVhdCA9IGZ1bmN0aW9uICggdGltZXMgKSB7XG5cblx0XHRfcmVwZWF0ID0gdGltZXM7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fTtcblxuXHR0aGlzLnlveW8gPSBmdW5jdGlvbiggeW95byApIHtcblxuXHRcdF95b3lvID0geW95bztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9O1xuXG5cblx0dGhpcy5lYXNpbmcgPSBmdW5jdGlvbiAoIGVhc2luZyApIHtcblxuXHRcdF9lYXNpbmdGdW5jdGlvbiA9IGVhc2luZztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9O1xuXG5cdHRoaXMuaW50ZXJwb2xhdGlvbiA9IGZ1bmN0aW9uICggaW50ZXJwb2xhdGlvbiApIHtcblxuXHRcdF9pbnRlcnBvbGF0aW9uRnVuY3Rpb24gPSBpbnRlcnBvbGF0aW9uO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH07XG5cblx0dGhpcy5jaGFpbiA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdF9jaGFpbmVkVHdlZW5zID0gYXJndW1lbnRzO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH07XG5cblx0dGhpcy5vblN0YXJ0ID0gZnVuY3Rpb24gKCBjYWxsYmFjayApIHtcblxuXHRcdF9vblN0YXJ0Q2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9O1xuXG5cdHRoaXMub25VcGRhdGUgPSBmdW5jdGlvbiAoIGNhbGxiYWNrICkge1xuXG5cdFx0X29uVXBkYXRlQ2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9O1xuXG5cdHRoaXMub25Db21wbGV0ZSA9IGZ1bmN0aW9uICggY2FsbGJhY2sgKSB7XG5cblx0XHRfb25Db21wbGV0ZUNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fTtcblxuXHR0aGlzLm9uU3RvcCA9IGZ1bmN0aW9uICggY2FsbGJhY2sgKSB7XG5cblx0XHRfb25TdG9wQ2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9O1xuXG5cdHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKCB0aW1lICkge1xuXG5cdFx0dmFyIHByb3BlcnR5O1xuXG5cdFx0aWYgKCB0aW1lIDwgX3N0YXJ0VGltZSApIHtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cblx0XHR9XG5cblx0XHRpZiAoIF9vblN0YXJ0Q2FsbGJhY2tGaXJlZCA9PT0gZmFsc2UgKSB7XG5cblx0XHRcdGlmICggX29uU3RhcnRDYWxsYmFjayAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHRfb25TdGFydENhbGxiYWNrLmNhbGwoIF9vYmplY3QgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRfb25TdGFydENhbGxiYWNrRmlyZWQgPSB0cnVlO1xuXG5cdFx0fVxuXG5cdFx0dmFyIGVsYXBzZWQgPSAoIHRpbWUgLSBfc3RhcnRUaW1lICkgLyBfZHVyYXRpb247XG5cdFx0ZWxhcHNlZCA9IGVsYXBzZWQgPiAxID8gMSA6IGVsYXBzZWQ7XG5cblx0XHR2YXIgdmFsdWUgPSBfZWFzaW5nRnVuY3Rpb24oIGVsYXBzZWQgKTtcblxuXHRcdGZvciAoIHByb3BlcnR5IGluIF92YWx1ZXNFbmQgKSB7XG5cblx0XHRcdHZhciBzdGFydCA9IF92YWx1ZXNTdGFydFsgcHJvcGVydHkgXSB8fCAwO1xuXHRcdFx0dmFyIGVuZCA9IF92YWx1ZXNFbmRbIHByb3BlcnR5IF07XG5cblx0XHRcdGlmICggZW5kIGluc3RhbmNlb2YgQXJyYXkgKSB7XG5cblx0XHRcdFx0X29iamVjdFsgcHJvcGVydHkgXSA9IF9pbnRlcnBvbGF0aW9uRnVuY3Rpb24oIGVuZCwgdmFsdWUgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHQvLyBQYXJzZXMgcmVsYXRpdmUgZW5kIHZhbHVlcyB3aXRoIHN0YXJ0IGFzIGJhc2UgKGUuZy46ICsxMCwgLTMpXG5cdFx0XHRcdGlmICggdHlwZW9mKGVuZCkgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdFx0ZW5kID0gc3RhcnQgKyBwYXJzZUZsb2F0KGVuZCwgMTApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gcHJvdGVjdCBhZ2FpbnN0IG5vbiBudW1lcmljIHByb3BlcnRpZXMuXG5cdFx0XHRcdGlmICggdHlwZW9mKGVuZCkgPT09IFwibnVtYmVyXCIgKSB7XG5cdFx0XHRcdFx0X29iamVjdFsgcHJvcGVydHkgXSA9IHN0YXJ0ICsgKCBlbmQgLSBzdGFydCApICogdmFsdWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0aWYgKCBfb25VcGRhdGVDYWxsYmFjayAhPT0gbnVsbCApIHtcblxuXHRcdFx0X29uVXBkYXRlQ2FsbGJhY2suY2FsbCggX29iamVjdCwgdmFsdWUgKTtcblxuXHRcdH1cblxuXHRcdGlmICggZWxhcHNlZCA9PSAxICkge1xuXG5cdFx0XHRpZiAoIF9yZXBlYXQgPiAwICkge1xuXG5cdFx0XHRcdGlmKCBpc0Zpbml0ZSggX3JlcGVhdCApICkge1xuXHRcdFx0XHRcdF9yZXBlYXQtLTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIHJlYXNzaWduIHN0YXJ0aW5nIHZhbHVlcywgcmVzdGFydCBieSBtYWtpbmcgc3RhcnRUaW1lID0gbm93XG5cdFx0XHRcdGZvciggcHJvcGVydHkgaW4gX3ZhbHVlc1N0YXJ0UmVwZWF0ICkge1xuXG5cdFx0XHRcdFx0aWYgKCB0eXBlb2YoIF92YWx1ZXNFbmRbIHByb3BlcnR5IF0gKSA9PT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0XHRcdF92YWx1ZXNTdGFydFJlcGVhdFsgcHJvcGVydHkgXSA9IF92YWx1ZXNTdGFydFJlcGVhdFsgcHJvcGVydHkgXSArIHBhcnNlRmxvYXQoX3ZhbHVlc0VuZFsgcHJvcGVydHkgXSwgMTApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChfeW95bykge1xuXHRcdFx0XHRcdFx0dmFyIHRtcCA9IF92YWx1ZXNTdGFydFJlcGVhdFsgcHJvcGVydHkgXTtcblx0XHRcdFx0XHRcdF92YWx1ZXNTdGFydFJlcGVhdFsgcHJvcGVydHkgXSA9IF92YWx1ZXNFbmRbIHByb3BlcnR5IF07XG5cdFx0XHRcdFx0XHRfdmFsdWVzRW5kWyBwcm9wZXJ0eSBdID0gdG1wO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdF92YWx1ZXNTdGFydFsgcHJvcGVydHkgXSA9IF92YWx1ZXNTdGFydFJlcGVhdFsgcHJvcGVydHkgXTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKF95b3lvKSB7XG5cdFx0XHRcdFx0X3JldmVyc2VkID0gIV9yZXZlcnNlZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdF9zdGFydFRpbWUgPSB0aW1lICsgX2RlbGF5VGltZTtcblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRpZiAoIF9vbkNvbXBsZXRlQ2FsbGJhY2sgIT09IG51bGwgKSB7XG5cblx0XHRcdFx0XHRfb25Db21wbGV0ZUNhbGxiYWNrLmNhbGwoIF9vYmplY3QgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Zm9yICggdmFyIGkgPSAwLCBudW1DaGFpbmVkVHdlZW5zID0gX2NoYWluZWRUd2VlbnMubGVuZ3RoOyBpIDwgbnVtQ2hhaW5lZFR3ZWVuczsgaSsrICkge1xuXG5cdFx0XHRcdFx0X2NoYWluZWRUd2VlbnNbIGkgXS5zdGFydCggdGltZSApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXG5cdH07XG5cbn07XG5cblxuVFdFRU4uRWFzaW5nID0ge1xuXG5cdExpbmVhcjoge1xuXG5cdFx0Tm9uZTogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gaztcblxuXHRcdH1cblxuXHR9LFxuXG5cdFF1YWRyYXRpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0cmV0dXJuIGsgKiBrO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gayAqICggMiAtIGsgKTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRpZiAoICggayAqPSAyICkgPCAxICkgcmV0dXJuIDAuNSAqIGsgKiBrO1xuXHRcdFx0cmV0dXJuIC0gMC41ICogKCAtLWsgKiAoIGsgLSAyICkgLSAxICk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRDdWJpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0cmV0dXJuIGsgKiBrICogaztcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0cmV0dXJuIC0tayAqIGsgKiBrICsgMTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRpZiAoICggayAqPSAyICkgPCAxICkgcmV0dXJuIDAuNSAqIGsgKiBrICogaztcblx0XHRcdHJldHVybiAwLjUgKiAoICggayAtPSAyICkgKiBrICogayArIDIgKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdFF1YXJ0aWM6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdHJldHVybiBrICogayAqIGsgKiBrO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gMSAtICggLS1rICogayAqIGsgKiBrICk7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0aWYgKCAoIGsgKj0gMiApIDwgMSkgcmV0dXJuIDAuNSAqIGsgKiBrICogayAqIGs7XG5cdFx0XHRyZXR1cm4gLSAwLjUgKiAoICggayAtPSAyICkgKiBrICogayAqIGsgLSAyICk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRRdWludGljOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gayAqIGsgKiBrICogayAqIGs7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdHJldHVybiAtLWsgKiBrICogayAqIGsgKiBrICsgMTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRpZiAoICggayAqPSAyICkgPCAxICkgcmV0dXJuIDAuNSAqIGsgKiBrICogayAqIGsgKiBrO1xuXHRcdFx0cmV0dXJuIDAuNSAqICggKCBrIC09IDIgKSAqIGsgKiBrICogayAqIGsgKyAyICk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRTaW51c29pZGFsOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gMSAtIE1hdGguY29zKCBrICogTWF0aC5QSSAvIDIgKTtcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0cmV0dXJuIE1hdGguc2luKCBrICogTWF0aC5QSSAvIDIgKTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gMC41ICogKCAxIC0gTWF0aC5jb3MoIE1hdGguUEkgKiBrICkgKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdEV4cG9uZW50aWFsOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHRyZXR1cm4gayA9PT0gMCA/IDAgOiBNYXRoLnBvdyggMTAyNCwgayAtIDEgKTtcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0cmV0dXJuIGsgPT09IDEgPyAxIDogMSAtIE1hdGgucG93KCAyLCAtIDEwICogayApO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdGlmICggayA9PT0gMCApIHJldHVybiAwO1xuXHRcdFx0aWYgKCBrID09PSAxICkgcmV0dXJuIDE7XG5cdFx0XHRpZiAoICggayAqPSAyICkgPCAxICkgcmV0dXJuIDAuNSAqIE1hdGgucG93KCAxMDI0LCBrIC0gMSApO1xuXHRcdFx0cmV0dXJuIDAuNSAqICggLSBNYXRoLnBvdyggMiwgLSAxMCAqICggayAtIDEgKSApICsgMiApO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0Q2lyY3VsYXI6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdHJldHVybiAxIC0gTWF0aC5zcXJ0KCAxIC0gayAqIGsgKTtcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0cmV0dXJuIE1hdGguc3FydCggMSAtICggLS1rICogayApICk7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uICggayApIHtcblxuXHRcdFx0aWYgKCAoIGsgKj0gMiApIDwgMSkgcmV0dXJuIC0gMC41ICogKCBNYXRoLnNxcnQoIDEgLSBrICogaykgLSAxKTtcblx0XHRcdHJldHVybiAwLjUgKiAoIE1hdGguc3FydCggMSAtICggayAtPSAyKSAqIGspICsgMSk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRFbGFzdGljOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHR2YXIgcywgYSA9IDAuMSwgcCA9IDAuNDtcblx0XHRcdGlmICggayA9PT0gMCApIHJldHVybiAwO1xuXHRcdFx0aWYgKCBrID09PSAxICkgcmV0dXJuIDE7XG5cdFx0XHRpZiAoICFhIHx8IGEgPCAxICkgeyBhID0gMTsgcyA9IHAgLyA0OyB9XG5cdFx0XHRlbHNlIHMgPSBwICogTWF0aC5hc2luKCAxIC8gYSApIC8gKCAyICogTWF0aC5QSSApO1xuXHRcdFx0cmV0dXJuIC0gKCBhICogTWF0aC5wb3coIDIsIDEwICogKCBrIC09IDEgKSApICogTWF0aC5zaW4oICggayAtIHMgKSAqICggMiAqIE1hdGguUEkgKSAvIHAgKSApO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHR2YXIgcywgYSA9IDAuMSwgcCA9IDAuNDtcblx0XHRcdGlmICggayA9PT0gMCApIHJldHVybiAwO1xuXHRcdFx0aWYgKCBrID09PSAxICkgcmV0dXJuIDE7XG5cdFx0XHRpZiAoICFhIHx8IGEgPCAxICkgeyBhID0gMTsgcyA9IHAgLyA0OyB9XG5cdFx0XHRlbHNlIHMgPSBwICogTWF0aC5hc2luKCAxIC8gYSApIC8gKCAyICogTWF0aC5QSSApO1xuXHRcdFx0cmV0dXJuICggYSAqIE1hdGgucG93KCAyLCAtIDEwICogaykgKiBNYXRoLnNpbiggKCBrIC0gcyApICogKCAyICogTWF0aC5QSSApIC8gcCApICsgMSApO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdHZhciBzLCBhID0gMC4xLCBwID0gMC40O1xuXHRcdFx0aWYgKCBrID09PSAwICkgcmV0dXJuIDA7XG5cdFx0XHRpZiAoIGsgPT09IDEgKSByZXR1cm4gMTtcblx0XHRcdGlmICggIWEgfHwgYSA8IDEgKSB7IGEgPSAxOyBzID0gcCAvIDQ7IH1cblx0XHRcdGVsc2UgcyA9IHAgKiBNYXRoLmFzaW4oIDEgLyBhICkgLyAoIDIgKiBNYXRoLlBJICk7XG5cdFx0XHRpZiAoICggayAqPSAyICkgPCAxICkgcmV0dXJuIC0gMC41ICogKCBhICogTWF0aC5wb3coIDIsIDEwICogKCBrIC09IDEgKSApICogTWF0aC5zaW4oICggayAtIHMgKSAqICggMiAqIE1hdGguUEkgKSAvIHAgKSApO1xuXHRcdFx0cmV0dXJuIGEgKiBNYXRoLnBvdyggMiwgLTEwICogKCBrIC09IDEgKSApICogTWF0aC5zaW4oICggayAtIHMgKSAqICggMiAqIE1hdGguUEkgKSAvIHAgKSAqIDAuNSArIDE7XG5cblx0XHR9XG5cblx0fSxcblxuXHRCYWNrOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHR2YXIgcyA9IDEuNzAxNTg7XG5cdFx0XHRyZXR1cm4gayAqIGsgKiAoICggcyArIDEgKSAqIGsgLSBzICk7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdHZhciBzID0gMS43MDE1ODtcblx0XHRcdHJldHVybiAtLWsgKiBrICogKCAoIHMgKyAxICkgKiBrICsgcyApICsgMTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKCBrICkge1xuXG5cdFx0XHR2YXIgcyA9IDEuNzAxNTggKiAxLjUyNTtcblx0XHRcdGlmICggKCBrICo9IDIgKSA8IDEgKSByZXR1cm4gMC41ICogKCBrICogayAqICggKCBzICsgMSApICogayAtIHMgKSApO1xuXHRcdFx0cmV0dXJuIDAuNSAqICggKCBrIC09IDIgKSAqIGsgKiAoICggcyArIDEgKSAqIGsgKyBzICkgKyAyICk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRCb3VuY2U6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdHJldHVybiAxIC0gVFdFRU4uRWFzaW5nLkJvdW5jZS5PdXQoIDEgLSBrICk7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdGlmICggayA8ICggMSAvIDIuNzUgKSApIHtcblxuXHRcdFx0XHRyZXR1cm4gNy41NjI1ICogayAqIGs7XG5cblx0XHRcdH0gZWxzZSBpZiAoIGsgPCAoIDIgLyAyLjc1ICkgKSB7XG5cblx0XHRcdFx0cmV0dXJuIDcuNTYyNSAqICggayAtPSAoIDEuNSAvIDIuNzUgKSApICogayArIDAuNzU7XG5cblx0XHRcdH0gZWxzZSBpZiAoIGsgPCAoIDIuNSAvIDIuNzUgKSApIHtcblxuXHRcdFx0XHRyZXR1cm4gNy41NjI1ICogKCBrIC09ICggMi4yNSAvIDIuNzUgKSApICogayArIDAuOTM3NTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRyZXR1cm4gNy41NjI1ICogKCBrIC09ICggMi42MjUgLyAyLjc1ICkgKSAqIGsgKyAwLjk4NDM3NTtcblxuXHRcdFx0fVxuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoIGsgKSB7XG5cblx0XHRcdGlmICggayA8IDAuNSApIHJldHVybiBUV0VFTi5FYXNpbmcuQm91bmNlLkluKCBrICogMiApICogMC41O1xuXHRcdFx0cmV0dXJuIFRXRUVOLkVhc2luZy5Cb3VuY2UuT3V0KCBrICogMiAtIDEgKSAqIDAuNSArIDAuNTtcblxuXHRcdH1cblxuXHR9XG5cbn07XG5cblRXRUVOLkludGVycG9sYXRpb24gPSB7XG5cblx0TGluZWFyOiBmdW5jdGlvbiAoIHYsIGsgKSB7XG5cblx0XHR2YXIgbSA9IHYubGVuZ3RoIC0gMSwgZiA9IG0gKiBrLCBpID0gTWF0aC5mbG9vciggZiApLCBmbiA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuTGluZWFyO1xuXG5cdFx0aWYgKCBrIDwgMCApIHJldHVybiBmbiggdlsgMCBdLCB2WyAxIF0sIGYgKTtcblx0XHRpZiAoIGsgPiAxICkgcmV0dXJuIGZuKCB2WyBtIF0sIHZbIG0gLSAxIF0sIG0gLSBmICk7XG5cblx0XHRyZXR1cm4gZm4oIHZbIGkgXSwgdlsgaSArIDEgPiBtID8gbSA6IGkgKyAxIF0sIGYgLSBpICk7XG5cblx0fSxcblxuXHRCZXppZXI6IGZ1bmN0aW9uICggdiwgayApIHtcblxuXHRcdHZhciBiID0gMCwgbiA9IHYubGVuZ3RoIC0gMSwgcHcgPSBNYXRoLnBvdywgYm4gPSBUV0VFTi5JbnRlcnBvbGF0aW9uLlV0aWxzLkJlcm5zdGVpbiwgaTtcblxuXHRcdGZvciAoIGkgPSAwOyBpIDw9IG47IGkrKyApIHtcblx0XHRcdGIgKz0gcHcoIDEgLSBrLCBuIC0gaSApICogcHcoIGssIGkgKSAqIHZbIGkgXSAqIGJuKCBuLCBpICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGI7XG5cblx0fSxcblxuXHRDYXRtdWxsUm9tOiBmdW5jdGlvbiAoIHYsIGsgKSB7XG5cblx0XHR2YXIgbSA9IHYubGVuZ3RoIC0gMSwgZiA9IG0gKiBrLCBpID0gTWF0aC5mbG9vciggZiApLCBmbiA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuQ2F0bXVsbFJvbTtcblxuXHRcdGlmICggdlsgMCBdID09PSB2WyBtIF0gKSB7XG5cblx0XHRcdGlmICggayA8IDAgKSBpID0gTWF0aC5mbG9vciggZiA9IG0gKiAoIDEgKyBrICkgKTtcblxuXHRcdFx0cmV0dXJuIGZuKCB2WyAoIGkgLSAxICsgbSApICUgbSBdLCB2WyBpIF0sIHZbICggaSArIDEgKSAlIG0gXSwgdlsgKCBpICsgMiApICUgbSBdLCBmIC0gaSApO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0aWYgKCBrIDwgMCApIHJldHVybiB2WyAwIF0gLSAoIGZuKCB2WyAwIF0sIHZbIDAgXSwgdlsgMSBdLCB2WyAxIF0sIC1mICkgLSB2WyAwIF0gKTtcblx0XHRcdGlmICggayA+IDEgKSByZXR1cm4gdlsgbSBdIC0gKCBmbiggdlsgbSBdLCB2WyBtIF0sIHZbIG0gLSAxIF0sIHZbIG0gLSAxIF0sIGYgLSBtICkgLSB2WyBtIF0gKTtcblxuXHRcdFx0cmV0dXJuIGZuKCB2WyBpID8gaSAtIDEgOiAwIF0sIHZbIGkgXSwgdlsgbSA8IGkgKyAxID8gbSA6IGkgKyAxIF0sIHZbIG0gPCBpICsgMiA/IG0gOiBpICsgMiBdLCBmIC0gaSApO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0VXRpbHM6IHtcblxuXHRcdExpbmVhcjogZnVuY3Rpb24gKCBwMCwgcDEsIHQgKSB7XG5cblx0XHRcdHJldHVybiAoIHAxIC0gcDAgKSAqIHQgKyBwMDtcblxuXHRcdH0sXG5cblx0XHRCZXJuc3RlaW46IGZ1bmN0aW9uICggbiAsIGkgKSB7XG5cblx0XHRcdHZhciBmYyA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuRmFjdG9yaWFsO1xuXHRcdFx0cmV0dXJuIGZjKCBuICkgLyBmYyggaSApIC8gZmMoIG4gLSBpICk7XG5cblx0XHR9LFxuXG5cdFx0RmFjdG9yaWFsOiAoIGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0dmFyIGEgPSBbIDEgXTtcblxuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uICggbiApIHtcblxuXHRcdFx0XHR2YXIgcyA9IDEsIGk7XG5cdFx0XHRcdGlmICggYVsgbiBdICkgcmV0dXJuIGFbIG4gXTtcblx0XHRcdFx0Zm9yICggaSA9IG47IGkgPiAxOyBpLS0gKSBzICo9IGk7XG5cdFx0XHRcdHJldHVybiBhWyBuIF0gPSBzO1xuXG5cdFx0XHR9O1xuXG5cdFx0fSApKCksXG5cblx0XHRDYXRtdWxsUm9tOiBmdW5jdGlvbiAoIHAwLCBwMSwgcDIsIHAzLCB0ICkge1xuXG5cdFx0XHR2YXIgdjAgPSAoIHAyIC0gcDAgKSAqIDAuNSwgdjEgPSAoIHAzIC0gcDEgKSAqIDAuNSwgdDIgPSB0ICogdCwgdDMgPSB0ICogdDI7XG5cdFx0XHRyZXR1cm4gKCAyICogcDEgLSAyICogcDIgKyB2MCArIHYxICkgKiB0MyArICggLSAzICogcDEgKyAzICogcDIgLSAyICogdjAgLSB2MSApICogdDIgKyB2MCAqIHQgKyBwMTtcblxuXHRcdH1cblxuXHR9XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzPVRXRUVOOyIsIi8vIGNsYXNzIG1vZHVsZXNcbnZhciBTdGF0ZXMgPSByZXF1aXJlKCcuL3N0YXRlcycpO1xudmFyIFNwaW5uZXIgPSByZXF1aXJlKCcuL3NwaW5uZXInKTtcbnZhciBTcGluQnV0dG9uID0gcmVxdWlyZSgnLi9zcGluLWJ1dHRvbicpO1xudmFyIE1lZGlhdG9yID0gcmVxdWlyZShcIm1lZGlhdG9yLWpzXCIpLk1lZGlhdG9yO1xuXG4vLyBnbG9iYWxzXG5nbG9iYWwuYWN0aXZpdHkgPSB7fTtcbmdsb2JhbC5hY3Rpdml0eS5tZWRpYXRvciA9IG5ldyBNZWRpYXRvcigpO1xuZ2xvYmFsLmFjdGl2aXR5Lm1lZGlhdG9yLnN1YnNjcmliZSgnc3RhdGUnLCBmdW5jdGlvbihzdGF0ZSkge1xuXHRnbG9iYWwuYWN0aXZpdHkuc3RhdGUgPSBzdGF0ZTtcbn0pO1xuXG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHR2YXIgc3Bpbm5lciA9IG5ldyBTcGlubmVyKFtcblx0XHQnZXR0Jyxcblx0XHQndHbDpScsXG5cdFx0J3RyZScsXG5cdFx0J2Z5cmEnXG5cdF0sICQoJyNzcGluYXJvbycpKTtcblxuXHRuZXcgU3BpbkJ1dHRvbihzcGlubmVyLCAkKFwiI3N0b3BcIikpO1xuXG5cdGdsb2JhbC5hY3Rpdml0eS5tZWRpYXRvci5wdWJsaXNoKCdzdGF0ZScsIFN0YXRlcy5JRExFKTtcblxuXHRpZigkLmNvb2tpZSgnYWN0aXZpdHknKSAhPT0gbnVsbCkge1xuXHRcdHZhciBhY3Rpdml0aWVzID0gJC5jb29raWUoJ2FjdGl2aXR5Jykuc3BsaXQoL1xccyosXFxzKi8pO1xuXHRcdHNwaW5uZXIubmV3VGV4dHMoYWN0aXZpdGllcyk7XG5cdFx0JChcIiN1cGRhdGVUZXh0XCIpLnZhbChhY3Rpdml0aWVzLmpvaW4oJywgJykpO1xuXHR9XG59KTtcblxuJChcIiN1cGRhdGVTdWJtaXRcIikub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdCQuY29va2llKCdhY3Rpdml0eScsICQoJyN1cGRhdGVUZXh0JykudmFsKCkudG9TdHJpbmcoKSk7XG5cdGxvY2F0aW9uLnJlbG9hZCgpO1xufSk7XG4kKFwiI2Nvb2tpZURlYnVnXCIpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHQkLmNvb2tpZSgnYWN0aXZpdHknLCBudWxsKTtcblx0bG9jYXRpb24ucmVsb2FkKCk7XG59KTsiLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAvLyBob3cgb2Z0ZW4gdGhlIHNwaW5uZXIgdXBkYXRlc1xuXHRGUFM6IDMwLFxuXG4gICAgLy8gaG93IGZhc3QgdGhlIHNwaW5uZXIgc3BpbnMgKG1heCB2ZWxvY2l0eSlcblx0TE9PUFNfUEVSX1NFQ09ORDogMixcblxuICAgIC8vIGFjY2VsZXJhdGlvbi9kZWNlbGVyYXRpb24gdGltZSAoaW4gYXBwcm94aW1hdGUgc2Vjb25kcylcbiAgICBBQ0NFTEVSQVRJT05fVElNRTogMixcbiAgICBERUNFTEVSQVRJT05fVElNRTogNSxcblxuXHQvLyBzcGlubmluZy10ZXh0IHBvc2l0aW9uIGJvdW5kYXJpZXNcbiAgICBNSU5fUE9TSVRJT046IDAsXG4gICAgTUFYX1BPU0lUSU9OOiAxMDAsXG4gICAgTUlERExFX1BPU0lUSU9OOiA1MCxcblxuICAgIC8vIHJhdGlvIGJldHdlZW4gY29udGFpbmVyIHNpemUgYW5kIHBvc2l0aW9uIGJvdW5kYXJpZXNcbiAgICBTVEVQOiAxMCwgXG5cbiAgICAvLyBjb2xvciBpbnRlcnBvbGF0aW9uICh1c2UgaHNsKVxuICAgIEZST01fQ09MT1I6ICdoc2woNDgsIDEwMCUsIDUwJSknLFxuICAgIFRPX0NPTE9SOiAnaHNsKDI5LCAxMDAlLCA1MCUpJyxcbn07XG4iLCJ2YXIgU3RhdGVzID0gcmVxdWlyZSgnLi9zdGF0ZXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG5cdGZ1bmN0aW9uIFNwaW5CdXR0b24oc3Bpbm5lciwgJGJ1dHRvbikge1xuXHRcdHRoaXMuX3NwaW5uZXIgPSBzcGlubmVyO1xuXHRcdHRoaXMuJCA9ICRidXR0b247XG5cdFx0dGhpcy4kLmh0bWwoJ3N0YXJ0Jyk7XG5cblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHRcdCRidXR0b24ub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRzd2l0Y2ggKGdsb2JhbC5hY3Rpdml0eS5zdGF0ZSkge1xuXHRcdFx0XHRjYXNlIFN0YXRlcy5JRExFOlxuXHRcdFx0XHRcdGdsb2JhbC5hY3Rpdml0eS5tZWRpYXRvci5wdWJsaXNoKCdzdGF0ZScsIFN0YXRlcy5TUElOKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBTdGF0ZXMuU1BJTjpcblx0XHRcdFx0XHRnbG9iYWwuYWN0aXZpdHkubWVkaWF0b3IucHVibGlzaCgnc3RhdGUnLCBTdGF0ZXMuU1RPUCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgU3RhdGVzLlNUT1A6XG5cdFx0XHRcdFx0Ly8gZG8gbm90aGluZ1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Z2xvYmFsLmFjdGl2aXR5Lm1lZGlhdG9yLnN1YnNjcmliZSgnc3RhdGUnLCBmdW5jdGlvbihzdGF0ZSkge1xuXHRcdFx0c3dpdGNoIChzdGF0ZSkge1xuXHRcdFx0XHRjYXNlIFN0YXRlcy5JRExFOlxuXHRcdFx0XHRcdGluc3RhbmNlLiQuaHRtbCgnc3RhcnQnKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBTdGF0ZXMuU1BJTjpcblx0XHRcdFx0XHRpbnN0YW5jZS4kLmh0bWwoJ3N0b3AnKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBTdGF0ZXMuU1RPUDpcblx0XHRcdFx0XHRpbnN0YW5jZS4kLmh0bWwoJ3N0b3BwaW5nLi4uJyk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gU3BpbkJ1dHRvbjtcbn0pKCk7XG4iLCJ2YXIgU3RhdGVzID0gcmVxdWlyZSgnLi9zdGF0ZXMnKTtcbnZhciBTcGlubmluZ1RleHQgPSByZXF1aXJlKCcuL3NwaW5uaW5nLXRleHQnKTtcbnZhciBDb25zdGFudHMgPSByZXF1aXJlKCcuL2NvbnN0YW50cycpO1xudmFyIFRXRUVOID0gcmVxdWlyZSgndHdlZW4uanMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG5cdGZ1bmN0aW9uIFNwaW5uZXIodGV4dHMsICRjb250YWluZXIpIHtcblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzOyAvLyBib29vXG5cblx0XHR0aGlzLl8kY29udGFpbmVyID0gJGNvbnRhaW5lcjtcblxuXHRcdC8vIGluaXQgdGhlIHRleHRzXG5cdFx0dGhpcy5uZXdUZXh0cyh0ZXh0cyk7XG5cblx0XHQvLyBsb29wL3VwZGF0ZSB2YWx1ZXNcblx0XHR0aGlzLl9sb29wUnVubmluZyA9IGZhbHNlO1xuXHRcdHRoaXMuX3ZlbG9jaXR5ID0gMDtcblx0XHR0aGlzLl9hY2NlbGVyYXRpb25TdGVwID0gMSAvIChDb25zdGFudHMuQUNDRUxFUkFUSU9OX1RJTUUgKiBDb25zdGFudHMuRlBTKTtcblx0XHR0aGlzLl9kZWNlbGVyYXRpb25TdGVwID0gMSAvIChDb25zdGFudHMuREVDRUxFUkFUSU9OX1RJTUUgKiBDb25zdGFudHMuRlBTKTtcblx0XHR0aGlzLl9kZWxheSA9IDEwMDAgLyBDb25zdGFudHMuRlBTO1xuXG5cdFx0Ly8gcmVnaXN0ZXIgbWVkaWF0b3Igc3Vic2NyaXB0aW9uXG5cdFx0Z2xvYmFsLmFjdGl2aXR5Lm1lZGlhdG9yLnN1YnNjcmliZSgnc3RhdGUnLCBmdW5jdGlvbihzdGF0ZSkge1xuXHRcdFx0c3dpdGNoIChzdGF0ZSkge1xuXHRcdFx0XHRjYXNlIFN0YXRlcy5JRExFOlxuXHRcdFx0XHRcdGluc3RhbmNlLl9sb29wUnVubmluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFN0YXRlcy5TUElOOlxuXHRcdFx0XHRcdGlmICghaW5zdGFuY2UuX2xvb3BSdW5uaW5nKSB7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5fbmV3V2lubmVyKCk7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS5fbG9vcFJ1bm5pbmcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0aW5zdGFuY2UuX3RpbWUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGVyZm9ybWFuY2UgIT09IHVuZGVmaW5lZCAmJiB3aW5kb3cucGVyZm9ybWFuY2Uubm93ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpO1xuXHRcdFx0XHRcdFx0aW5zdGFuY2UuX2xvb3AoaW5zdGFuY2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBTdGF0ZXMuU1RPUDpcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdFNwaW5uZXIucHJvdG90eXBlLm5ld1RleHRzID0gZnVuY3Rpb24odGV4dHMpIHtcblx0XHR2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXG5cdFx0dGhpcy5fJGNvbnRhaW5lci5odG1sKCcnKTtcblx0XHR0aGlzLl9zcGlubmluZ1RleHRzID0gW107XG5cdFx0dGV4dHMuZm9yRWFjaChmdW5jdGlvbih0ZXh0LCBpKSB7XG5cdFx0XHR2YXIgc3Bpbm5pbmdUZXh0ID0gbmV3IFNwaW5uaW5nVGV4dCh0ZXh0LCAoQ29uc3RhbnRzLk1JRERMRV9QT1NJVElPTiArIGkgKiAoQ29uc3RhbnRzLk1BWF9QT1NJVElPTiAvIHRleHRzLmxlbmd0aCkpICUgQ29uc3RhbnRzLk1BWF9QT1NJVElPTik7XG5cdFx0XHRpbnN0YW5jZS5fc3Bpbm5pbmdUZXh0cy5wdXNoKHNwaW5uaW5nVGV4dCk7XG5cdFx0XHRzcGlubmluZ1RleHQuYXBwZW5kVG8oaW5zdGFuY2UuXyRjb250YWluZXIpO1xuXHRcdH0pO1xuXHR9O1xuXG5cdFNwaW5uZXIucHJvdG90eXBlLl9uZXdXaW5uZXIgPSBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl93aW5uZXIgPSB0aGlzLl9zcGlubmluZ1RleHRzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuX3NwaW5uaW5nVGV4dHMubGVuZ3RoKV07XG5cdH07XG5cblx0U3Bpbm5lci5wcm90b3R5cGUuX3JlbmRlciA9IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX3NwaW5uaW5nVGV4dHMuZm9yRWFjaChmdW5jdGlvbihzcGlubmluZ1RleHQpIHtcblx0XHRcdHNwaW5uaW5nVGV4dC5yZW5kZXIoKTtcblx0XHR9LmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdFNwaW5uZXIucHJvdG90eXBlLl91cGRhdGUgPSBmdW5jdGlvbihkdCkge1xuXHRcdGlmIChnbG9iYWwuYWN0aXZpdHkuc3RhdGUgPT09IFN0YXRlcy5TUElOICYmIHRoaXMuX3ZlbG9jaXR5IDw9IDEpIHtcblx0IFx0XHR0aGlzLl92ZWxvY2l0eSArPSB0aGlzLl9hY2NlbGVyYXRpb25TdGVwO1xuXHRcdH0gZWxzZSBpZiAoZ2xvYmFsLmFjdGl2aXR5LnN0YXRlID09PSBTdGF0ZXMuU1RPUCkge1xuXHRcdFx0aWYgKHRoaXMuX3ZlbG9jaXR5ID4gMC4wNSkge1xuXHRcdFx0XHR0aGlzLl92ZWxvY2l0eSAtPSB0aGlzLl9kZWNlbGVyYXRpb25TdGVwO1xuXHRcdFx0fSBcblxuXHRcdFx0aWYgKHRoaXMuX3ZlbG9jaXR5IDwgMC40ICYmIHRoaXMuX3dpbm5lci53aW5uaW5nUG9zaXRpb24oKSAmJiBNYXRoLnJhbmRvbSgpIDwgMC45OSkge1xuXHRcdFx0XHRpZiAodHlwZW9mIHRoaXMuX3R3ZWVuID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRcdHZhciBpbnN0YW5jZSA9IHRoaXM7XG5cblx0XHRcdFx0XHQvLyBzdG9wcGluZyBhbmltYXRpb25cblx0XHRcdFx0XHR0aGlzLl90d2VlbiA9IG5ldyBUV0VFTi5Ud2Vlbih7eDogaW5zdGFuY2UuX3dpbm5lci5nZXRQb3NpdGlvbigpfSlcblx0XHQgICAgICAgICAgICAudG8oe3g6IFtDb25zdGFudHMuTUlERExFX1BPU0lUSU9OICsgdGhpcy5fdmVsb2NpdHkgKiBDb25zdGFudHMuTE9PUFNfUEVSX1NFQ09ORCAqIDIwLCBpbnN0YW5jZS5fd2lubmVyLmdldFBvc2l0aW9uKCldfSwgQ29uc3RhbnRzLkxPT1BTX1BFUl9TRUNPTkQgKiA1MDApXG5cdFx0ICAgICAgICAgICAgLmVhc2luZyhUV0VFTi5FYXNpbmcuQmFjay5PdXQpXG5cdFx0ICAgICAgICAgICAgLm9uVXBkYXRlKGZ1bmN0aW9uICgpIHtcblx0XHQgICAgICAgICAgICBcdGluc3RhbmNlLl93aW5uZXIuX3Bvc2l0aW9uID0gdGhpcy54O1xuXHRcdCAgICAgICAgICAgIH0pXG5cdFx0ICAgICAgICAgICAgLm9uQ29tcGxldGUoZnVuY3Rpb24oKSB7XG5cdFx0ICAgICAgICAgICAgXHRkZWxldGUgaW5zdGFuY2UuX3R3ZWVuO1xuXHRcdCAgICAgICAgXHRcdGdsb2JhbC5hY3Rpdml0eS5tZWRpYXRvci5wdWJsaXNoKCdzdGF0ZScsIFN0YXRlcy5JRExFKTtcblx0XHQgICAgICAgICAgICB9KVxuXHRcdCAgICAgICAgICAgIC5zdGFydCgpO1xuXG5cdFx0XHRcdFx0dGhpcy5fdmVsb2NpdHkgPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiB0aGlzLl90d2VlbiA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdHRoaXMuX3NwaW5uaW5nVGV4dHMuZm9yRWFjaChmdW5jdGlvbihzcGlubmluZ1RleHQpIHtcblx0XHRcdFx0c3Bpbm5pbmdUZXh0LnVwZGF0ZSh0aGlzLl92ZWxvY2l0eSwgZHQpO1xuXHRcdFx0fS5iaW5kKHRoaXMpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0VFdFRU4udXBkYXRlKCk7XG5cdFx0fVxuXHRcdFxuXHR9O1xuXG5cdFNwaW5uZXIucHJvdG90eXBlLl9sb29wID0gZnVuY3Rpb24oaW5zdGFuY2UpIHtcblx0XHQvLyBnZXQgZGVsdGEgdGltZVxuXHRcdHZhciB0aW1lID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnBlcmZvcm1hbmNlICE9PSB1bmRlZmluZWQgJiYgd2luZG93LnBlcmZvcm1hbmNlLm5vdyAhPT0gdW5kZWZpbmVkID8gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpIDogRGF0ZS5ub3coKTtcblx0XHRkdCA9ICh0aW1lIC0gaW5zdGFuY2UuX3RpbWUpO1xuXG5cdFx0aW5zdGFuY2UuX3VwZGF0ZShkdCk7XG5cdFx0aW5zdGFuY2UuX3JlbmRlcigpO1xuXG5cdFx0Ly8gc3RvcmUgdGltZSBmb3IgbmV4dCBsb29wXG5cdFx0aW5zdGFuY2UuX3RpbWUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGVyZm9ybWFuY2UgIT09IHVuZGVmaW5lZCAmJiB3aW5kb3cucGVyZm9ybWFuY2Uubm93ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpO1xuXHRcdFxuXHRcdC8vIGFkanVzdCBkZWxheSBiYXNlZCBvbiBleGVjdXRpb24gdGltZSBvZiBsb29wXG5cdFx0dmFyIGRlbGF5ID0gaW5zdGFuY2UuX2RlbGF5IC0gKGluc3RhbmNlLl90aW1lIC0gdGltZSk7XG5cdFx0ZGVsYXkgPSBkZWxheSA8IDAgPyAwIDogZGVsYXk7XG5cblx0XHQvLyBsb29wIVxuXHRcdGlmIChnbG9iYWwuYWN0aXZpdHkuc3RhdGUgIT09IFN0YXRlcy5JRExFKSB7XG5cdFx0XHRzZXRUaW1lb3V0KGluc3RhbmNlLl9sb29wLCBkZWxheSwgaW5zdGFuY2UpO1xuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4gU3Bpbm5lcjtcbn0pKCk7XG4iLCJ2YXIgQ29uc3RhbnRzID0gcmVxdWlyZSgnLi9jb25zdGFudHMnKTtcbnZhciBzbW9vdGhzdGVwID0gcmVxdWlyZSgnaW50ZXJwb2xhdGlvbicpLnNtb290aHN0ZXA7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXHRub3JtYWxpemVkUG9zaXRpb246IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiBzbW9vdGhzdGVwKDAsIDEsIDEgLSBNYXRoLmFicyhwb3NpdGlvbiAtIENvbnN0YW50cy5NQVhfUE9TSVRJT04gLyAyKSAvIChDb25zdGFudHMuTUFYX1BPU0lUSU9OIC8gMikpO1xuICAgIH0sXG5cbiAgICBmb250U2l6ZTogZnVuY3Rpb24oc21vb3Roc3RlcHBlZFBvcykge1xuICAgICAgICByZXR1cm4gKDE2ICsgc21vb3Roc3RlcHBlZFBvcyAqIDMyKSArICdwdCc7XG4gICAgfSxcblxuICAgIHRleHRTaGFkb3c6IGZ1bmN0aW9uKHRleHRTaGFkb3dDc3MsIGNvbG9yKSB7XG4gICAgICAgIHJldHVybiB0ZXh0U2hhZG93Q3NzLnJlcGxhY2UoL3JnYmE/XFwoW15cXCldK1xcKS8sIGNvbG9yKTtcbiAgICB9LFxuXG4gICAgcmlnaHQ6IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbiAqIENvbnN0YW50cy5TVEVQO1xuICAgIH1cbn07XG4iLCJ2YXIgaW50ZXJwb2xhdGVDb2xvciA9IHJlcXVpcmUoJ2pzYW50ZWxsLWludGVycG9sYXRlLWNvbG9yJyk7XG52YXIgQ29uc3RhbnRzID0gcmVxdWlyZSgnLi9jb25zdGFudHMnKTtcbnZhciBIZWxwZXJzID0gcmVxdWlyZSgnLi9zcGlubmluZy10ZXh0LWhlbHBlcnMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNwaW5uaW5nVGV4dExvb2t1cChncmFudWxhcml0eSwgdGV4dFNoYWRvd0Nzcykge1xuICAgICAgICB0aGlzLl9ncmFudWxhcml0eSA9IGdyYW51bGFyaXR5IHx8IENvbnN0YW50cy5NQVhfUE9TSVRJT047XG4gICAgICAgIHRoaXMuX3JhdGlvID0gKENvbnN0YW50cy5NQVhfUE9TSVRJT04gLSBDb25zdGFudHMuTUlOX1BPU0lUSU9OKSAvIHRoaXMuX2dyYW51bGFyaXR5O1xuXG4gICAgICAgIHZhciBpLCBwb3M7XG5cbiAgICAgICAgLy8gbWFrZXMgc3VyZSB0aGF0IHRoZSBtaWRkbGUgcG9zaXRpb25pbmcgaXMgYWx3YXlzIGluY2x1ZGVkIGluIHRoZSBsb29rdXBzXG4gICAgICAgIHZhciBzdGFydFBvcztcbiAgICAgICAgZm9yIChzdGFydFBvcyA9IDA7IHN0YXJ0UG9zIDwgQ29uc3RhbnRzLk1JRERMRV9QT1NJVElPTjsgc3RhcnRQb3MgKz0gdGhpcy5fcmF0aW8pO1xuICAgICAgICBzdGFydFBvcyA9IHN0YXJ0UG9zICUgQ29uc3RhbnRzLk1JRERMRV9QT1NJVElPTjtcblxuICAgICAgICAvLyBjcmVhdGUgdGhlIGxvb2t1cCBhcnJheXNcbiAgICAgICAgdGhpcy5fbm9ybWFsaXplZFBvc2l0aW9uID0gW107XG4gICAgICAgIHRoaXMuX2NvbG9yID0gW107XG4gICAgICAgIHRoaXMuX2ZvbnRTaXplID0gW107XG4gICAgICAgIHRoaXMuX3RleHRTaGFkb3cgPSBbXTtcbiAgICAgICAgdGhpcy5fcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX2dyYW51bGFyaXR5OyBpKyspIHtcbiAgICAgICAgICAgIHBvcyA9IHN0YXJ0UG9zICsgaSAqIHRoaXMuX3JhdGlvO1xuICAgIFx0XHR0aGlzLl9ub3JtYWxpemVkUG9zaXRpb24ucHVzaChIZWxwZXJzLm5vcm1hbGl6ZWRQb3NpdGlvbihpICogdGhpcy5fcmF0aW8pKTtcbiAgICAgICAgICAgIHRoaXMuX2NvbG9yLnB1c2goaW50ZXJwb2xhdGVDb2xvcihDb25zdGFudHMuRlJPTV9DT0xPUiwgQ29uc3RhbnRzLlRPX0NPTE9SLCB0aGlzLl9ub3JtYWxpemVkUG9zaXRpb25baV0pKTtcbiAgICAgICAgICAgIHRoaXMuX2ZvbnRTaXplLnB1c2goSGVscGVycy5mb250U2l6ZSh0aGlzLl9ub3JtYWxpemVkUG9zaXRpb25baV0pKTtcbiAgICAgICAgICAgIHRoaXMuX3RleHRTaGFkb3cucHVzaChIZWxwZXJzLnRleHRTaGFkb3codGV4dFNoYWRvd0NzcywgdGhpcy5fY29sb3JbaV0pKTtcbiAgICAgICAgICAgIHRoaXMuX3JpZ2h0LnB1c2goSGVscGVycy5yaWdodChwb3MpKTtcbiAgICBcdH1cbiAgICB9XG5cbiAgICBTcGlubmluZ1RleHRMb29rdXAucHJvdG90eXBlLm5vcm1hbGl6ZWRQb3NpdGlvbiA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ub3JtYWxpemVkUG9zaXRpb25bTWF0aC5mbG9vcihwb3NpdGlvbiAvIHRoaXMuX3JhdGlvKV07XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dExvb2t1cC5wcm90b3R5cGUuY29sb3IgPSBmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29sb3JbTWF0aC5mbG9vcihwb3NpdGlvbiAvIHRoaXMuX3JhdGlvKV07XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dExvb2t1cC5wcm90b3R5cGUuZm9udFNpemUgPSBmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9udFNpemVbTWF0aC5mbG9vcihwb3NpdGlvbiAvIHRoaXMuX3JhdGlvKV07XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dExvb2t1cC5wcm90b3R5cGUudGV4dFNoYWRvdyA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXh0U2hhZG93W01hdGguZmxvb3IocG9zaXRpb24gLyB0aGlzLl9yYXRpbyldO1xuICAgIH07XG5cbiAgICBTcGlubmluZ1RleHRMb29rdXAucHJvdG90eXBlLnJpZ2h0ID0gZnVuY3Rpb24ocG9zaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JpZ2h0W01hdGguZmxvb3IocG9zaXRpb24gLyB0aGlzLl9yYXRpbyldO1xuICAgIH07XG5cbiAgICByZXR1cm4gU3Bpbm5pbmdUZXh0TG9va3VwO1xufSkoKTtcbiIsInZhciBDb25zdGFudHMgPSByZXF1aXJlKCcuL2NvbnN0YW50cycpO1xudmFyIGludGVycG9sYXRlQ29sb3IgPSByZXF1aXJlKCdqc2FudGVsbC1pbnRlcnBvbGF0ZS1jb2xvcicpO1xudmFyIEhlbHBlcnMgPSByZXF1aXJlKCcuL3NwaW5uaW5nLXRleHQtaGVscGVycycpO1xudmFyIFNwaW5uaW5nVGV4dExvb2t1cCA9IHJlcXVpcmUoJy4vc3Bpbm5pbmctdGV4dC1sb29rdXAnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNwaW5uaW5nVGV4dCh0ZXh0LCBwb3NpdGlvbikge1xuICAgICAgICB0aGlzLl90ZXh0ID0gdGV4dCB8fCAnbnVsbCc7XG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb24gfHwgMDtcbiAgICAgICAgdGhpcy5fcHJldmlvdXNQb3NpdGlvbiA9IDA7XG5cbiAgICAgICAgdGhpcy5fJCA9ICQoJzxzcGFuPicgKyB0aGlzLl90ZXh0ICsgJzwvc3Bhbj4nKTtcblxuICAgICAgICB0aGlzLl9sb29rdXAgPSBuZXcgU3Bpbm5pbmdUZXh0TG9va3VwKDEwMDAsIHRoaXMuXyQuY3NzKCd0ZXh0LXNoYWRvdycpLCB0aGlzLl8kLndpZHRoKCkpO1xuICAgIH1cblxuICAgIFNwaW5uaW5nVGV4dC5wcm90b3R5cGUuYXBwZW5kVG8gPSBmdW5jdGlvbigkY29udGFpbmVyKSB7XG4gICAgICAgICRjb250YWluZXIuYXBwZW5kKHRoaXMuXyQpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH07XG5cbiAgICBTcGlubmluZ1RleHQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKHZlbG9jaXR5LCBkdCkge1xuICAgICAgICB0aGlzLl9wcmV2aW91c1Bvc2l0aW9uID0gdGhpcy5fcG9zaXRpb247XG4gICAgICAgIHZhciB2ZWxvY2l0eUZhY3RvciA9IENvbnN0YW50cy5MT09QU19QRVJfU0VDT05EICogKENvbnN0YW50cy5NQVhfUE9TSVRJT04gLSBDb25zdGFudHMuTUlOX1BPU0lUSU9OKSAqIChkdCAvIDEwMDApO1xuICAgICAgICB0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3Bvc2l0aW9uICsgdmVsb2NpdHkgKiB2ZWxvY2l0eUZhY3RvcjtcbiAgICAgICAgaWYgKHRoaXMuX3Bvc2l0aW9uID4gQ29uc3RhbnRzLk1BWF9QT1NJVElPTikge1xuICAgICAgICAgICAgdGhpcy5fcG9zaXRpb24gPSBDb25zdGFudHMuTUlOX1BPU0lUSU9OICsgdGhpcy5fcG9zaXRpb24gLSBDb25zdGFudHMuTUFYX1BPU0lUSU9OO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dC5wcm90b3R5cGUucmVuZGVyT2xkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBub3JtYWxpemVkUG9zaXRpb24gPSBIZWxwZXJzLm5vcm1hbGl6ZWRQb3NpdGlvbih0aGlzLl9wb3NpdGlvbik7XG4gICAgICAgIHZhciBjb2xvciA9IGludGVycG9sYXRlQ29sb3IoQ29uc3RhbnRzLkZST01fQ09MT1IsIENvbnN0YW50cy5UT19DT0xPUiwgbm9ybWFsaXplZFBvc2l0aW9uKTtcblxuICAgICAgICAvLyBzaXplXG4gICAgICAgIHRoaXMuXyQuY3NzKCdmb250LXNpemUnLCBIZWxwZXJzLmZvbnRTaXplKG5vcm1hbGl6ZWRQb3NpdGlvbikpO1xuXG4gICAgICAgIC8vIGNvbG9yXG4gICAgICAgIHRoaXMuXyQuY3NzKCdjb2xvcicsIGNvbG9yKTtcblxuICAgICAgICAvLyBzaGFkb3cgKGNvbG9yKVxuICAgICAgICB0aGlzLl8kLmNzcygndGV4dC1zaGFkb3cnLCBIZWxwZXJzLnRleHRTaGFkb3codGhpcy5fJC5jc3MoJ3RleHQtc2hhZG93JyksIGNvbG9yKSk7XG5cbiAgICAgICAgLy8gb3BhY2l0eVxuICAgICAgICB0aGlzLl8kLmNzcygnb3BhY2l0eScsIG5vcm1hbGl6ZWRQb3NpdGlvbik7XG5cbiAgICAgICAgLy8gcG9zaXRpb25cbiAgICAgICAgdGhpcy5fJC5jc3MoJ3JpZ2h0JywgSGVscGVycy5yaWdodCh0aGlzLl9wb3NpdGlvbiwgdGhpcy5fJC53aWR0aCgpKSk7XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuXyQuY3NzKHtcbiAgICAgICAgICAgICdmb250LXNpemUnOiB0aGlzLl9sb29rdXAuZm9udFNpemUodGhpcy5fcG9zaXRpb24pLFxuICAgICAgICAgICAgJ2NvbG9yJzogdGhpcy5fbG9va3VwLmNvbG9yKHRoaXMuX3Bvc2l0aW9uKSxcbiAgICAgICAgICAgICd0ZXh0LXNoYWRvdyc6IHRoaXMuX2xvb2t1cC50ZXh0U2hhZG93KHRoaXMuX3Bvc2l0aW9uKSxcbiAgICAgICAgICAgICdvcGFjaXR5JzogdGhpcy5fbG9va3VwLm5vcm1hbGl6ZWRQb3NpdGlvbih0aGlzLl9wb3NpdGlvbiksXG4gICAgICAgICAgICAnei1pbmRleCc6IHRoaXMuX2xvb2t1cC5ub3JtYWxpemVkUG9zaXRpb24odGhpcy5fcG9zaXRpb24pXG4gICAgICAgIH0pO1xuICAgICAgICAvLyB3aWR0aCB2YXJpZXMgd2l0aCBmb250LXNpemUsIHdoeSB0aGlzIGlzIGRvbmUgc2VwZXJhdGVseVxuICAgICAgICB0aGlzLl8kLmNzcygncmlnaHQnLCB0aGlzLl9sb29rdXAucmlnaHQodGhpcy5fcG9zaXRpb24pIC0gdGhpcy5fJC53aWR0aCgpIC8gMik7XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dC5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xuICAgIH07XG5cbiAgICBTcGlubmluZ1RleHQucHJvdG90eXBlLmdldFRleHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RleHQ7XG4gICAgfTtcblxuICAgIFNwaW5uaW5nVGV4dC5wcm90b3R5cGUud2lubmluZ1Bvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9wcmV2aW91c1Bvc2l0aW9uIDwgQ29uc3RhbnRzLk1JRERMRV9QT1NJVElPTiAmJiB0aGlzLl9wb3NpdGlvbiA+PSBDb25zdGFudHMuTUlERExFX1BPU0lUSU9OKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHJldHVybiBTcGlubmluZ1RleHQ7XG59KSgpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgSURMRTogMCxcbiAgICBTUElOOiAxLFxuICAgIFNUT1A6IDJcbn07XG4iXX0=
